import{f as de,a as te,t as Ko,c as pi}from"../chunks/DgzFi3rQ.js";import{i as Mi}from"../chunks/8jezS8Lf.js";import{w as Jf,o as Xf}from"../chunks/6p_fFZ61.js";import{aN as Zf,G as Du,h as Et,F as Nu,M as bo,a8 as ep,e as xu,t as _,X as tp,I as np,J as rp,K as Zc,O as Ro,i as ts,ae as sp,aH as ip,f as Ho,s as op,aO as Li,aP as Fi,c as Qt,aQ as Ou,aF as Mu,aR as Lu,S as oe,aj as el,as as tl,r as Fu,p as ap,aS as So,q as Uu,d as Bu,aT as cp,aU as lp,af as up,aV as hp,aE as dp,aW as fp,_ as ju,aX as zu,ag as qu,aY as $u,aZ as pp,a_ as mp,P as gp,H as _p,a$ as yp,b0 as vp,l as we,b1 as Ep,b2 as wp,b3 as Tp,az as Ku,b4 as Ip,R as ns,aL as Ap,ak as bp,y as Ui,z as St,E as B,B as Bi,C as H,A as Ve,b5 as Rp,D as K,at as Wo,T as V,b6 as _r,v as vt,b7 as wa,b8 as Sp,b9 as rs}from"../chunks/C400F60V.js";import{a as Cp,e as me,s as Me,d as Pp}from"../chunks/Yb4xp0r8.js";import{p as Ct,i as Ie,s as kp,a as Vp}from"../chunks/DP_Bw-xB.js";import{B as Dp}from"../chunks/_ZQzwHOm.js";import{r as An,s as Hu}from"../chunks/DBW2SHas.js";import"../chunks/8UtF8RsF.js";function Wu(n,e,t){Et&&Nu();var r=new Dp(n),s=!Zf();Du(()=>{var i=e();s&&i!==null&&typeof i=="object"&&(i={}),r.ensure(i,t)})}function Ta(n,e){return e}function Np(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)hp(e[a].e,s,!0);var l=i>0&&s.length===0&&t!==null;if(l){var u=t.parentNode;dp(u),u.append(t),r.clear(),Mt(n,e[0].prev,e[i-1].next)}fp(s,()=>{for(var d=0;d<i;d++){var f=e[d];l||(r.delete(f.k),Mt(n,f.prev,f.next)),Bu(f.e,!l)}})}function Ia(n,e,t,r,s,i=null){var a=n,l={flags:e,items:new Map,first:null},u=(e&Ou)!==0;if(u){var d=n;a=Et?bo(ep(d)):d.appendChild(xu())}Et&&Nu();var f=null,v=!1,T=new Map,R=tp(()=>{var L=t();return Lu(L)?L:L==null?[]:Mu(L)}),S,k;function P(){xp(k,S,l,T,a,s,e,r,t),i!==null&&(S.length===0?f?Fu(f):f=Ho(()=>i(a)):f!==null&&ap(f,()=>{f=null}))}Du(()=>{k??=ju,S=_(R);var L=S.length;if(v&&L===0)return;v=L===0;let M=!1;if(Et){var z=np(a)===rp;z!==(L===0)&&(a=Zc(),bo(a),Ro(!1),M=!0)}if(Et){for(var ne=null,Y,F=0;F<L;F++){if(ts.nodeType===sp&&ts.data===ip){a=ts,M=!0,Ro(!1);break}var E=S[F],g=r(E,F);Y=Go(ts,l,ne,null,E,g,F,s,e,t),l.items.set(g,Y),ne=Y}L>0&&bo(Zc())}if(Et)L===0&&i&&(f=Ho(()=>i(a)));else if(op()){var m=new Set,I=Qt;for(F=0;F<L;F+=1){E=S[F],g=r(E,F);var w=l.items.get(g)??T.get(g);w?(e&(Li|Fi))!==0&&Gu(w,E,F,e):(Y=Go(null,l,null,null,E,g,F,s,e,t,!0),T.set(g,Y)),m.add(g)}for(const[A,y]of l.items)m.has(A)||I.skipped_effects.add(y.e);I.oncommit(P)}else P();M&&Ro(!0),_(R)}),Et&&(a=ts)}function xp(n,e,t,r,s,i,a,l,u){var d=(a&lp)!==0,f=(a&(Li|Fi))!==0,v=e.length,T=t.items,R=t.first,S=R,k,P=null,L,M=[],z=[],ne,Y,F,E;if(d)for(E=0;E<v;E+=1)ne=e[E],Y=l(ne,E),F=T.get(Y),F!==void 0&&(F.a?.measure(),(L??=new Set).add(F));for(E=0;E<v;E+=1){if(ne=e[E],Y=l(ne,E),F=T.get(Y),F===void 0){var g=r.get(Y);if(g!==void 0){r.delete(Y),T.set(Y,g);var m=P?P.next:S;Mt(t,P,g),Mt(t,g,m),Co(g,m,s),P=g}else{var I=S?S.e.nodes_start:s;P=Go(I,t,P,P===null?t.first:P.next,ne,Y,E,i,a,u)}T.set(Y,P),M=[],z=[],S=P.next;continue}if(f&&Gu(F,ne,E,a),(F.e.f&So)!==0&&(Fu(F.e),d&&(F.a?.unfix(),(L??=new Set).delete(F))),F!==S){if(k!==void 0&&k.has(F)){if(M.length<z.length){var w=z[0],A;P=w.prev;var y=M[0],ie=M[M.length-1];for(A=0;A<M.length;A+=1)Co(M[A],w,s);for(A=0;A<z.length;A+=1)k.delete(z[A]);Mt(t,y.prev,ie.next),Mt(t,P,y),Mt(t,ie,w),S=w,P=ie,E-=1,M=[],z=[]}else k.delete(F),Co(F,S,s),Mt(t,F.prev,F.next),Mt(t,F,P===null?t.first:P.next),Mt(t,P,F),P=F;continue}for(M=[],z=[];S!==null&&S.k!==Y;)(S.e.f&So)===0&&(k??=new Set).add(S),z.push(S),S=S.next;if(S===null)continue;F=S}M.push(F),P=F,S=F.next}if(S!==null||k!==void 0){for(var ae=k===void 0?[]:Mu(k);S!==null;)(S.e.f&So)===0&&ae.push(S),S=S.next;var ee=ae.length;if(ee>0){var Re=(a&Ou)!==0&&v===0?s:null;if(d){for(E=0;E<ee;E+=1)ae[E].a?.measure();for(E=0;E<ee;E+=1)ae[E].a?.fix()}Np(t,ae,Re)}}d&&Uu(()=>{if(L!==void 0)for(F of L)F.a?.apply()}),n.first=t.first&&t.first.e,n.last=P&&P.e;for(var Ee of r.values())Bu(Ee.e);r.clear()}function Gu(n,e,t,r){(r&Li)!==0&&tl(n.v,e),(r&Fi)!==0?tl(n.i,t):n.i=t}function Go(n,e,t,r,s,i,a,l,u,d,f){var v=(u&Li)!==0,T=(u&cp)===0,R=v?T?oe(s,!1,!1):el(s):s,S=(u&Fi)===0?a:el(a),k={i:S,v:R,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var P=document.createDocumentFragment();P.append(n=xu())}return k.e=Ho(()=>l(n,R,S,d),Et),k.e.prev=t&&t.e,k.e.next=r&&r.e,t===null?f||(e.first=k):(t.next=k,t.e.next=k.e),r!==null&&(r.prev=k,r.e.prev=k.e),k}finally{}}function Co(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=up(i);s.before(i),i=a}}function Mt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Qu(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=Qu(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function Op(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=Qu(n))&&(r&&(r+=" "),r+=e);return r}function Mp(n){return typeof n=="object"?Op(n):n??""}function Lp(n,e,t){var r=n==null?"":""+n;return r=r?r+" "+e:e,r===""?null:r}function Fp(n,e){return n==null?null:String(n)}function Up(n,e,t,r,s,i){var a=n.__className;if(Et||a!==t||a===void 0){var l=Lp(t,r);(!Et||l!==n.getAttribute("class"))&&(l==null?n.removeAttribute("class"):n.className=l),n.__className=t}return i}function yr(n,e,t,r){var s=n.__style;if(Et||s!==e){var i=Fp(e);(!Et||i!==n.getAttribute("style"))&&(i==null?n.removeAttribute("style"):n.style.cssText=i),n.__style=e}return r}function Yu(n,e,t=!1){if(n.multiple){if(e==null)return;if(!Lu(e))return pp();for(var r of n.options)r.selected=e.includes(hs(r));return}for(r of n.options){var s=hs(r);if(mp(s,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Bp(n){var e=new MutationObserver(()=>{Yu(n,n.__value)});e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),gp(()=>{e.disconnect()})}function jp(n,e,t=e){var r=new WeakSet,s=!0;zu(n,"change",i=>{var a=i?"[selected]":":checked",l;if(n.multiple)l=[].map.call(n.querySelectorAll(a),hs);else{var u=n.querySelector(a)??n.querySelector("option:not([disabled])");l=u&&hs(u)}t(l),Qt!==null&&r.add(Qt)}),qu(()=>{var i=e();if(n===document.activeElement){var a=$u??Qt;if(r.has(a))return}if(Yu(n,i,s),s&&i===void 0){var l=n.querySelector(":checked");l!==null&&(i=hs(l),t(i))}n.__value=i,s=!1}),Bp(n)}function hs(n){return"__value"in n?n.__value:n.value}const zp=()=>performance.now(),Yt={tick:n=>requestAnimationFrame(n),now:()=>zp(),tasks:new Set};function Ju(){const n=Yt.now();Yt.tasks.forEach(e=>{e.c(n)||(Yt.tasks.delete(e),e.f())}),Yt.tasks.size!==0&&Yt.tick(Ju)}function qp(n){let e;return Yt.tasks.size===0&&Yt.tick(Ju),{promise:new Promise(t=>{Yt.tasks.add(e={c:n,f:t})}),abort(){Yt.tasks.delete(e)}}}function Js(n,e){Ku(()=>{n.dispatchEvent(new CustomEvent(e))})}function $p(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const e=n.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function nl(n){const e={},t=n.split(";");for(const r of t){const[s,i]=r.split(":");if(!s||i===void 0)break;const a=$p(s.trim());e[a]=i.trim()}return e}const Kp=n=>n;function dt(n,e,t,r){var s=(n&wp)!==0,i=(n&Tp)!==0,a=s&&i,l=(n&Ep)!==0,u=a?"both":s?"in":"out",d,f=e.inert,v=e.style.overflow,T,R;function S(){return Ku(()=>d??=t()(e,r?.()??{},{direction:u}))}var k={is_global:l,in(){if(e.inert=f,!s){R?.abort(),R?.reset?.();return}i||T?.abort(),Js(e,"introstart"),T=Qo(e,S(),R,1,()=>{Js(e,"introend"),T?.abort(),T=d=void 0,e.style.overflow=v})},out(z){if(!i){z?.(),d=void 0;return}e.inert=!0,Js(e,"outrostart"),R=Qo(e,S(),T,0,()=>{Js(e,"outroend"),z?.()})},stop:()=>{T?.abort(),R?.abort()}},P=ju;if((P.transitions??=[]).push(k),s&&Cp){var L=l;if(!L){for(var M=P.parent;M&&(M.f&_p)!==0;)for(;(M=M.parent)&&(M.f&yp)===0;);L=!M||(M.f&vp)!==0}L&&qu(()=>{we(()=>k.in())})}}function Qo(n,e,t,r,s){var i=r===1;if(Ip(e)){var a,l=!1;return Uu(()=>{if(!l){var P=e({direction:i?"in":"out"});a=Qo(n,P,t,r,s)}}),{abort:()=>{l=!0,a?.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(t?.deactivate(),!e?.duration)return s(),{abort:ns,deactivate:ns,reset:ns,t:()=>r};const{delay:u=0,css:d,tick:f,easing:v=Kp}=e;var T=[];if(i&&t===void 0&&(f&&f(0,1),d)){var R=nl(d(0,1));T.push(R,R)}var S=()=>1-r,k=n.animate(T,{duration:u,fill:"forwards"});return k.onfinish=()=>{k.cancel();var P=t?.t()??1-r;t?.abort();var L=r-P,M=e.duration*Math.abs(L),z=[];if(M>0){var ne=!1;if(d)for(var Y=Math.ceil(M/16.666666666666668),F=0;F<=Y;F+=1){var E=P+L*v(F/Y),g=nl(d(E,1-E));z.push(g),ne||=g.overflow==="hidden"}ne&&(n.style.overflow="hidden"),S=()=>{var m=k.currentTime;return P+L*v(m/M)},f&&qp(()=>{if(k.playState!=="running")return!1;var m=S();return f(m,1-m),!0})}k=n.animate(z,{duration:M,fill:"forwards"}),k.onfinish=()=>{S=()=>r,f?.(r,1-r),s()}},{abort:()=>{k&&(k.cancel(),k.effect=null,k.onfinish=ns)},deactivate:()=>{s=ns},reset:()=>{r===0&&f?.(1,0)},t:()=>S()}}function Jt(n,e,t=e){var r=new WeakSet;zu(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=Po(n)?ko(i):i,t(i),Qt!==null&&r.add(Qt),await Ap(),i!==(i=e())){var a=n.selectionStart,l=n.selectionEnd,u=n.value.length;if(n.value=i??"",l!==null){var d=n.value.length;a===l&&l===u&&d>u?(n.selectionStart=d,n.selectionEnd=d):(n.selectionStart=a,n.selectionEnd=Math.min(l,d))}}}),(Et&&n.defaultValue!==n.value||we(e)==null&&n.value)&&(t(Po(n)?ko(n.value):n.value),Qt!==null&&r.add(Qt)),bp(()=>{var s=e();if(n===document.activeElement){var i=$u??Qt;if(r.has(i))return}Po(n)&&s===ko(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function Po(n){var e=n.type;return e==="number"||e==="range"}function ko(n){return n===""?null:+n}const Hp=()=>{};var rl={};const Xu=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Wp=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],l=n[t++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Zu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,l=a?n[s+1]:0,u=s+2<n.length,d=u?n[s+2]:0,f=i>>2,v=(i&3)<<4|l>>4;let T=(l&15)<<2|d>>6,R=d&63;u||(R=64,a||(T=64)),r.push(t[f],t[v],t[T],t[R])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Xu(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Wp(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;const d=s<n.length?t[n.charAt(s)]:64;++s;const v=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||l==null||d==null||v==null)throw new Gp;const T=i<<2|l>>4;if(r.push(T),d!==64){const R=l<<4&240|d>>2;if(r.push(R),v!==64){const S=d<<6&192|v;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Gp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Qp=function(n){const e=Xu(n);return Zu.encodeByteArray(e,!0)},mi=function(n){return Qp(n).replace(/\./g,"")},eh=function(n){try{return Zu.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Yp(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Jp=()=>Yp().__FIREBASE_DEFAULTS__,Xp=()=>{if(typeof process>"u"||typeof rl>"u")return;const n=rl.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Zp=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&eh(n[1]);return e&&JSON.parse(e)},ji=()=>{try{return Hp()||Jp()||Xp()||Zp()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},th=n=>ji()?.emulatorHosts?.[n],em=n=>{const e=th(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},nh=()=>ji()?.config,rh=n=>ji()?.[`_${n}`];class tm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Vr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function sh(n){return(await fetch(n,{credentials:"include"})).ok}function nm(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[mi(JSON.stringify(t)),mi(JSON.stringify(a)),""].join(".")}const ds={};function rm(){const n={prod:[],emulator:[]};for(const e of Object.keys(ds))ds[e]?n.emulator.push(e):n.prod.push(e);return n}function sm(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let sl=!1;function ih(n,e){if(typeof window>"u"||typeof document>"u"||!Vr(window.location.host)||ds[n]===e||ds[n]||sl)return;ds[n]=e;function t(T){return`__firebase__banner__${T}`}const r="__firebase__banner",i=rm().prod.length>0;function a(){const T=document.getElementById(r);T&&T.remove()}function l(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function u(T,R){T.setAttribute("width","24"),T.setAttribute("id",R),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function d(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{sl=!0,a()},T}function f(T,R){T.setAttribute("id",R),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function v(){const T=sm(r),R=t("text"),S=document.getElementById(R)||document.createElement("span"),k=t("learnmore"),P=document.getElementById(k)||document.createElement("a"),L=t("preprendIcon"),M=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const z=T.element;l(z),f(P,k);const ne=d();u(M,L),z.append(M,S,P,ne),document.body.appendChild(z)}i?(S.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function lt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function im(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lt())}function om(){const n=ji()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function am(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cm(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function lm(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function um(){const n=lt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function hm(){return!om()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dm(){try{return typeof indexedDB=="object"}catch{return!1}}function fm(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const pm="FirebaseError";class an extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=pm,Object.setPrototypeOf(this,an.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cs.prototype.create)}}class Cs{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?mm(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new an(s,l,r)}}function mm(n,e){return n.replace(gm,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const gm=/\{\$([^}]+)}/g;function _m(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Jn(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(il(i)&&il(a)){if(!Jn(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function il(n){return n!==null&&typeof n=="object"}function Ps(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function is(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function os(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function ym(n,e){const t=new vm(n,e);return t.subscribe.bind(t)}class vm{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Em(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Vo),s.error===void 0&&(s.error=Vo),s.complete===void 0&&(s.complete=Vo);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Em(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Vo(){}function Xe(n){return n&&n._delegate?n._delegate:n}class Xn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Kn="[DEFAULT]";class wm{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new tm;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Im(e))try{this.getOrInitializeService({instanceIdentifier:Kn})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Kn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Kn){return this.instances.has(e)}getOptions(e=Kn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Tm(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kn){return this.component?this.component.multipleInstances?e:Kn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Tm(n){return n===Kn?void 0:n}function Im(n){return n.instantiationMode==="EAGER"}class Am{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new wm(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var ce;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ce||(ce={}));const bm={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},Rm=ce.INFO,Sm={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},Cm=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=Sm[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Aa{constructor(e){this.name=e,this._logLevel=Rm,this._logHandler=Cm,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bm[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...e),this._logHandler(this,ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...e),this._logHandler(this,ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...e),this._logHandler(this,ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...e),this._logHandler(this,ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...e),this._logHandler(this,ce.ERROR,...e)}}const Pm=(n,e)=>e.some(t=>n instanceof t);let ol,al;function km(){return ol||(ol=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Vm(){return al||(al=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oh=new WeakMap,Yo=new WeakMap,ah=new WeakMap,Do=new WeakMap,ba=new WeakMap;function Dm(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(Rn(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&oh.set(t,n)}).catch(()=>{}),ba.set(e,n),e}function Nm(n){if(Yo.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});Yo.set(n,e)}let Jo={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Yo.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ah.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Rn(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function xm(n){Jo=n(Jo)}function Om(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(No(this),e,...t);return ah.set(r,e.sort?e.sort():[e]),Rn(r)}:Vm().includes(n)?function(...e){return n.apply(No(this),e),Rn(oh.get(this))}:function(...e){return Rn(n.apply(No(this),e))}}function Mm(n){return typeof n=="function"?Om(n):(n instanceof IDBTransaction&&Nm(n),Pm(n,km())?new Proxy(n,Jo):n)}function Rn(n){if(n instanceof IDBRequest)return Dm(n);if(Do.has(n))return Do.get(n);const e=Mm(n);return e!==n&&(Do.set(n,e),ba.set(e,n)),e}const No=n=>ba.get(n);function Lm(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),l=Rn(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Rn(a.result),u.oldVersion,u.newVersion,Rn(a.transaction),u)}),t&&a.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const Fm=["get","getKey","getAll","getAllKeys","count"],Um=["put","add","delete","clear"],xo=new Map;function cl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(xo.get(e))return xo.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Um.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Fm.includes(t)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[t](...l),s&&u.done]))[0]};return xo.set(e,i),i}xm(n=>({...n,get:(e,t,r)=>cl(e,t)||n.get(e,t,r),has:(e,t)=>!!cl(e,t)||n.has(e,t)}));class Bm{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(jm(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function jm(n){return n.getComponent()?.type==="VERSION"}const Xo="@firebase/app",ll="0.14.5";const nn=new Aa("@firebase/app"),zm="@firebase/app-compat",qm="@firebase/analytics-compat",$m="@firebase/analytics",Km="@firebase/app-check-compat",Hm="@firebase/app-check",Wm="@firebase/auth",Gm="@firebase/auth-compat",Qm="@firebase/database",Ym="@firebase/data-connect",Jm="@firebase/database-compat",Xm="@firebase/functions",Zm="@firebase/functions-compat",eg="@firebase/installations",tg="@firebase/installations-compat",ng="@firebase/messaging",rg="@firebase/messaging-compat",sg="@firebase/performance",ig="@firebase/performance-compat",og="@firebase/remote-config",ag="@firebase/remote-config-compat",cg="@firebase/storage",lg="@firebase/storage-compat",ug="@firebase/firestore",hg="@firebase/ai",dg="@firebase/firestore-compat",fg="firebase",pg="12.5.0";const Zo="[DEFAULT]",mg={[Xo]:"fire-core",[zm]:"fire-core-compat",[$m]:"fire-analytics",[qm]:"fire-analytics-compat",[Hm]:"fire-app-check",[Km]:"fire-app-check-compat",[Wm]:"fire-auth",[Gm]:"fire-auth-compat",[Qm]:"fire-rtdb",[Ym]:"fire-data-connect",[Jm]:"fire-rtdb-compat",[Xm]:"fire-fn",[Zm]:"fire-fn-compat",[eg]:"fire-iid",[tg]:"fire-iid-compat",[ng]:"fire-fcm",[rg]:"fire-fcm-compat",[sg]:"fire-perf",[ig]:"fire-perf-compat",[og]:"fire-rc",[ag]:"fire-rc-compat",[cg]:"fire-gcs",[lg]:"fire-gcs-compat",[ug]:"fire-fst",[dg]:"fire-fst-compat",[hg]:"fire-vertex","fire-js":"fire-js",[fg]:"fire-js-all"};const gi=new Map,gg=new Map,ea=new Map;function ul(n,e){try{n.container.addComponent(e)}catch(t){nn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ar(n){const e=n.name;if(ea.has(e))return nn.debug(`There were multiple attempts to register component ${e}.`),!1;ea.set(e,n);for(const t of gi.values())ul(t,n);for(const t of gg.values())ul(t,n);return!0}function Ra(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function It(n){return n==null?!1:n.settings!==void 0}const _g={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Sn=new Cs("app","Firebase",_g);class yg{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Sn.create("app-deleted",{appName:this._name})}}const Dr=pg;function ch(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Zo,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Sn.create("bad-app-name",{appName:String(s)});if(t||(t=nh()),!t)throw Sn.create("no-options");const i=gi.get(s);if(i){if(Jn(t,i.options)&&Jn(r,i.config))return i;throw Sn.create("duplicate-app",{appName:s})}const a=new Am(s);for(const u of ea.values())a.addComponent(u);const l=new yg(t,r,a);return gi.set(s,l),l}function lh(n=Zo){const e=gi.get(n);if(!e&&n===Zo&&nh())return ch();if(!e)throw Sn.create("no-app",{appName:n});return e}function Cn(n,e,t){let r=mg[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nn.warn(a.join(" "));return}Ar(new Xn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const vg="firebase-heartbeat-database",Eg=1,vs="firebase-heartbeat-store";let Oo=null;function uh(){return Oo||(Oo=Lm(vg,Eg,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(vs)}catch(t){console.warn(t)}}}}).catch(n=>{throw Sn.create("idb-open",{originalErrorMessage:n.message})})),Oo}async function wg(n){try{const t=(await uh()).transaction(vs),r=await t.objectStore(vs).get(hh(n));return await t.done,r}catch(e){if(e instanceof an)nn.warn(e.message);else{const t=Sn.create("idb-get",{originalErrorMessage:e?.message});nn.warn(t.message)}}}async function hl(n,e){try{const r=(await uh()).transaction(vs,"readwrite");await r.objectStore(vs).put(e,hh(n)),await r.done}catch(t){if(t instanceof an)nn.warn(t.message);else{const r=Sn.create("idb-set",{originalErrorMessage:t?.message});nn.warn(r.message)}}}function hh(n){return`${n.name}!${n.options.appId}`}const Tg=1024,Ig=30;class Ag{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Rg(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=dl();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Ig){const s=Sg(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){nn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=dl(),{heartbeatsToSend:t,unsentEntries:r}=bg(this._heartbeatsCache.heartbeats),s=mi(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return nn.warn(e),""}}}function dl(){return new Date().toISOString().substring(0,10)}function bg(n,e=Tg){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),fl(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),fl(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Rg{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dm()?fm().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await wg(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return hl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return hl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function fl(n){return mi(JSON.stringify({version:2,heartbeats:n})).length}function Sg(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Cg(n){Ar(new Xn("platform-logger",e=>new Bm(e),"PRIVATE")),Ar(new Xn("heartbeat",e=>new Ag(e),"PRIVATE")),Cn(Xo,ll,n),Cn(Xo,ll,"esm2020"),Cn("fire-js","")}Cg("");var Pg="firebase",kg="12.5.0";Cn(Pg,kg,"app");function dh(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Vg=dh,fh=new Cs("auth","Firebase",dh());const _i=new Aa("@firebase/auth");function Dg(n,...e){_i.logLevel<=ce.WARN&&_i.warn(`Auth (${Dr}): ${n}`,...e)}function si(n,...e){_i.logLevel<=ce.ERROR&&_i.error(`Auth (${Dr}): ${n}`,...e)}function Vt(n,...e){throw Sa(n,...e)}function Ut(n,...e){return Sa(n,...e)}function ph(n,e,t){const r={...Vg(),[e]:t};return new Cs("auth","Firebase",r).create(e,{appName:n.name})}function en(n){return ph(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Sa(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return fh.create(n,...e)}function G(n,e,...t){if(!n)throw Sa(e,...t)}function Xt(n){const e="INTERNAL ASSERTION FAILED: "+n;throw si(e),new Error(e)}function rn(n,e){n||Xt(e)}function ta(){return typeof self<"u"&&self.location?.href||""}function Ng(){return pl()==="http:"||pl()==="https:"}function pl(){return typeof self<"u"&&self.location?.protocol||null}function xg(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ng()||cm()||"connection"in navigator)?navigator.onLine:!0}function Og(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class ks{constructor(e,t){this.shortDelay=e,this.longDelay=t,rn(t>e,"Short delay should be less than long delay!"),this.isMobile=im()||lm()}get(){return xg()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ca(n,e){rn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class mh{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Mg={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Lg=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Fg=new ks(3e4,6e4);function cn(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ln(n,e,t,r,s={}){return gh(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const l=Ps({key:n.config.apiKey,...a}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...i};return am()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Vr(n.emulatorConfig.host)&&(d.credentials="include"),mh.fetch()(await _h(n,n.config.apiHost,t,l),d)})}async function gh(n,e,t){n._canInitEmulator=!1;const r={...Mg,...e};try{const s=new Bg(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Xs(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const l=i.ok?a.errorMessage:a.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xs(n,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Xs(n,"email-already-in-use",a);if(u==="USER_DISABLED")throw Xs(n,"user-disabled",a);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw ph(n,f,d);Vt(n,f)}}catch(s){if(s instanceof an)throw s;Vt(n,"network-request-failed",{message:String(s)})}}async function Vs(n,e,t,r,s={}){const i=await ln(n,e,t,r,s);return"mfaPendingCredential"in i&&Vt(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function _h(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?Ca(n.config,s):`${n.config.apiScheme}://${s}`;return Lg.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function Ug(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Bg{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ut(this.auth,"network-request-failed")),Fg.get())})}}function Xs(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Ut(n,e,r);return s.customData._tokenResponse=t,s}function ml(n){return n!==void 0&&n.enterprise!==void 0}class jg{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ug(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function zg(n,e){return ln(n,"GET","/v2/recaptchaConfig",cn(n,e))}async function qg(n,e){return ln(n,"POST","/v1/accounts:delete",e)}async function yi(n,e){return ln(n,"POST","/v1/accounts:lookup",e)}function fs(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function $g(n,e=!1){const t=Xe(n),r=await t.getIdToken(e),s=Pa(r);G(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:fs(Mo(s.auth_time)),issuedAtTime:fs(Mo(s.iat)),expirationTime:fs(Mo(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Mo(n){return Number(n)*1e3}function Pa(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return si("JWT malformed, contained fewer than 3 sections"),null;try{const s=eh(t);return s?JSON.parse(s):(si("Failed to decode base64 JWT payload"),null)}catch(s){return si("Caught error parsing JWT payload as JSON",s?.toString()),null}}function gl(n){const e=Pa(n);return G(e,"internal-error"),G(typeof e.exp<"u","internal-error"),G(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Es(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof an&&Kg(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Kg({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Hg{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class na{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fs(this.lastLoginAt),this.creationTime=fs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function vi(n){const e=n.auth,t=await n.getIdToken(),r=await Es(n,yi(e,{idToken:t}));G(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?yh(s.providerUserInfo):[],a=Gg(n.providerData,i),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!a?.length,d=l?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new na(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function Wg(n){const e=Xe(n);await vi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Gg(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function yh(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Qg(n,e){const t=await gh(n,{},async()=>{const r=Ps({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await _h(n,s,"/v1/token",`key=${i}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return n.emulatorConfig&&Vr(n.emulatorConfig.host)&&(u.credentials="include"),mh.fetch()(a,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Yg(n,e){return ln(n,"POST","/v2/accounts:revokeToken",cn(n,e))}class vr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){G(e.idToken,"internal-error"),G(typeof e.idToken<"u","internal-error"),G(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):gl(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){G(e.length!==0,"internal-error");const t=gl(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(G(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await Qg(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new vr;return r&&(G(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(G(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(G(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new vr,this.toJSON())}_performRefresh(){return Xt("not implemented")}}function vn(n,e){G(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Pt{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new Hg(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new na(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Es(this,this.stsTokenManager.getToken(this.auth,e));return G(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return $g(this,e)}reload(){return Wg(this)}_assign(e){this!==e&&(G(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Pt({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){G(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await vi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(It(this.auth.app))return Promise.reject(en(this.auth));const e=await this.getIdToken();return await Es(this,qg(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:v,emailVerified:T,isAnonymous:R,providerData:S,stsTokenManager:k}=t;G(v&&k,e,"internal-error");const P=vr.fromJSON(this.name,k);G(typeof v=="string",e,"internal-error"),vn(r,e.name),vn(s,e.name),G(typeof T=="boolean",e,"internal-error"),G(typeof R=="boolean",e,"internal-error"),vn(i,e.name),vn(a,e.name),vn(l,e.name),vn(u,e.name),vn(d,e.name),vn(f,e.name);const L=new Pt({uid:v,auth:e,email:s,emailVerified:T,displayName:r,isAnonymous:R,photoURL:a,phoneNumber:i,tenantId:l,stsTokenManager:P,createdAt:d,lastLoginAt:f});return S&&Array.isArray(S)&&(L.providerData=S.map(M=>({...M}))),u&&(L._redirectEventId=u),L}static async _fromIdTokenResponse(e,t,r=!1){const s=new vr;s.updateFromServerResponse(t);const i=new Pt({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await vi(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];G(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?yh(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,l=new vr;l.updateFromIdToken(r);const u=new Pt({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:a}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new na(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(u,d),u}}const _l=new Map;function Zt(n){rn(n instanceof Function,"Expected a class definition");let e=_l.get(n);return e?(rn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,_l.set(n,e),e)}class vh{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vh.type="NONE";const yl=vh;function ii(n,e,t){return`firebase:${n}:${e}:${t}`}class Er{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=ii(this.userKey,s.apiKey,i),this.fullPersistenceKey=ii("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await yi(this.auth,{idToken:e}).catch(()=>{});return t?Pt._fromGetAccountInfoResponse(this.auth,t,e):null}return Pt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Er(Zt(yl),e,r);const s=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Zt(yl);const a=ii(r,e.config.apiKey,e.name);let l=null;for(const d of t)try{const f=await d._get(a);if(f){let v;if(typeof f=="string"){const T=await yi(e,{idToken:f}).catch(()=>{});if(!T)break;v=await Pt._fromGetAccountInfoResponse(e,T,f)}else v=Pt._fromJSON(e,f);d!==i&&(l=v),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Er(i,e,r):(i=u[0],l&&await i._set(a,l.toJSON()),await Promise.all(t.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new Er(i,e,r))}}function vl(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ih(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Eh(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bh(e))return"Blackberry";if(Rh(e))return"Webos";if(wh(e))return"Safari";if((e.includes("chrome/")||Th(e))&&!e.includes("edge/"))return"Chrome";if(Ah(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Eh(n=lt()){return/firefox\//i.test(n)}function wh(n=lt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Th(n=lt()){return/crios\//i.test(n)}function Ih(n=lt()){return/iemobile/i.test(n)}function Ah(n=lt()){return/android/i.test(n)}function bh(n=lt()){return/blackberry/i.test(n)}function Rh(n=lt()){return/webos/i.test(n)}function ka(n=lt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Jg(n=lt()){return ka(n)&&!!window.navigator?.standalone}function Xg(){return um()&&document.documentMode===10}function Sh(n=lt()){return ka(n)||Ah(n)||Rh(n)||bh(n)||/windows phone/i.test(n)||Ih(n)}function Ch(n,e=[]){let t;switch(n){case"Browser":t=vl(lt());break;case"Worker":t=`${vl(lt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dr}/${r}`}class Zg{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,l)=>{try{const u=e(i);a(u)}catch(u){l(u)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function e_(n,e={}){return ln(n,"GET","/v2/passwordPolicy",cn(n,e))}const t_=6;class n_{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??t_,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class r_{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new El(this),this.idTokenSubscription=new El(this),this.beforeStateQueue=new Zg(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fh,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Er.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await yi(this,{idToken:e}),r=await Pt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(It(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===a)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return G(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await vi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Og()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(It(this.app))return Promise.reject(en(this));const t=e?Xe(e):null;return t&&G(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&G(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return It(this.app)?Promise.reject(en(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return It(this.app)?Promise.reject(en(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Zt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await e_(this),t=new n_(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Cs("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Yg(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Zt(e)||this._popupRedirectResolver;G(t,this,"argument-error"),this.redirectPersistenceManager=await Er.create(this,[Zt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(G(l,this,"internal-error"),l.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,s);return()=>{a=!0,u()}}else{const u=e.addObserver(t);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return G(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ch(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(It(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Dg(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ln(n){return Xe(n)}class El{constructor(e){this.auth=e,this.observer=null,this.addObserver=ym(t=>this.observer=t)}get next(){return G(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let zi={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function s_(n){zi=n}function Ph(n){return zi.loadJS(n)}function i_(){return zi.recaptchaEnterpriseScript}function o_(){return zi.gapiScript}function a_(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class c_{constructor(){this.enterprise=new l_}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class l_{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const u_="recaptcha-enterprise",kh="NO_RECAPTCHA";class h_{constructor(e){this.type=u_,this.auth=Ln(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,l)=>{zg(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new jg(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,a(d.siteKey)}}).catch(u=>{l(u)})})}function s(i,a,l){const u=window.grecaptcha;ml(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{a(d)}).catch(()=>{a(kh)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new c_().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{r(this.auth).then(l=>{if(!t&&ml(window.grecaptcha))s(l,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=i_();u.length!==0&&(u+=l),Ph(u).then(()=>{s(l,i,a)}).catch(d=>{a(d)})}}).catch(l=>{a(l)})})}}async function wl(n,e,t,r=!1,s=!1){const i=new h_(n);let a;if(s)a=kh;else try{a=await i.verify(t)}catch{a=await i.verify(t,!0)}const l={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:a}):Object.assign(l,{captchaResponse:a}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Ei(n,e,t,r,s){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await wl(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await wl(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(i)})}function d_(n,e){const t=Ra(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Jn(i,e??{}))return s;Vt(s,"already-initialized")}return t.initialize({options:e})}function f_(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Zt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function p_(n,e,t){const r=Ln(n);G(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Vh(e),{host:a,port:l}=m_(e),u=l===null?"":`:${l}`,d={url:`${i}//${a}${u}/`},f=Object.freeze({host:a,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){G(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),G(Jn(d,r.config.emulator)&&Jn(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Vr(a)?(sh(`${i}//${a}${u}`),ih("Auth",!0)):g_()}function Vh(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function m_(n){const e=Vh(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Tl(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Tl(a)}}}function Tl(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function g_(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Va{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Xt("not implemented")}_getIdTokenResponse(e){return Xt("not implemented")}_linkToIdToken(e,t){return Xt("not implemented")}_getReauthenticationResolver(e){return Xt("not implemented")}}async function __(n,e){return ln(n,"POST","/v1/accounts:signUp",e)}async function y_(n,e){return Vs(n,"POST","/v1/accounts:signInWithPassword",cn(n,e))}async function v_(n,e){return ln(n,"POST","/v1/accounts:sendOobCode",cn(n,e))}async function E_(n,e){return v_(n,e)}async function w_(n,e){return Vs(n,"POST","/v1/accounts:signInWithEmailLink",cn(n,e))}async function T_(n,e){return Vs(n,"POST","/v1/accounts:signInWithEmailLink",cn(n,e))}class ws extends Va{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new ws(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new ws(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ei(e,t,"signInWithPassword",y_);case"emailLink":return w_(e,{email:this._email,oobCode:this._password});default:Vt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ei(e,r,"signUpPassword",__);case"emailLink":return T_(e,{idToken:t,email:this._email,oobCode:this._password});default:Vt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function wr(n,e){return Vs(n,"POST","/v1/accounts:signInWithIdp",cn(n,e))}const I_="http://localhost";class Zn extends Va{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Vt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Zn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return wr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,wr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,wr(e,t)}buildRequest(){const e={requestUri:I_,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ps(t)}return e}}function A_(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function b_(n){const e=is(os(n)).link,t=e?is(os(e)).deep_link_id:null,r=is(os(n)).deep_link_id;return(r?is(os(r)).link:null)||r||t||e||n}class Da{constructor(e){const t=is(os(e)),r=t.apiKey??null,s=t.oobCode??null,i=A_(t.mode??null);G(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=b_(e);try{return new Da(t)}catch{return null}}}class rr{constructor(){this.providerId=rr.PROVIDER_ID}static credential(e,t){return ws._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Da.parseLink(t);return G(r,"argument-error"),ws._fromEmailAndCode(e,r.code,r.tenantId)}}rr.PROVIDER_ID="password";rr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Dh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ds extends Dh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class En extends Ds{constructor(){super("facebook.com")}static credential(e){return Zn._fromParams({providerId:En.PROVIDER_ID,signInMethod:En.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return En.credentialFromTaggedObject(e)}static credentialFromError(e){return En.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return En.credential(e.oauthAccessToken)}catch{return null}}}En.FACEBOOK_SIGN_IN_METHOD="facebook.com";En.PROVIDER_ID="facebook.com";class wn extends Ds{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zn._fromParams({providerId:wn.PROVIDER_ID,signInMethod:wn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wn.credentialFromTaggedObject(e)}static credentialFromError(e){return wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return wn.credential(t,r)}catch{return null}}}wn.GOOGLE_SIGN_IN_METHOD="google.com";wn.PROVIDER_ID="google.com";class Tn extends Ds{constructor(){super("github.com")}static credential(e){return Zn._fromParams({providerId:Tn.PROVIDER_ID,signInMethod:Tn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Tn.credentialFromTaggedObject(e)}static credentialFromError(e){return Tn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Tn.credential(e.oauthAccessToken)}catch{return null}}}Tn.GITHUB_SIGN_IN_METHOD="github.com";Tn.PROVIDER_ID="github.com";class In extends Ds{constructor(){super("twitter.com")}static credential(e,t){return Zn._fromParams({providerId:In.PROVIDER_ID,signInMethod:In.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return In.credentialFromTaggedObject(e)}static credentialFromError(e){return In.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return In.credential(t,r)}catch{return null}}}In.TWITTER_SIGN_IN_METHOD="twitter.com";In.PROVIDER_ID="twitter.com";async function R_(n,e){return Vs(n,"POST","/v1/accounts:signUp",cn(n,e))}class er{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Pt._fromIdTokenResponse(e,r,s),a=Il(r);return new er({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Il(r);return new er({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Il(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class wi extends an{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,wi.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new wi(e,t,r,s)}}function Nh(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?wi._fromErrorAndOperation(n,i,e,r):i})}async function S_(n,e,t=!1){const r=await Es(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return er._forOperation(n,"link",r)}async function xh(n,e,t=!1){const{auth:r}=n;if(It(r.app))return Promise.reject(en(r));const s="reauthenticate";try{const i=await Es(n,Nh(r,s,e,n),t);G(i.idToken,r,"internal-error");const a=Pa(i.idToken);G(a,r,"internal-error");const{sub:l}=a;return G(n.uid===l,r,"user-mismatch"),er._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&Vt(r,"user-mismatch"),i}}async function Oh(n,e,t=!1){if(It(n.app))return Promise.reject(en(n));const r="signIn",s=await Nh(n,r,e),i=await er._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function C_(n,e){return Oh(Ln(n),e)}async function P_(n,e){return xh(Xe(n),e)}async function Mh(n){const e=Ln(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function k_(n,e,t){const r=Ln(n);await Ei(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",E_)}async function Al(n,e,t){if(It(n.app))return Promise.reject(en(n));const r=Ln(n),a=await Ei(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",R_).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Mh(n),u}),l=await er._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function bl(n,e,t){return It(n.app)?Promise.reject(en(n)):C_(Xe(n),rr.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Mh(n),r})}function V_(n,e,t,r){return Xe(n).onIdTokenChanged(e,t,r)}function D_(n,e,t){return Xe(n).beforeAuthStateChanged(e,t)}function N_(n,e,t,r){return Xe(n).onAuthStateChanged(e,t,r)}function Lh(n){return Xe(n).signOut()}const Ti="__sak";class Fh{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ti,"1"),this.storage.removeItem(Ti),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const x_=1e3,O_=10;class Uh extends Fh{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Sh(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);Xg()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,O_):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},x_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Uh.type="LOCAL";const M_=Uh;class Bh extends Fh{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Bh.type="SESSION";const jh=Bh;function L_(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class qi{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new qi(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(async d=>d(t.origin,i)),u=await L_(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qi.receivers=[];function Na(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class F_{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((l,u)=>{const d=Na("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(v){const T=v;if(T.data.eventId===d)switch(T.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(T.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Bt(){return window}function U_(n){Bt().location.href=n}function zh(){return typeof Bt().WorkerGlobalScope<"u"&&typeof Bt().importScripts=="function"}async function B_(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function j_(){return navigator?.serviceWorker?.controller||null}function z_(){return zh()?self:null}const qh="firebaseLocalStorageDb",q_=1,Ii="firebaseLocalStorage",$h="fbase_key";class Ns{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $i(n,e){return n.transaction([Ii],e?"readwrite":"readonly").objectStore(Ii)}function $_(){const n=indexedDB.deleteDatabase(qh);return new Ns(n).toPromise()}function ra(){const n=indexedDB.open(qh,q_);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ii,{keyPath:$h})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ii)?e(r):(r.close(),await $_(),e(await ra()))})})}async function Rl(n,e,t){const r=$i(n,!0).put({[$h]:e,value:t});return new Ns(r).toPromise()}async function K_(n,e){const t=$i(n,!1).get(e),r=await new Ns(t).toPromise();return r===void 0?null:r.value}function Sl(n,e){const t=$i(n,!0).delete(e);return new Ns(t).toPromise()}const H_=800,W_=3;class Kh{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ra(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>W_)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zh()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qi._getInstance(z_()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await B_(),!this.activeServiceWorker)return;this.sender=new F_(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||j_()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ra();return await Rl(e,Ti,"1"),await Sl(e,Ti),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Rl(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>K_(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Sl(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=$i(s,!1).getAll();return new Ns(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),H_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Kh.type="LOCAL";const G_=Kh;new ks(3e4,6e4);function Q_(n,e){return e?Zt(e):(G(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class xa extends Va{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return wr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return wr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Y_(n){return Oh(n.auth,new xa(n),n.bypassAuthState)}function J_(n){const{auth:e,user:t}=n;return G(t,e,"internal-error"),xh(t,new xa(n),n.bypassAuthState)}async function X_(n){const{auth:e,user:t}=n;return G(t,e,"internal-error"),S_(t,new xa(n),n.bypassAuthState)}class Hh{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:l}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Y_;case"linkViaPopup":case"linkViaRedirect":return X_;case"reauthViaPopup":case"reauthViaRedirect":return J_;default:Vt(this.auth,"internal-error")}}resolve(e){rn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Z_=new ks(2e3,1e4);class mr extends Hh{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,mr.currentPopupAction&&mr.currentPopupAction.cancel(),mr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return G(e,this.auth,"internal-error"),e}async onExecution(){rn(this.filter.length===1,"Popup operations only handle one event");const e=Na();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ut(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ut(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,mr.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ut(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Z_.get())};e()}}mr.currentPopupAction=null;const ey="pendingRedirect",oi=new Map;class ty extends Hh{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=oi.get(this.auth._key());if(!e){try{const r=await ny(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}oi.set(this.auth._key(),e)}return this.bypassAuthState||oi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ny(n,e){const t=iy(e),r=sy(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function ry(n,e){oi.set(n._key(),e)}function sy(n){return Zt(n._redirectPersistence)}function iy(n){return ii(ey,n.config.apiKey,n.name)}async function oy(n,e,t=!1){if(It(n.app))return Promise.reject(en(n));const r=Ln(n),s=Q_(r,e),a=await new ty(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const ay=600*1e3;class cy{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ly(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Wh(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ut(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ay&&this.cachedEventUids.clear(),this.cachedEventUids.has(Cl(e))}saveEventToCache(e){this.cachedEventUids.add(Cl(e)),this.lastProcessedEventTime=Date.now()}}function Cl(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Wh({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function ly(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wh(n);default:return!1}}async function uy(n,e={}){return ln(n,"GET","/v1/projects",e)}const hy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dy=/^https?/;async function fy(n){if(n.config.emulator)return;const{authorizedDomains:e}=await uy(n);for(const t of e)try{if(py(t))return}catch{}Vt(n,"unauthorized-domain")}function py(n){const e=ta(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!dy.test(t))return!1;if(hy.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const my=new ks(3e4,6e4);function Pl(){const n=Bt().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function gy(n){return new Promise((e,t)=>{function r(){Pl(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Pl(),t(Ut(n,"network-request-failed"))},timeout:my.get()})}if(Bt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Bt().gapi?.load)r();else{const s=a_("iframefcb");return Bt()[s]=()=>{gapi.load?r():t(Ut(n,"network-request-failed"))},Ph(`${o_()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw ai=null,e})}let ai=null;function _y(n){return ai=ai||gy(n),ai}const yy=new ks(5e3,15e3),vy="__/auth/iframe",Ey="emulator/auth/iframe",wy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ty=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Iy(n){const e=n.config;G(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ca(e,Ey):`https://${n.config.authDomain}/${vy}`,r={apiKey:e.apiKey,appName:n.name,v:Dr},s=Ty.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ps(r).slice(1)}`}async function Ay(n){const e=await _y(n),t=Bt().gapi;return G(t,n,"internal-error"),e.open({where:document.body,url:Iy(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wy,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=Ut(n,"network-request-failed"),l=Bt().setTimeout(()=>{i(a)},yy.get());function u(){Bt().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(a)})}))}const by={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ry=500,Sy=600,Cy="_blank",Py="http://localhost";class kl{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ky(n,e,t,r=Ry,s=Sy){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...by,width:r.toString(),height:s.toString(),top:i,left:a},d=lt().toLowerCase();t&&(l=Th(d)?Cy:t),Eh(d)&&(e=e||Py,u.scrollbars="yes");const f=Object.entries(u).reduce((T,[R,S])=>`${T}${R}=${S},`,"");if(Jg(d)&&l!=="_self")return Vy(e||"",l),new kl(null);const v=window.open(e||"",l,f);G(v,n,"popup-blocked");try{v.focus()}catch{}return new kl(v)}function Vy(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Dy="__/auth/handler",Ny="emulator/auth/handler",xy=encodeURIComponent("fac");async function Vl(n,e,t,r,s,i){G(n.config.authDomain,n,"auth-domain-config-required"),G(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Dr,eventId:s};if(e instanceof Dh){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",_m(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,v]of Object.entries({}))a[f]=v}if(e instanceof Ds){const f=e.getScopes().filter(v=>v!=="");f.length>0&&(a.scopes=f.join(","))}n.tenantId&&(a.tid=n.tenantId);const l=a;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),d=u?`#${xy}=${encodeURIComponent(u)}`:"";return`${Oy(n)}?${Ps(l).slice(1)}${d}`}function Oy({config:n}){return n.emulator?Ca(n,Ny):`https://${n.authDomain}/${Dy}`}const Lo="webStorageSupport";class My{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jh,this._completeRedirectFn=oy,this._overrideRedirectResult=ry}async _openPopup(e,t,r,s){rn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Vl(e,t,r,ta(),s);return ky(e,i,Na())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Vl(e,t,r,ta(),s);return U_(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(rn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Ay(e),r=new cy(e);return t.register("authEvent",s=>(G(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lo,{type:Lo},s=>{const i=s?.[0]?.[Lo];i!==void 0&&t(!!i),Vt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=fy(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Sh()||wh()||ka()}}const Ly=My;var Dl="@firebase/auth",Nl="1.11.1";class Fy{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){G(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Uy(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function By(n){Ar(new Xn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;G(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ch(n)},d=new r_(r,s,i,u);return f_(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ar(new Xn("auth-internal",e=>{const t=Ln(e.getProvider("auth").getImmediate());return(r=>new Fy(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Cn(Dl,Nl,Uy(n)),Cn(Dl,Nl,"esm2020")}const jy=300,zy=rh("authIdTokenMaxAge")||jy;let xl=null;const qy=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>zy)return;const s=t?.token;xl!==s&&(xl=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function $y(n=lh()){const e=Ra(n,"auth");if(e.isInitialized())return e.getImmediate();const t=d_(n,{popupRedirectResolver:Ly,persistence:[G_,M_,jh]}),r=rh("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=qy(i.toString());D_(t,a,()=>a(t.currentUser)),V_(t,l=>a(l))}}const s=th("auth");return s&&p_(t,`http://${s}`),t}function Ky(){return document.getElementsByTagName("head")?.[0]??document}s_({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Ut("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",Ky().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});By("Browser");var Ol=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Pn,Gh;(function(){var n;function e(E,g){function m(){}m.prototype=g.prototype,E.F=g.prototype,E.prototype=new m,E.prototype.constructor=E,E.D=function(I,w,A){for(var y=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)y[ie-2]=arguments[ie];return g.prototype[w].apply(I,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,g,m){m||(m=0);const I=Array(16);if(typeof g=="string")for(var w=0;w<16;++w)I[w]=g.charCodeAt(m++)|g.charCodeAt(m++)<<8|g.charCodeAt(m++)<<16|g.charCodeAt(m++)<<24;else for(w=0;w<16;++w)I[w]=g[m++]|g[m++]<<8|g[m++]<<16|g[m++]<<24;g=E.g[0],m=E.g[1],w=E.g[2];let A=E.g[3],y;y=g+(A^m&(w^A))+I[0]+3614090360&4294967295,g=m+(y<<7&4294967295|y>>>25),y=A+(w^g&(m^w))+I[1]+3905402710&4294967295,A=g+(y<<12&4294967295|y>>>20),y=w+(m^A&(g^m))+I[2]+606105819&4294967295,w=A+(y<<17&4294967295|y>>>15),y=m+(g^w&(A^g))+I[3]+3250441966&4294967295,m=w+(y<<22&4294967295|y>>>10),y=g+(A^m&(w^A))+I[4]+4118548399&4294967295,g=m+(y<<7&4294967295|y>>>25),y=A+(w^g&(m^w))+I[5]+1200080426&4294967295,A=g+(y<<12&4294967295|y>>>20),y=w+(m^A&(g^m))+I[6]+2821735955&4294967295,w=A+(y<<17&4294967295|y>>>15),y=m+(g^w&(A^g))+I[7]+4249261313&4294967295,m=w+(y<<22&4294967295|y>>>10),y=g+(A^m&(w^A))+I[8]+1770035416&4294967295,g=m+(y<<7&4294967295|y>>>25),y=A+(w^g&(m^w))+I[9]+2336552879&4294967295,A=g+(y<<12&4294967295|y>>>20),y=w+(m^A&(g^m))+I[10]+4294925233&4294967295,w=A+(y<<17&4294967295|y>>>15),y=m+(g^w&(A^g))+I[11]+2304563134&4294967295,m=w+(y<<22&4294967295|y>>>10),y=g+(A^m&(w^A))+I[12]+1804603682&4294967295,g=m+(y<<7&4294967295|y>>>25),y=A+(w^g&(m^w))+I[13]+4254626195&4294967295,A=g+(y<<12&4294967295|y>>>20),y=w+(m^A&(g^m))+I[14]+2792965006&4294967295,w=A+(y<<17&4294967295|y>>>15),y=m+(g^w&(A^g))+I[15]+1236535329&4294967295,m=w+(y<<22&4294967295|y>>>10),y=g+(w^A&(m^w))+I[1]+4129170786&4294967295,g=m+(y<<5&4294967295|y>>>27),y=A+(m^w&(g^m))+I[6]+3225465664&4294967295,A=g+(y<<9&4294967295|y>>>23),y=w+(g^m&(A^g))+I[11]+643717713&4294967295,w=A+(y<<14&4294967295|y>>>18),y=m+(A^g&(w^A))+I[0]+3921069994&4294967295,m=w+(y<<20&4294967295|y>>>12),y=g+(w^A&(m^w))+I[5]+3593408605&4294967295,g=m+(y<<5&4294967295|y>>>27),y=A+(m^w&(g^m))+I[10]+38016083&4294967295,A=g+(y<<9&4294967295|y>>>23),y=w+(g^m&(A^g))+I[15]+3634488961&4294967295,w=A+(y<<14&4294967295|y>>>18),y=m+(A^g&(w^A))+I[4]+3889429448&4294967295,m=w+(y<<20&4294967295|y>>>12),y=g+(w^A&(m^w))+I[9]+568446438&4294967295,g=m+(y<<5&4294967295|y>>>27),y=A+(m^w&(g^m))+I[14]+3275163606&4294967295,A=g+(y<<9&4294967295|y>>>23),y=w+(g^m&(A^g))+I[3]+4107603335&4294967295,w=A+(y<<14&4294967295|y>>>18),y=m+(A^g&(w^A))+I[8]+1163531501&4294967295,m=w+(y<<20&4294967295|y>>>12),y=g+(w^A&(m^w))+I[13]+2850285829&4294967295,g=m+(y<<5&4294967295|y>>>27),y=A+(m^w&(g^m))+I[2]+4243563512&4294967295,A=g+(y<<9&4294967295|y>>>23),y=w+(g^m&(A^g))+I[7]+1735328473&4294967295,w=A+(y<<14&4294967295|y>>>18),y=m+(A^g&(w^A))+I[12]+2368359562&4294967295,m=w+(y<<20&4294967295|y>>>12),y=g+(m^w^A)+I[5]+4294588738&4294967295,g=m+(y<<4&4294967295|y>>>28),y=A+(g^m^w)+I[8]+2272392833&4294967295,A=g+(y<<11&4294967295|y>>>21),y=w+(A^g^m)+I[11]+1839030562&4294967295,w=A+(y<<16&4294967295|y>>>16),y=m+(w^A^g)+I[14]+4259657740&4294967295,m=w+(y<<23&4294967295|y>>>9),y=g+(m^w^A)+I[1]+2763975236&4294967295,g=m+(y<<4&4294967295|y>>>28),y=A+(g^m^w)+I[4]+1272893353&4294967295,A=g+(y<<11&4294967295|y>>>21),y=w+(A^g^m)+I[7]+4139469664&4294967295,w=A+(y<<16&4294967295|y>>>16),y=m+(w^A^g)+I[10]+3200236656&4294967295,m=w+(y<<23&4294967295|y>>>9),y=g+(m^w^A)+I[13]+681279174&4294967295,g=m+(y<<4&4294967295|y>>>28),y=A+(g^m^w)+I[0]+3936430074&4294967295,A=g+(y<<11&4294967295|y>>>21),y=w+(A^g^m)+I[3]+3572445317&4294967295,w=A+(y<<16&4294967295|y>>>16),y=m+(w^A^g)+I[6]+76029189&4294967295,m=w+(y<<23&4294967295|y>>>9),y=g+(m^w^A)+I[9]+3654602809&4294967295,g=m+(y<<4&4294967295|y>>>28),y=A+(g^m^w)+I[12]+3873151461&4294967295,A=g+(y<<11&4294967295|y>>>21),y=w+(A^g^m)+I[15]+530742520&4294967295,w=A+(y<<16&4294967295|y>>>16),y=m+(w^A^g)+I[2]+3299628645&4294967295,m=w+(y<<23&4294967295|y>>>9),y=g+(w^(m|~A))+I[0]+4096336452&4294967295,g=m+(y<<6&4294967295|y>>>26),y=A+(m^(g|~w))+I[7]+1126891415&4294967295,A=g+(y<<10&4294967295|y>>>22),y=w+(g^(A|~m))+I[14]+2878612391&4294967295,w=A+(y<<15&4294967295|y>>>17),y=m+(A^(w|~g))+I[5]+4237533241&4294967295,m=w+(y<<21&4294967295|y>>>11),y=g+(w^(m|~A))+I[12]+1700485571&4294967295,g=m+(y<<6&4294967295|y>>>26),y=A+(m^(g|~w))+I[3]+2399980690&4294967295,A=g+(y<<10&4294967295|y>>>22),y=w+(g^(A|~m))+I[10]+4293915773&4294967295,w=A+(y<<15&4294967295|y>>>17),y=m+(A^(w|~g))+I[1]+2240044497&4294967295,m=w+(y<<21&4294967295|y>>>11),y=g+(w^(m|~A))+I[8]+1873313359&4294967295,g=m+(y<<6&4294967295|y>>>26),y=A+(m^(g|~w))+I[15]+4264355552&4294967295,A=g+(y<<10&4294967295|y>>>22),y=w+(g^(A|~m))+I[6]+2734768916&4294967295,w=A+(y<<15&4294967295|y>>>17),y=m+(A^(w|~g))+I[13]+1309151649&4294967295,m=w+(y<<21&4294967295|y>>>11),y=g+(w^(m|~A))+I[4]+4149444226&4294967295,g=m+(y<<6&4294967295|y>>>26),y=A+(m^(g|~w))+I[11]+3174756917&4294967295,A=g+(y<<10&4294967295|y>>>22),y=w+(g^(A|~m))+I[2]+718787259&4294967295,w=A+(y<<15&4294967295|y>>>17),y=m+(A^(w|~g))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+g&4294967295,E.g[1]=E.g[1]+(w+(y<<21&4294967295|y>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+A&4294967295}r.prototype.v=function(E,g){g===void 0&&(g=E.length);const m=g-this.blockSize,I=this.C;let w=this.h,A=0;for(;A<g;){if(w==0)for(;A<=m;)s(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<g;)if(I[w++]=E.charCodeAt(A++),w==this.blockSize){s(this,I),w=0;break}}else for(;A<g;)if(I[w++]=E[A++],w==this.blockSize){s(this,I),w=0;break}}this.h=w,this.o+=g},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var g=1;g<E.length-8;++g)E[g]=0;g=this.o*8;for(var m=E.length-8;m<E.length;++m)E[m]=g&255,g/=256;for(this.v(E),E=Array(16),g=0,m=0;m<4;++m)for(let I=0;I<32;I+=8)E[g++]=this.g[m]>>>I&255;return E};function i(E,g){var m=l;return Object.prototype.hasOwnProperty.call(m,E)?m[E]:m[E]=g(E)}function a(E,g){this.h=g;const m=[];let I=!0;for(let w=E.length-1;w>=0;w--){const A=E[w]|0;I&&A==g||(m[w]=A,I=!1)}this.g=m}var l={};function u(E){return-128<=E&&E<128?i(E,function(g){return new a([g|0],g<0?-1:0)}):new a([E|0],E<0?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return v;if(E<0)return P(d(-E));const g=[];let m=1;for(let I=0;E>=m;I++)g[I]=E/m|0,m*=4294967296;return new a(g,0)}function f(E,g){if(E.length==0)throw Error("number format error: empty string");if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(E.charAt(0)=="-")return P(f(E.substring(1),g));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const m=d(Math.pow(g,8));let I=v;for(let A=0;A<E.length;A+=8){var w=Math.min(8,E.length-A);const y=parseInt(E.substring(A,A+w),g);w<8?(w=d(Math.pow(g,w)),I=I.j(w).add(d(y))):(I=I.j(m),I=I.add(d(y)))}return I}var v=u(0),T=u(1),R=u(16777216);n=a.prototype,n.m=function(){if(k(this))return-P(this).m();let E=0,g=1;for(let m=0;m<this.g.length;m++){const I=this.i(m);E+=(I>=0?I:4294967296+I)*g,g*=4294967296}return E},n.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(S(this))return"0";if(k(this))return"-"+P(this).toString(E);const g=d(Math.pow(E,6));var m=this;let I="";for(;;){const w=ne(m,g).g;m=L(m,w.j(g));let A=((m.g.length>0?m.g[0]:m.h)>>>0).toString(E);if(m=w,S(m))return A+I;for(;A.length<6;)A="0"+A;I=A+I}},n.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function S(E){if(E.h!=0)return!1;for(let g=0;g<E.g.length;g++)if(E.g[g]!=0)return!1;return!0}function k(E){return E.h==-1}n.l=function(E){return E=L(this,E),k(E)?-1:S(E)?0:1};function P(E){const g=E.g.length,m=[];for(let I=0;I<g;I++)m[I]=~E.g[I];return new a(m,~E.h).add(T)}n.abs=function(){return k(this)?P(this):this},n.add=function(E){const g=Math.max(this.g.length,E.g.length),m=[];let I=0;for(let w=0;w<=g;w++){let A=I+(this.i(w)&65535)+(E.i(w)&65535),y=(A>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);I=y>>>16,A&=65535,y&=65535,m[w]=y<<16|A}return new a(m,m[m.length-1]&-2147483648?-1:0)};function L(E,g){return E.add(P(g))}n.j=function(E){if(S(this)||S(E))return v;if(k(this))return k(E)?P(this).j(P(E)):P(P(this).j(E));if(k(E))return P(this.j(P(E)));if(this.l(R)<0&&E.l(R)<0)return d(this.m()*E.m());const g=this.g.length+E.g.length,m=[];for(var I=0;I<2*g;I++)m[I]=0;for(I=0;I<this.g.length;I++)for(let w=0;w<E.g.length;w++){const A=this.i(I)>>>16,y=this.i(I)&65535,ie=E.i(w)>>>16,ae=E.i(w)&65535;m[2*I+2*w]+=y*ae,M(m,2*I+2*w),m[2*I+2*w+1]+=A*ae,M(m,2*I+2*w+1),m[2*I+2*w+1]+=y*ie,M(m,2*I+2*w+1),m[2*I+2*w+2]+=A*ie,M(m,2*I+2*w+2)}for(E=0;E<g;E++)m[E]=m[2*E+1]<<16|m[2*E];for(E=g;E<2*g;E++)m[E]=0;return new a(m,0)};function M(E,g){for(;(E[g]&65535)!=E[g];)E[g+1]+=E[g]>>>16,E[g]&=65535,g++}function z(E,g){this.g=E,this.h=g}function ne(E,g){if(S(g))throw Error("division by zero");if(S(E))return new z(v,v);if(k(E))return g=ne(P(E),g),new z(P(g.g),P(g.h));if(k(g))return g=ne(E,P(g)),new z(P(g.g),g.h);if(E.g.length>30){if(k(E)||k(g))throw Error("slowDivide_ only works with positive integers.");for(var m=T,I=g;I.l(E)<=0;)m=Y(m),I=Y(I);var w=F(m,1),A=F(I,1);for(I=F(I,2),m=F(m,2);!S(I);){var y=A.add(I);y.l(E)<=0&&(w=w.add(m),A=y),I=F(I,1),m=F(m,1)}return g=L(E,w.j(g)),new z(w,g)}for(w=v;E.l(g)>=0;){for(m=Math.max(1,Math.floor(E.m()/g.m())),I=Math.ceil(Math.log(m)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),A=d(m),y=A.j(g);k(y)||y.l(E)>0;)m-=I,A=d(m),y=A.j(g);S(A)&&(A=T),w=w.add(A),E=L(E,y)}return new z(w,E)}n.B=function(E){return ne(this,E).h},n.and=function(E){const g=Math.max(this.g.length,E.g.length),m=[];for(let I=0;I<g;I++)m[I]=this.i(I)&E.i(I);return new a(m,this.h&E.h)},n.or=function(E){const g=Math.max(this.g.length,E.g.length),m=[];for(let I=0;I<g;I++)m[I]=this.i(I)|E.i(I);return new a(m,this.h|E.h)},n.xor=function(E){const g=Math.max(this.g.length,E.g.length),m=[];for(let I=0;I<g;I++)m[I]=this.i(I)^E.i(I);return new a(m,this.h^E.h)};function Y(E){const g=E.g.length+1,m=[];for(let I=0;I<g;I++)m[I]=E.i(I)<<1|E.i(I-1)>>>31;return new a(m,E.h)}function F(E,g){const m=g>>5;g%=32;const I=E.g.length-m,w=[];for(let A=0;A<I;A++)w[A]=g>0?E.i(A+m)>>>g|E.i(A+m+1)<<32-g:E.i(A+m);return new a(w,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Gh=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=f,Pn=a}).apply(typeof Ol<"u"?Ol:typeof self<"u"?self:typeof window<"u"?window:{});var Zs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Qh,as,Yh,ci,sa,Jh,Xh,Zh;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zs=="object"&&Zs];for(var c=0;c<o.length;++c){var h=o[c];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function s(o,c){if(c)e:{var h=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var b=o[p];if(!(b in h))break e;h=h[b]}o=o[o.length-1],p=h[o],c=c(p),c!=p&&c!=null&&e(h,o,{configurable:!0,writable:!0,value:c})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(c){var h=[],p;for(p in c)Object.prototype.hasOwnProperty.call(c,p)&&h.push([p,c[p]]);return h}});var i=i||{},a=this||self;function l(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function u(o,c,h){return o.call.apply(o.bind,arguments)}function d(o,c,h){return d=u,d.apply(null,arguments)}function f(o,c){var h=Array.prototype.slice.call(arguments,1);return function(){var p=h.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function v(o,c){function h(){}h.prototype=c.prototype,o.Z=c.prototype,o.prototype=new h,o.prototype.constructor=o,o.Ob=function(p,b,C){for(var O=Array(arguments.length-2),se=2;se<arguments.length;se++)O[se-2]=arguments[se];return c.prototype[b].apply(p,O)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function R(o){const c=o.length;if(c>0){const h=Array(c);for(let p=0;p<c;p++)h[p]=o[p];return h}return[]}function S(o,c){for(let p=1;p<arguments.length;p++){const b=arguments[p];var h=typeof b;if(h=h!="object"?h:b?Array.isArray(b)?"array":h:"null",h=="array"||h=="object"&&typeof b.length=="number"){h=o.length||0;const C=b.length||0;o.length=h+C;for(let O=0;O<C;O++)o[h+O]=b[O]}else o.push(b)}}class k{constructor(c,h){this.i=c,this.j=h,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function P(o){a.setTimeout(()=>{throw o},0)}function L(){var o=E;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class M{constructor(){this.h=this.g=null}add(c,h){const p=z.get();p.set(c,h),this.h?this.h.next=p:this.g=p,this.h=p}}var z=new k(()=>new ne,o=>o.reset());class ne{constructor(){this.next=this.g=this.h=null}set(c,h){this.h=c,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,F=!1,E=new M,g=()=>{const o=Promise.resolve(void 0);Y=()=>{o.then(m)}};function m(){for(var o;o=L();){try{o.h.call(o.g)}catch(h){P(h)}var c=z;c.j(o),c.h<100&&(c.h++,o.next=c.g,c.g=o)}F=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const h=()=>{};a.addEventListener("test",h,c),a.removeEventListener("test",h,c)}catch{}return o})();function y(o){return/^[\s\xa0]*$/.test(o)}function ie(o,c){w.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,c)}v(ie,w),ie.prototype.init=function(o,c){const h=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget,c||(h=="mouseover"?c=o.fromElement:h=="mouseout"&&(c=o.toElement)),this.relatedTarget=c,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&ie.Z.h.call(this)},ie.prototype.h=function(){ie.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var ae="closure_listenable_"+(Math.random()*1e6|0),ee=0;function Re(o,c,h,p,b){this.listener=o,this.proxy=null,this.src=c,this.type=h,this.capture=!!p,this.ha=b,this.key=++ee,this.da=this.fa=!1}function Ee(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function x(o,c,h){for(const p in o)c.call(h,o[p],p,o)}function q(o,c){for(const h in o)c.call(void 0,o[h],h,o)}function $(o){const c={};for(const h in o)c[h]=o[h];return c}const J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function he(o,c){let h,p;for(let b=1;b<arguments.length;b++){p=arguments[b];for(h in p)o[h]=p[h];for(let C=0;C<J.length;C++)h=J[C],Object.prototype.hasOwnProperty.call(p,h)&&(o[h]=p[h])}}function re(o){this.src=o,this.g={},this.h=0}re.prototype.add=function(o,c,h,p,b){const C=o.toString();o=this.g[C],o||(o=this.g[C]=[],this.h++);const O=De(o,c,p,b);return O>-1?(c=o[O],h||(c.fa=!1)):(c=new Re(c,this.src,C,!!p,b),c.fa=h,o.push(c)),c};function ge(o,c){const h=c.type;if(h in o.g){var p=o.g[h],b=Array.prototype.indexOf.call(p,c,void 0),C;(C=b>=0)&&Array.prototype.splice.call(p,b,1),C&&(Ee(c),o.g[h].length==0&&(delete o.g[h],o.h--))}}function De(o,c,h,p){for(let b=0;b<o.length;++b){const C=o[b];if(!C.da&&C.listener==c&&C.capture==!!h&&C.ha==p)return b}return-1}var Ze="closure_lm_"+(Math.random()*1e6|0),Ke={};function Ne(o,c,h,p,b){if(Array.isArray(c)){for(let C=0;C<c.length;C++)Ne(o,c[C],h,p,b);return null}return h=mt(h),o&&o[ae]?o.J(c,h,l(p)?!!p.capture:!1,b):_e(o,c,h,!1,p,b)}function _e(o,c,h,p,b,C){if(!c)throw Error("Invalid event type");const O=l(b)?!!b.capture:!!b;let se=Gt(o);if(se||(o[Ze]=se=new re(o)),h=se.add(c,h,p,O,C),h.proxy)return h;if(p=Te(),h.proxy=p,p.src=o,p.listener=h,o.addEventListener)A||(b=O),b===void 0&&(b=!1),o.addEventListener(c.toString(),p,b);else if(o.attachEvent)o.attachEvent(ut(c.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return h}function Te(){function o(h){return c.call(o.src,o.listener,h)}const c=bt;return o}function ke(o,c,h,p,b){if(Array.isArray(c))for(var C=0;C<c.length;C++)ke(o,c[C],h,p,b);else p=l(p)?!!p.capture:!!p,h=mt(h),o&&o[ae]?(o=o.i,C=String(c).toString(),C in o.g&&(c=o.g[C],h=De(c,h,p,b),h>-1&&(Ee(c[h]),Array.prototype.splice.call(c,h,1),c.length==0&&(delete o.g[C],o.h--)))):o&&(o=Gt(o))&&(c=o.g[c.toString()],o=-1,c&&(o=De(c,h,p,b)),(h=o>-1?c[o]:null)&&et(h))}function et(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[ae])ge(c.i,o);else{var h=o.type,p=o.proxy;c.removeEventListener?c.removeEventListener(h,p,o.capture):c.detachEvent?c.detachEvent(ut(h),p):c.addListener&&c.removeListener&&c.removeListener(p),(h=Gt(c))?(ge(h,o),h.h==0&&(h.src=null,c[Ze]=null)):Ee(o)}}}function ut(o){return o in Ke?Ke[o]:Ke[o]="on"+o}function bt(o,c){if(o.da)o=!0;else{c=new ie(c,this);const h=o.listener,p=o.ha||o.src;o.fa&&et(o),o=h.call(p,c)}return o}function Gt(o){return o=o[Ze],o instanceof re?o:null}var un="__closure_events_fn_"+(Math.random()*1e9>>>0);function mt(o){return typeof o=="function"?o:(o[un]||(o[un]=function(c){return o.handleEvent(c)}),o[un])}function be(){I.call(this),this.i=new re(this),this.M=this,this.G=null}v(be,I),be.prototype[ae]=!0,be.prototype.removeEventListener=function(o,c,h,p){ke(this,o,c,h,p)};function pe(o,c){var h,p=o.G;if(p)for(h=[];p;p=p.G)h.push(p);if(o=o.M,p=c.type||c,typeof c=="string")c=new w(c,o);else if(c instanceof w)c.target=c.target||o;else{var b=c;c=new w(p,o),he(c,b)}b=!0;let C,O;if(h)for(O=h.length-1;O>=0;O--)C=c.g=h[O],b=Dt(C,p,!0,c)&&b;if(C=c.g=o,b=Dt(C,p,!0,c)&&b,b=Dt(C,p,!1,c)&&b,h)for(O=0;O<h.length;O++)C=c.g=h[O],b=Dt(C,p,!1,c)&&b}be.prototype.N=function(){if(be.Z.N.call(this),this.i){var o=this.i;for(const c in o.g){const h=o.g[c];for(let p=0;p<h.length;p++)Ee(h[p]);delete o.g[c],o.h--}}this.G=null},be.prototype.J=function(o,c,h,p){return this.i.add(String(o),c,!1,h,p)},be.prototype.K=function(o,c,h,p){return this.i.add(String(o),c,!0,h,p)};function Dt(o,c,h,p){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();let b=!0;for(let C=0;C<c.length;++C){const O=c[C];if(O&&!O.da&&O.capture==h){const se=O.listener,He=O.ha||O.src;O.fa&&ge(o.i,O),b=se.call(He,p)!==!1&&b}}return b&&!p.defaultPrevented}function Fr(o,c){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=d(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:a.setTimeout(o,c||0)}function Ur(o){o.g=Fr(()=>{o.g=null,o.i&&(o.i=!1,Ur(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class co extends I{constructor(c,h){super(),this.m=c,this.l=h,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Ur(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hn(o){I.call(this),this.h=o,this.g={}}v(hn,I);var Us=[];function Br(o){x(o.g,function(c,h){this.g.hasOwnProperty(h)&&et(c)},o),o.g={}}hn.prototype.N=function(){hn.Z.N.call(this),Br(this)},hn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jr=a.JSON.stringify,Bs=a.JSON.parse,lo=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function zr(){}function Qe(){}var Le={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Be(){w.call(this,"d")}v(Be,w);function tt(){w.call(this,"c")}v(tt,w);var je={},gt=null;function _t(){return gt=gt||new be}je.Ia="serverreachability";function Nt(o){w.call(this,je.Ia,o)}v(Nt,w);function Fe(o){const c=_t();pe(c,new Nt(c))}je.STAT_EVENT="statevent";function nt(o,c){w.call(this,je.STAT_EVENT,o),this.stat=c}v(nt,w);function ye(o){const c=_t();pe(c,new nt(c,o))}je.Ja="timingevent";function dn(o,c){w.call(this,je.Ja,o),this.size=c}v(dn,w);function Bn(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},c)}function qr(){this.g=!0}qr.prototype.ua=function(){this.g=!1};function Pf(o,c,h,p,b,C){o.info(function(){if(o.g)if(C){var O="",se=C.split("&");for(let Ae=0;Ae<se.length;Ae++){var He=se[Ae].split("=");if(He.length>1){const Ye=He[0];He=He[1];const Ot=Ye.split("_");O=Ot.length>=2&&Ot[1]=="type"?O+(Ye+"="+He+"&"):O+(Ye+"=redacted&")}}}else O=null;else O=C;return"XMLHTTP REQ ("+p+") [attempt "+b+"]: "+c+`
`+h+`
`+O})}function kf(o,c,h,p,b,C,O){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+b+"]: "+c+`
`+h+`
`+C+" "+O})}function or(o,c,h,p){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+Df(o,h)+(p?" "+p:"")})}function Vf(o,c){o.info(function(){return"TIMEOUT: "+c})}qr.prototype.info=function(){};function Df(o,c){if(!o.g)return c;if(!c)return null;try{const C=JSON.parse(c);if(C){for(o=0;o<C.length;o++)if(Array.isArray(C[o])){var h=C[o];if(!(h.length<2)){var p=h[1];if(Array.isArray(p)&&!(p.length<1)){var b=p[0];if(b!="noop"&&b!="stop"&&b!="close")for(let O=1;O<p.length;O++)p[O]=""}}}}return jr(C)}catch{return c}}var js={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},mc;function uo(){}v(uo,zr),uo.prototype.g=function(){return new XMLHttpRequest},mc=new uo;function $r(o){return encodeURIComponent(String(o))}function Nf(o){var c=1;o=o.split(":");const h=[];for(;c>0&&o.length;)h.push(o.shift()),c--;return o.length&&h.push(o.join(":")),h}function fn(o,c,h,p){this.j=o,this.i=c,this.l=h,this.S=p||1,this.V=new hn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gc}function gc(){this.i=null,this.g="",this.h=!1}var _c={},ho={};function fo(o,c,h){o.M=1,o.A=qs(xt(c)),o.u=h,o.R=!0,yc(o,null)}function yc(o,c){o.F=Date.now(),zs(o),o.B=xt(o.A);var h=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),Vc(h.i,"t",p),o.C=0,h=o.j.L,o.h=new gc,o.g=Qc(o.j,h?c:null,!o.u),o.P>0&&(o.O=new co(d(o.Y,o,o.g),o.P)),c=o.V,h=o.g,p=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(Us[0]=b.toString()),b=Us);for(let C=0;C<b.length;C++){const O=Ne(h,b[C],p||c.handleEvent,!1,c.h||c);if(!O)break;c.g[O.key]=O}c=o.J?$(o.J):{},o.u?(o.v||(o.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,c)):(o.v="GET",o.g.ea(o.B,o.v,null,c)),Fe(),Pf(o.i,o.v,o.B,o.l,o.S,o.u)}fn.prototype.ba=function(o){o=o.target;const c=this.O;c&&gn(o)==3?c.j():this.Y(o)},fn.prototype.Y=function(o){try{if(o==this.g)e:{const se=gn(this.g),He=this.g.ya(),Ae=this.g.ca();if(!(se<3)&&(se!=3||this.g&&(this.h.h||this.g.la()||Fc(this.g)))){this.K||se!=4||He==7||(He==8||Ae<=0?Fe(3):Fe(2)),po(this);var c=this.g.ca();this.X=c;var h=xf(this);if(this.o=c==200,kf(this.i,this.v,this.B,this.l,this.S,se,c),this.o){if(this.U&&!this.L){t:{if(this.g){var p,b=this.g;if((p=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var C=p;break t}}C=null}if(o=C)or(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,mo(this,o);else{this.o=!1,this.m=3,ye(12),jn(this),Kr(this);break e}}if(this.R){o=!0;let Ye;for(;!this.K&&this.C<h.length;)if(Ye=Of(this,h),Ye==ho){se==4&&(this.m=4,ye(14),o=!1),or(this.i,this.l,null,"[Incomplete Response]");break}else if(Ye==_c){this.m=4,ye(15),or(this.i,this.l,h,"[Invalid Chunk]"),o=!1;break}else or(this.i,this.l,Ye,null),mo(this,Ye);if(vc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),se!=4||h.length!=0||this.h.h||(this.m=1,ye(16),o=!1),this.o=this.o&&o,!o)or(this.i,this.l,h,"[Invalid Chunked Response]"),jn(this),Kr(this);else if(h.length>0&&!this.W){this.W=!0;var O=this.j;O.g==this&&O.aa&&!O.P&&(O.j.info("Great, no buffering proxy detected. Bytes received: "+h.length),Io(O),O.P=!0,ye(11))}}else or(this.i,this.l,h,null),mo(this,h);se==4&&jn(this),this.o&&!this.K&&(se==4?Kc(this.j,this):(this.o=!1,zs(this)))}else Qf(this.g),c==400&&h.indexOf("Unknown SID")>0?(this.m=3,ye(12)):(this.m=0,ye(13)),jn(this),Kr(this)}}}catch{}finally{}};function xf(o){if(!vc(o))return o.g.la();const c=Fc(o.g);if(c==="")return"";let h="";const p=c.length,b=gn(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return jn(o),Kr(o),"";o.h.i=new a.TextDecoder}for(let C=0;C<p;C++)o.h.h=!0,h+=o.h.i.decode(c[C],{stream:!(b&&C==p-1)});return c.length=0,o.h.g+=h,o.C=0,o.h.g}function vc(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Of(o,c){var h=o.C,p=c.indexOf(`
`,h);return p==-1?ho:(h=Number(c.substring(h,p)),isNaN(h)?_c:(p+=1,p+h>c.length?ho:(c=c.slice(p,p+h),o.C=p+h,c)))}fn.prototype.cancel=function(){this.K=!0,jn(this)};function zs(o){o.T=Date.now()+o.H,Ec(o,o.H)}function Ec(o,c){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Bn(d(o.aa,o),c)}function po(o){o.D&&(a.clearTimeout(o.D),o.D=null)}fn.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(Vf(this.i,this.B),this.M!=2&&(Fe(),ye(17)),jn(this),this.m=2,Kr(this)):Ec(this,this.T-o)};function Kr(o){o.j.I==0||o.K||Kc(o.j,o)}function jn(o){po(o);var c=o.O;c&&typeof c.dispose=="function"&&c.dispose(),o.O=null,Br(o.V),o.g&&(c=o.g,o.g=null,c.abort(),c.dispose())}function mo(o,c){try{var h=o.j;if(h.I!=0&&(h.g==o||go(h.h,o))){if(!o.L&&go(h.h,o)&&h.I==3){try{var p=h.Ba.g.parse(c)}catch{p=null}if(Array.isArray(p)&&p.length==3){var b=p;if(b[0]==0){e:if(!h.v){if(h.g)if(h.g.F+3e3<o.F)Gs(h),Hs(h);else break e;To(h),ye(18)}}else h.xa=b[1],0<h.xa-h.K&&b[2]<37500&&h.F&&h.A==0&&!h.C&&(h.C=Bn(d(h.Va,h),6e3));Ic(h.h)<=1&&h.ta&&(h.ta=void 0)}else qn(h,11)}else if((o.L||h.g==o)&&Gs(h),!y(c))for(b=h.Ba.g.parse(c),c=0;c<b.length;c++){let Ae=b[c];const Ye=Ae[0];if(!(Ye<=h.K))if(h.K=Ye,Ae=Ae[1],h.I==2)if(Ae[0]=="c"){h.M=Ae[1],h.ba=Ae[2];const Ot=Ae[3];Ot!=null&&(h.ka=Ot,h.j.info("VER="+h.ka));const $n=Ae[4];$n!=null&&(h.za=$n,h.j.info("SVER="+h.za));const _n=Ae[5];_n!=null&&typeof _n=="number"&&_n>0&&(p=1.5*_n,h.O=p,h.j.info("backChannelRequestTimeoutMs_="+p)),p=h;const yn=o.g;if(yn){const Ys=yn.g?yn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ys){var C=p.h;C.g||Ys.indexOf("spdy")==-1&&Ys.indexOf("quic")==-1&&Ys.indexOf("h2")==-1||(C.j=C.l,C.g=new Set,C.h&&(_o(C,C.h),C.h=null))}if(p.G){const Ao=yn.g?yn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ao&&(p.wa=Ao,Se(p.J,p.G,Ao))}}h.I=3,h.l&&h.l.ra(),h.aa&&(h.T=Date.now()-o.F,h.j.info("Handshake RTT: "+h.T+"ms")),p=h;var O=o;if(p.na=Gc(p,p.L?p.ba:null,p.W),O.L){Ac(p.h,O);var se=O,He=p.O;He&&(se.H=He),se.D&&(po(se),zs(se)),p.g=O}else qc(p);h.i.length>0&&Ws(h)}else Ae[0]!="stop"&&Ae[0]!="close"||qn(h,7);else h.I==3&&(Ae[0]=="stop"||Ae[0]=="close"?Ae[0]=="stop"?qn(h,7):wo(h):Ae[0]!="noop"&&h.l&&h.l.qa(Ae),h.A=0)}}Fe(4)}catch{}}var Mf=class{constructor(o,c){this.g=o,this.map=c}};function wc(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Tc(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Ic(o){return o.h?1:o.g?o.g.size:0}function go(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function _o(o,c){o.g?o.g.add(c):o.h=c}function Ac(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}wc.prototype.cancel=function(){if(this.i=bc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function bc(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const h of o.g.values())c=c.concat(h.G);return c}return R(o.i)}var Rc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Lf(o,c){if(o){o=o.split("&");for(let h=0;h<o.length;h++){const p=o[h].indexOf("=");let b,C=null;p>=0?(b=o[h].substring(0,p),C=o[h].substring(p+1)):b=o[h],c(b,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function pn(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;o instanceof pn?(this.l=o.l,Hr(this,o.j),this.o=o.o,this.g=o.g,Wr(this,o.u),this.h=o.h,yo(this,Dc(o.i)),this.m=o.m):o&&(c=String(o).match(Rc))?(this.l=!1,Hr(this,c[1]||"",!0),this.o=Gr(c[2]||""),this.g=Gr(c[3]||"",!0),Wr(this,c[4]),this.h=Gr(c[5]||"",!0),yo(this,c[6]||"",!0),this.m=Gr(c[7]||"")):(this.l=!1,this.i=new Yr(null,this.l))}pn.prototype.toString=function(){const o=[];var c=this.j;c&&o.push(Qr(c,Sc,!0),":");var h=this.g;return(h||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Qr(c,Sc,!0),"@"),o.push($r(h).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.u,h!=null&&o.push(":",String(h))),(h=this.h)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(Qr(h,h.charAt(0)=="/"?Bf:Uf,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",Qr(h,zf)),o.join("")},pn.prototype.resolve=function(o){const c=xt(this);let h=!!o.j;h?Hr(c,o.j):h=!!o.o,h?c.o=o.o:h=!!o.g,h?c.g=o.g:h=o.u!=null;var p=o.h;if(h)Wr(c,o.u);else if(h=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var b=c.h.lastIndexOf("/");b!=-1&&(p=c.h.slice(0,b+1)+p)}if(b=p,b==".."||b==".")p="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){p=b.lastIndexOf("/",0)==0,b=b.split("/");const C=[];for(let O=0;O<b.length;){const se=b[O++];se=="."?p&&O==b.length&&C.push(""):se==".."?((C.length>1||C.length==1&&C[0]!="")&&C.pop(),p&&O==b.length&&C.push("")):(C.push(se),p=!0)}p=C.join("/")}else p=b}return h?c.h=p:h=o.i.toString()!=="",h?yo(c,Dc(o.i)):h=!!o.m,h&&(c.m=o.m),c};function xt(o){return new pn(o)}function Hr(o,c,h){o.j=h?Gr(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function Wr(o,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);o.u=c}else o.u=null}function yo(o,c,h){c instanceof Yr?(o.i=c,qf(o.i,o.l)):(h||(c=Qr(c,jf)),o.i=new Yr(c,o.l))}function Se(o,c,h){o.i.set(c,h)}function qs(o){return Se(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function Gr(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Qr(o,c,h){return typeof o=="string"?(o=encodeURI(o).replace(c,Ff),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Ff(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Sc=/[#\/\?@]/g,Uf=/[#\?:]/g,Bf=/[#\?]/g,jf=/[#\?@]/g,zf=/#/g;function Yr(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function zn(o){o.g||(o.g=new Map,o.h=0,o.i&&Lf(o.i,function(c,h){o.add(decodeURIComponent(c.replace(/\+/g," ")),h)}))}n=Yr.prototype,n.add=function(o,c){zn(this),this.i=null,o=ar(this,o);let h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(c),this.h+=1,this};function Cc(o,c){zn(o),c=ar(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function Pc(o,c){return zn(o),c=ar(o,c),o.g.has(c)}n.forEach=function(o,c){zn(this),this.g.forEach(function(h,p){h.forEach(function(b){o.call(c,b,p,this)},this)},this)};function kc(o,c){zn(o);let h=[];if(typeof c=="string")Pc(o,c)&&(h=h.concat(o.g.get(ar(o,c))));else for(o=Array.from(o.g.values()),c=0;c<o.length;c++)h=h.concat(o[c]);return h}n.set=function(o,c){return zn(this),this.i=null,o=ar(this,o),Pc(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=kc(this,o),o.length>0?String(o[0]):c):c};function Vc(o,c,h){Cc(o,c),h.length>0&&(o.i=null,o.g.set(ar(o,c),R(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(let p=0;p<c.length;p++){var h=c[p];const b=$r(h);h=kc(this,h);for(let C=0;C<h.length;C++){let O=b;h[C]!==""&&(O+="="+$r(h[C])),o.push(O)}}return this.i=o.join("&")};function Dc(o){const c=new Yr;return c.i=o.i,o.g&&(c.g=new Map(o.g),c.h=o.h),c}function ar(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function qf(o,c){c&&!o.j&&(zn(o),o.i=null,o.g.forEach(function(h,p){const b=p.toLowerCase();p!=b&&(Cc(this,p),Vc(this,b,h))},o)),o.j=c}function $f(o,c){const h=new qr;if(a.Image){const p=new Image;p.onload=f(mn,h,"TestLoadImage: loaded",!0,c,p),p.onerror=f(mn,h,"TestLoadImage: error",!1,c,p),p.onabort=f(mn,h,"TestLoadImage: abort",!1,c,p),p.ontimeout=f(mn,h,"TestLoadImage: timeout",!1,c,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else c(!1)}function Kf(o,c){const h=new qr,p=new AbortController,b=setTimeout(()=>{p.abort(),mn(h,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:p.signal}).then(C=>{clearTimeout(b),C.ok?mn(h,"TestPingServer: ok",!0,c):mn(h,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(b),mn(h,"TestPingServer: error",!1,c)})}function mn(o,c,h,p,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),p(h)}catch{}}function Hf(){this.g=new lo}function vo(o){this.i=o.Sb||null,this.h=o.ab||!1}v(vo,zr),vo.prototype.g=function(){return new $s(this.i,this.h)};function $s(o,c){be.call(this),this.H=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v($s,be),n=$s.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=c,this.readyState=1,Xr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(c.body=o),(this.H||a).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Jr(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Xr(this)),this.g&&(this.readyState=3,Xr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Nc(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Nc(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Jr(this):Xr(this),this.readyState==3&&Nc(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,Jr(this))},n.Na=function(o){this.g&&(this.response=o,Jr(this))},n.ga=function(){this.g&&Jr(this)};function Jr(o){o.readyState=4,o.l=null,o.j=null,o.B=null,Xr(o)}n.setRequestHeader=function(o,c){this.A.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var h=c.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=c.next();return o.join(`\r
`)};function Xr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty($s.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function xc(o){let c="";return x(o,function(h,p){c+=p,c+=":",c+=h,c+=`\r
`}),c}function Eo(o,c,h){e:{for(p in h){var p=!1;break e}p=!0}p||(h=xc(h),typeof o=="string"?h!=null&&$r(h):Se(o,c,h))}function Oe(o){be.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(Oe,be);var Wf=/^https?$/i,Gf=["POST","PUT"];n=Oe.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,c,h,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mc.g(),this.g.onreadystatechange=T(d(this.Ca,this));try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(C){Oc(this,C);return}if(o=h||"",h=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var b in p)h.set(b,p[b]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const C of p.keys())h.set(C,p.get(C));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(h.keys()).find(C=>C.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(Gf,c,void 0)>=0)||p||b||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[C,O]of h)this.g.setRequestHeader(C,O);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(C){Oc(this,C)}};function Oc(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.o=5,Mc(o),Ks(o)}function Mc(o){o.A||(o.A=!0,pe(o,"complete"),pe(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,pe(this,"complete"),pe(this,"abort"),Ks(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ks(this,!0)),Oe.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Lc(this):this.Xa())},n.Xa=function(){Lc(this)};function Lc(o){if(o.h&&typeof i<"u"){if(o.v&&gn(o)==4)setTimeout(o.Ca.bind(o),0);else if(pe(o,"readystatechange"),gn(o)==4){o.h=!1;try{const C=o.ca();e:switch(C){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var h;if(!(h=c)){var p;if(p=C===0){let O=String(o.D).match(Rc)[1]||null;!O&&a.self&&a.self.location&&(O=a.self.location.protocol.slice(0,-1)),p=!Wf.test(O?O.toLowerCase():"")}h=p}if(h)pe(o,"complete"),pe(o,"success");else{o.o=6;try{var b=gn(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",Mc(o)}}finally{Ks(o)}}}}function Ks(o,c){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const h=o.g;o.g=null,c||pe(o,"ready");try{h.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function gn(o){return o.g?o.g.readyState:0}n.ca=function(){try{return gn(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Bs(c)}};function Fc(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Qf(o){const c={};o=(o.g&&gn(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(y(o[p]))continue;var h=Nf(o[p]);const b=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();const C=c[b]||[];c[b]=C,C.push(h)}q(c,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(o,c,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||c}function Uc(o){this.za=0,this.i=[],this.j=new qr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Zr("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Zr("baseRetryDelayMs",5e3,o),this.Za=Zr("retryDelaySeedMs",1e4,o),this.Ta=Zr("forwardChannelMaxRetries",2,o),this.va=Zr("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new wc(o&&o.concurrentRequestLimit),this.Ba=new Hf,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Uc.prototype,n.ka=8,n.I=1,n.connect=function(o,c,h,p){ye(0),this.W=o,this.H=c||{},h&&p!==void 0&&(this.H.OSID=h,this.H.OAID=p),this.F=this.X,this.J=Gc(this,null,this.W),Ws(this)};function wo(o){if(Bc(o),o.I==3){var c=o.V++,h=xt(o.J);if(Se(h,"SID",o.M),Se(h,"RID",c),Se(h,"TYPE","terminate"),es(o,h),c=new fn(o,o.j,c),c.M=2,c.A=qs(xt(h)),h=!1,a.navigator&&a.navigator.sendBeacon)try{h=a.navigator.sendBeacon(c.A.toString(),"")}catch{}!h&&a.Image&&(new Image().src=c.A,h=!0),h||(c.g=Qc(c.j,null),c.g.ea(c.A)),c.F=Date.now(),zs(c)}Wc(o)}function Hs(o){o.g&&(Io(o),o.g.cancel(),o.g=null)}function Bc(o){Hs(o),o.v&&(a.clearTimeout(o.v),o.v=null),Gs(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function Ws(o){if(!Tc(o.h)&&!o.m){o.m=!0;var c=o.Ea;Y||g(),F||(Y(),F=!0),E.add(c,o),o.D=0}}function Yf(o,c){return Ic(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=c.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Bn(d(o.Ea,o,c),Hc(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new fn(this,this.j,o);let C=this.o;if(this.U&&(C?(C=$(C),he(C,this.U)):C=this.U),this.u!==null||this.R||(b.J=C,C=null),this.S)e:{for(var c=0,h=0;h<this.i.length;h++){t:{var p=this.i[h];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(c+=p,c>4096){c=h;break e}if(c===4096||h===this.i.length-1){c=h+1;break e}}c=1e3}else c=1e3;c=zc(this,b,c),h=xt(this.J),Se(h,"RID",o),Se(h,"CVER",22),this.G&&Se(h,"X-HTTP-Session-Id",this.G),es(this,h),C&&(this.R?c="headers="+$r(xc(C))+"&"+c:this.u&&Eo(h,this.u,C)),_o(this.h,b),this.Ra&&Se(h,"TYPE","init"),this.S?(Se(h,"$req",c),Se(h,"SID","null"),b.U=!0,fo(b,h,null)):fo(b,h,c),this.I=2}}else this.I==3&&(o?jc(this,o):this.i.length==0||Tc(this.h)||jc(this))};function jc(o,c){var h;c?h=c.l:h=o.V++;const p=xt(o.J);Se(p,"SID",o.M),Se(p,"RID",h),Se(p,"AID",o.K),es(o,p),o.u&&o.o&&Eo(p,o.u,o.o),h=new fn(o,o.j,h,o.D+1),o.u===null&&(h.J=o.o),c&&(o.i=c.G.concat(o.i)),c=zc(o,h,1e3),h.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),_o(o.h,h),fo(h,p,c)}function es(o,c){o.H&&x(o.H,function(h,p){Se(c,p,h)}),o.l&&x({},function(h,p){Se(c,p,h)})}function zc(o,c,h){h=Math.min(o.i.length,h);const p=o.l?d(o.l.Ka,o.l,o):null;e:{var b=o.i;let se=-1;for(;;){const He=["count="+h];se==-1?h>0?(se=b[0].g,He.push("ofs="+se)):se=0:He.push("ofs="+se);let Ae=!0;for(let Ye=0;Ye<h;Ye++){var C=b[Ye].g;const Ot=b[Ye].map;if(C-=se,C<0)se=Math.max(0,b[Ye].g-100),Ae=!1;else try{C="req"+C+"_"||"";try{var O=Ot instanceof Map?Ot:Object.entries(Ot);for(const[$n,_n]of O){let yn=_n;l(_n)&&(yn=jr(_n)),He.push(C+$n+"="+encodeURIComponent(yn))}}catch($n){throw He.push(C+"type="+encodeURIComponent("_badmap")),$n}}catch{p&&p(Ot)}}if(Ae){O=He.join("&");break e}}O=void 0}return o=o.i.splice(0,h),c.G=o,O}function qc(o){if(!o.g&&!o.v){o.Y=1;var c=o.Da;Y||g(),F||(Y(),F=!0),E.add(c,o),o.A=0}}function To(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Bn(d(o.Da,o),Hc(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,$c(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Bn(d(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ye(10),Hs(this),$c(this))};function Io(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function $c(o){o.g=new fn(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var c=xt(o.na);Se(c,"RID","rpc"),Se(c,"SID",o.M),Se(c,"AID",o.K),Se(c,"CI",o.F?"0":"1"),!o.F&&o.ia&&Se(c,"TO",o.ia),Se(c,"TYPE","xmlhttp"),es(o,c),o.u&&o.o&&Eo(c,o.u,o.o),o.O&&(o.g.H=o.O);var h=o.g;o=o.ba,h.M=1,h.A=qs(xt(c)),h.u=null,h.R=!0,yc(h,o)}n.Va=function(){this.C!=null&&(this.C=null,Hs(this),To(this),ye(19))};function Gs(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function Kc(o,c){var h=null;if(o.g==c){Gs(o),Io(o),o.g=null;var p=2}else if(go(o.h,c))h=c.G,Ac(o.h,c),p=1;else return;if(o.I!=0){if(c.o)if(p==1){h=c.u?c.u.length:0,c=Date.now()-c.F;var b=o.D;p=_t(),pe(p,new dn(p,h)),Ws(o)}else qc(o);else if(b=c.m,b==3||b==0&&c.X>0||!(p==1&&Yf(o,c)||p==2&&To(o)))switch(h&&h.length>0&&(c=o.h,c.i=c.i.concat(h)),b){case 1:qn(o,5);break;case 4:qn(o,10);break;case 3:qn(o,6);break;default:qn(o,2)}}}function Hc(o,c){let h=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(h*=2),h*c}function qn(o,c){if(o.j.info("Error code "+c),c==2){var h=d(o.bb,o),p=o.Ua;const b=!p;p=new pn(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Hr(p,"https"),qs(p),b?$f(p.toString(),h):Kf(p.toString(),h)}else ye(2);o.I=0,o.l&&o.l.pa(c),Wc(o),Bc(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),ye(2)):(this.j.info("Failed to ping google.com"),ye(1))};function Wc(o){if(o.I=0,o.ja=[],o.l){const c=bc(o.h);(c.length!=0||o.i.length!=0)&&(S(o.ja,c),S(o.ja,o.i),o.h.i.length=0,R(o.i),o.i.length=0),o.l.oa()}}function Gc(o,c,h){var p=h instanceof pn?xt(h):new pn(h);if(p.g!="")c&&(p.g=c+"."+p.g),Wr(p,p.u);else{var b=a.location;p=b.protocol,c=c?c+"."+b.hostname:b.hostname,b=+b.port;const C=new pn(null);p&&Hr(C,p),c&&(C.g=c),b&&Wr(C,b),h&&(C.h=h),p=C}return h=o.G,c=o.wa,h&&c&&Se(p,h,c),Se(p,"VER",o.ka),es(o,p),p}function Qc(o,c,h){if(c&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Aa&&!o.ma?new Oe(new vo({ab:h})):new Oe(o.ma),c.Fa(o.L),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yc(){}n=Yc.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Qs(){}Qs.prototype.g=function(o,c){return new yt(o,c)};function yt(o,c){be.call(this),this.g=new Uc(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(o?o["X-WebChannel-Client-Profile"]=c.sa:o={"X-WebChannel-Client-Profile":c.sa}),this.g.U=o,(o=c&&c.Qb)&&!y(o)&&(this.g.u=o),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!y(c)&&(this.g.G=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new cr(this)}v(yt,be),yt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yt.prototype.close=function(){wo(this.g)},yt.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.v&&(h={},h.__data__=jr(o),o=h);c.i.push(new Mf(c.Ya++,o)),c.I==3&&Ws(c)},yt.prototype.N=function(){this.g.l=null,delete this.j,wo(this.g),delete this.g,yt.Z.N.call(this)};function Jc(o){Be.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const h in c){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}v(Jc,Be);function Xc(){tt.call(this),this.status=1}v(Xc,tt);function cr(o){this.g=o}v(cr,Yc),cr.prototype.ra=function(){pe(this.g,"a")},cr.prototype.qa=function(o){pe(this.g,new Jc(o))},cr.prototype.pa=function(o){pe(this.g,new Xc)},cr.prototype.oa=function(){pe(this.g,"b")},Qs.prototype.createWebChannel=Qs.prototype.g,yt.prototype.send=yt.prototype.o,yt.prototype.open=yt.prototype.m,yt.prototype.close=yt.prototype.close,Zh=function(){return new Qs},Xh=function(){return _t()},Jh=je,sa={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},js.NO_ERROR=0,js.TIMEOUT=8,js.HTTP_ERROR=6,ci=js,pc.COMPLETE="complete",Yh=pc,Qe.EventType=Le,Le.OPEN="a",Le.CLOSE="b",Le.ERROR="c",Le.MESSAGE="d",be.prototype.listen=be.prototype.J,as=Qe,Oe.prototype.listenOnce=Oe.prototype.K,Oe.prototype.getLastError=Oe.prototype.Ha,Oe.prototype.getLastErrorCode=Oe.prototype.ya,Oe.prototype.getStatus=Oe.prototype.ca,Oe.prototype.getResponseJson=Oe.prototype.La,Oe.prototype.getResponseText=Oe.prototype.la,Oe.prototype.send=Oe.prototype.ea,Oe.prototype.setWithCredentials=Oe.prototype.Fa,Qh=Oe}).apply(typeof Zs<"u"?Zs:typeof self<"u"?self:typeof window<"u"?window:{});const Ml="@firebase/firestore",Ll="4.9.2";class at{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}at.UNAUTHENTICATED=new at(null),at.GOOGLE_CREDENTIALS=new at("google-credentials-uid"),at.FIRST_PARTY=new at("first-party-uid"),at.MOCK_USER=new at("mock-user");let Nr="12.3.0";const tr=new Aa("@firebase/firestore");function hr(){return tr.logLevel}function U(n,...e){if(tr.logLevel<=ce.DEBUG){const t=e.map(Oa);tr.debug(`Firestore (${Nr}): ${n}`,...t)}}function sn(n,...e){if(tr.logLevel<=ce.ERROR){const t=e.map(Oa);tr.error(`Firestore (${Nr}): ${n}`,...t)}}function br(n,...e){if(tr.logLevel<=ce.WARN){const t=e.map(Oa);tr.warn(`Firestore (${Nr}): ${n}`,...t)}}function Oa(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Q(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,ed(n,r,t)}function ed(n,e,t){let r=`FIRESTORE (${Nr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw sn(r),new Error(r)}function ve(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||ed(e,s,r)}function Z(n,e){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class j extends an{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class tn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class td{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Hy{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(at.UNAUTHENTICATED)))}shutdown(){}}class Wy{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Gy{constructor(e){this.t=e,this.currentUser=at.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ve(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let i=new tn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new tn,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const u=i;e.enqueueRetryable((async()=>{await u.promise,await s(this.currentUser)}))},l=u=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new tn)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string",31837,{l:r}),new td(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string",2055,{h:e}),new at(e)}}class Qy{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=at.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Yy{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Qy(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(at.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Fl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Jy{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,It(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ve(this.o===void 0,3512);const r=i=>{i.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,U("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Fl(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ve(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Fl(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Xy(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Ma{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Xy(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function le(n,e){return n<e?-1:n>e?1:0}function ia(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return Fo(s)===Fo(i)?le(s,i):Fo(s)?1:-1}return le(n.length,e.length)}const Zy=55296,e1=57343;function Fo(n){const e=n.charCodeAt(0);return e>=Zy&&e<=e1}function Rr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const Ul="__name__";class Lt{constructor(e,t,r){t===void 0?t=0:t>e.length&&Q(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Q(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Lt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Lt?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=Lt.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return le(e.length,t.length)}static compareSegments(e,t){const r=Lt.isNumericId(e),s=Lt.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Lt.extractNumericId(e).compare(Lt.extractNumericId(t)):ia(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pn.fromString(e.substring(4,e.length-2))}}class Ce extends Lt{construct(e,t,r){return new Ce(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new j(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new Ce(t)}static emptyPath(){return new Ce([])}}const t1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends Lt{construct(e,t,r){return new st(e,t,r)}static isValidIdentifier(e){return t1.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ul}static keyField(){return new st([Ul])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new j(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new j(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new j(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new j(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new st(t)}static emptyPath(){return new st([])}}class W{constructor(e){this.path=e}static fromPath(e){return new W(Ce.fromString(e))}static fromName(e){return new W(Ce.fromString(e).popFirst(5))}static empty(){return new W(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new W(new Ce(e.slice()))}}function nd(n,e,t){if(!t)throw new j(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function n1(n,e,t,r){if(e===!0&&r===!0)throw new j(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Bl(n){if(!W.isDocumentKey(n))throw new j(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function jl(n){if(W.isDocumentKey(n))throw new j(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function rd(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function La(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Q(12329,{type:typeof n})}function Kt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new j(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=La(n);throw new j(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function qe(n,e){const t={typeString:n};return e&&(t.value=e),t}function xs(n,e){if(!rd(n))throw new j(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new j(N.INVALID_ARGUMENT,t);return!0}const zl=-62135596800,ql=1e6;class Pe{static now(){return Pe.fromMillis(Date.now())}static fromDate(e){return Pe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ql);return new Pe(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new j(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new j(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<zl)throw new j(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ql}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xs(e,Pe._jsonSchema))return new Pe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-zl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pe._jsonSchemaVersion="firestore/timestamp/1.0",Pe._jsonSchema={type:qe("string",Pe._jsonSchemaVersion),seconds:qe("number"),nanoseconds:qe("number")};class X{static fromTimestamp(e){return new X(e)}static min(){return new X(new Pe(0,0))}static max(){return new X(new Pe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ts=-1;function r1(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=X.fromTimestamp(r===1e9?new Pe(t+1,0):new Pe(t,r));return new Vn(s,W.empty(),e)}function s1(n){return new Vn(n.readTime,n.key,Ts)}class Vn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Vn(X.min(),W.empty(),Ts)}static max(){return new Vn(X.max(),W.empty(),Ts)}}function i1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=W.comparator(n.documentKey,e.documentKey),t!==0?t:le(n.largestBatchId,e.largestBatchId))}const o1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class a1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function xr(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==o1)throw n;U("LocalStore","Unexpectedly lost primary lease")}class D{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Q(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new D(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof D?t:D.resolve(t)}catch(t){return D.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):D.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):D.reject(t)}static resolve(e){return new D(((t,r)=>{t(e)}))}static reject(e){return new D(((t,r)=>{r(e)}))}static waitFor(e){return new D(((t,r)=>{let s=0,i=0,a=!1;e.forEach((l=>{++s,l.next((()=>{++i,a&&i===s&&t()}),(u=>r(u)))})),a=!0,i===s&&t()}))}static or(e){let t=D.resolve(!1);for(const r of e)t=t.next((s=>s?D.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new D(((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;t(e[d]).next((f=>{a[d]=f,++l,l===i&&r(a)}),(f=>s(f)))}}))}static doWhile(e,t){return new D(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function c1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Or(n){return n.name==="IndexedDbTransactionError"}class Ki{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ki.ce=-1;const Fa=-1;function Hi(n){return n==null}function Ai(n){return n===0&&1/n==-1/0}function l1(n){return typeof n=="number"&&Number.isInteger(n)&&!Ai(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const sd="";function u1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=$l(e)),e=h1(n.get(t),e);return $l(e)}function h1(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case sd:t+="";break;default:t+=i}}return t}function $l(n){return n+sd+""}function Kl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Fn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function id(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class xe{constructor(e,t){this.comparator=e,this.root=t||rt.EMPTY}insert(e,t){return new xe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rt.BLACK,null,null))}remove(e){return new xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ei(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ei(this.root,e,this.comparator,!1)}getReverseIterator(){return new ei(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ei(this.root,e,this.comparator,!0)}}class ei{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??rt.RED,this.left=s??rt.EMPTY,this.right=i??rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new rt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return rt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Q(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Q(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Q(27949);return e+(this.isRed()?0:1)}}rt.EMPTY=null,rt.RED=!0,rt.BLACK=!1;rt.EMPTY=new class{constructor(){this.size=0}get key(){throw Q(57766)}get value(){throw Q(16141)}get color(){throw Q(16727)}get left(){throw Q(29726)}get right(){throw Q(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new rt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ge{constructor(e){this.comparator=e,this.data=new xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hl(this.data.getIterator())}getIteratorFrom(e){return new Hl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ge)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ge(this.comparator);return t.data=e,t}}class Hl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class wt{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new wt([])}unionWith(e){let t=new Ge(st.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new wt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Rr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class od extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class it{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new od("Invalid base64 string: "+i):i}})(e);return new it(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new it(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}it.EMPTY_BYTE_STRING=new it("");const d1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dn(n){if(ve(!!n,39018),typeof n=="string"){let e=0;const t=d1.exec(n);if(ve(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ue(n.seconds),nanos:Ue(n.nanos)}}function Ue(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Nn(n){return typeof n=="string"?it.fromBase64String(n):it.fromUint8Array(n)}const ad="server_timestamp",cd="__type__",ld="__previous_value__",ud="__local_write_time__";function Ua(n){return(n?.mapValue?.fields||{})[cd]?.stringValue===ad}function Wi(n){const e=n.mapValue.fields[ld];return Ua(e)?Wi(e):e}function Is(n){const e=Dn(n.mapValue.fields[ud].timestampValue);return new Pe(e.seconds,e.nanos)}class f1{constructor(e,t,r,s,i,a,l,u,d,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f}}const bi="(default)";class As{constructor(e,t){this.projectId=e,this.database=t||bi}static empty(){return new As("","")}get isDefaultDatabase(){return this.database===bi}isEqual(e){return e instanceof As&&e.projectId===this.projectId&&e.database===this.database}}const hd="__type__",p1="__max__",ti={mapValue:{}},dd="__vector__",Ri="value";function xn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ua(n)?4:g1(n)?9007199254740991:m1(n)?10:11:Q(28295,{value:n})}function Ht(n,e){if(n===e)return!0;const t=xn(n);if(t!==xn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Is(n).isEqual(Is(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Dn(s.timestampValue),l=Dn(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return Nn(s.bytesValue).isEqual(Nn(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return Ue(s.geoPointValue.latitude)===Ue(i.geoPointValue.latitude)&&Ue(s.geoPointValue.longitude)===Ue(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return Ue(s.integerValue)===Ue(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Ue(s.doubleValue),l=Ue(i.doubleValue);return a===l?Ai(a)===Ai(l):isNaN(a)&&isNaN(l)}return!1})(n,e);case 9:return Rr(n.arrayValue.values||[],e.arrayValue.values||[],Ht);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Kl(a)!==Kl(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Ht(a[u],l[u])))return!1;return!0})(n,e);default:return Q(52216,{left:n})}}function bs(n,e){return(n.values||[]).find((t=>Ht(t,e)))!==void 0}function Sr(n,e){if(n===e)return 0;const t=xn(n),r=xn(e);if(t!==r)return le(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return le(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const l=Ue(i.integerValue||i.doubleValue),u=Ue(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return Wl(n.timestampValue,e.timestampValue);case 4:return Wl(Is(n),Is(e));case 5:return ia(n.stringValue,e.stringValue);case 6:return(function(i,a){const l=Nn(i),u=Nn(a);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const l=i.split("/"),u=a.split("/");for(let d=0;d<l.length&&d<u.length;d++){const f=le(l[d],u[d]);if(f!==0)return f}return le(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const l=le(Ue(i.latitude),Ue(a.latitude));return l!==0?l:le(Ue(i.longitude),Ue(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Gl(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const l=i.fields||{},u=a.fields||{},d=l[Ri]?.arrayValue,f=u[Ri]?.arrayValue,v=le(d?.values?.length||0,f?.values?.length||0);return v!==0?v:Gl(d,f)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===ti.mapValue&&a===ti.mapValue)return 0;if(i===ti.mapValue)return 1;if(a===ti.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=a.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let v=0;v<u.length&&v<f.length;++v){const T=ia(u[v],f[v]);if(T!==0)return T;const R=Sr(l[u[v]],d[f[v]]);if(R!==0)return R}return le(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Q(23264,{he:t})}}function Wl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return le(n,e);const t=Dn(n),r=Dn(e),s=le(t.seconds,r.seconds);return s!==0?s:le(t.nanos,r.nanos)}function Gl(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Sr(t[s],r[s]);if(i)return i}return le(t.length,r.length)}function Cr(n){return oa(n)}function oa(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Dn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Nn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return W.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=oa(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${oa(t.fields[a])}`;return s+"}"})(n.mapValue):Q(61005,{value:n})}function li(n){switch(xn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Wi(n);return e?16+li(e):16;case 5:return 2*n.stringValue.length;case 6:return Nn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+li(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return Fn(r.fields,((i,a)=>{s+=i.length+li(a)})),s})(n.mapValue);default:throw Q(13486,{value:n})}}function aa(n){return!!n&&"integerValue"in n}function Ba(n){return!!n&&"arrayValue"in n}function Ql(n){return!!n&&"nullValue"in n}function Yl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ui(n){return!!n&&"mapValue"in n}function m1(n){return(n?.mapValue?.fields||{})[hd]?.stringValue===dd}function ps(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Fn(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ps(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ps(n.arrayValue.values[t]);return e}return{...n}}function g1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===p1}class pt{constructor(e){this.value=e}static empty(){return new pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ui(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ps(t)}setAll(e){let t=st.emptyPath(),r={},s=[];e.forEach(((a,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,r,s),r={},s=[],t=l.popLast()}a?r[l.lastSegment()]=ps(a):s.push(l.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ui(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ht(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ui(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Fn(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new pt(ps(this.value))}}function fd(n){const e=[];return Fn(n.fields,((t,r)=>{const s=new st([t]);if(ui(r)){const i=fd(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new wt(e)}class ct{constructor(e,t,r,s,i,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new ct(e,0,X.min(),X.min(),X.min(),pt.empty(),0)}static newFoundDocument(e,t,r,s){return new ct(e,1,t,X.min(),r,s,0)}static newNoDocument(e,t){return new ct(e,2,t,X.min(),X.min(),pt.empty(),0)}static newUnknownDocument(e,t){return new ct(e,3,t,X.min(),X.min(),pt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ct&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ct(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Si{constructor(e,t){this.position=e,this.inclusive=t}}function Jl(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=W.comparator(W.fromName(a.referenceValue),t.key):r=Sr(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Xl(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ht(n.position[t],e.position[t]))return!1;return!0}class Ci{constructor(e,t="asc"){this.field=e,this.dir=t}}function _1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class pd{}class We extends pd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new v1(e,t,r):t==="array-contains"?new T1(e,r):t==="in"?new I1(e,r):t==="not-in"?new A1(e,r):t==="array-contains-any"?new b1(e,r):new We(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new E1(e,r):new w1(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Sr(t,this.value)):t!==null&&xn(this.value)===xn(t)&&this.matchesComparison(Sr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wt extends pd{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Wt(e,t)}matches(e){return md(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function md(n){return n.op==="and"}function gd(n){return y1(n)&&md(n)}function y1(n){for(const e of n.filters)if(e instanceof Wt)return!1;return!0}function ca(n){if(n instanceof We)return n.field.canonicalString()+n.op.toString()+Cr(n.value);if(gd(n))return n.filters.map((e=>ca(e))).join(",");{const e=n.filters.map((t=>ca(t))).join(",");return`${n.op}(${e})`}}function _d(n,e){return n instanceof We?(function(r,s){return s instanceof We&&r.op===s.op&&r.field.isEqual(s.field)&&Ht(r.value,s.value)})(n,e):n instanceof Wt?(function(r,s){return s instanceof Wt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,l)=>i&&_d(a,s.filters[l])),!0):!1})(n,e):void Q(19439)}function yd(n){return n instanceof We?(function(t){return`${t.field.canonicalString()} ${t.op} ${Cr(t.value)}`})(n):n instanceof Wt?(function(t){return t.op.toString()+" {"+t.getFilters().map(yd).join(" ,")+"}"})(n):"Filter"}class v1 extends We{constructor(e,t,r){super(e,t,r),this.key=W.fromName(r.referenceValue)}matches(e){const t=W.comparator(e.key,this.key);return this.matchesComparison(t)}}class E1 extends We{constructor(e,t){super(e,"in",t),this.keys=vd("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class w1 extends We{constructor(e,t){super(e,"not-in",t),this.keys=vd("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function vd(n,e){return(e.arrayValue?.values||[]).map((t=>W.fromName(t.referenceValue)))}class T1 extends We{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ba(t)&&bs(t.arrayValue,this.value)}}class I1 extends We{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&bs(this.value.arrayValue,t)}}class A1 extends We{constructor(e,t){super(e,"not-in",t)}matches(e){if(bs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!bs(this.value.arrayValue,t)}}class b1 extends We{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ba(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>bs(this.value.arrayValue,r)))}}class R1{constructor(e,t=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.Te=null}}function Zl(n,e=null,t=[],r=[],s=null,i=null,a=null){return new R1(n,e,t,r,s,i,a)}function ja(n){const e=Z(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>ca(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),Hi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Cr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Cr(r))).join(",")),e.Te=t}return e.Te}function za(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!_1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_d(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Xl(n.startAt,e.startAt)&&Xl(n.endAt,e.endAt)}function la(n){return W.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Gi{constructor(e,t=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function S1(n,e,t,r,s,i,a,l){return new Gi(n,e,t,r,s,i,a,l)}function qa(n){return new Gi(n)}function eu(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function C1(n){return n.collectionGroup!==null}function ms(n){const e=Z(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Ge(st.comparator);return a.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(l=l.add(d.field))}))})),l})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ci(i,r))})),t.has(st.keyField().canonicalString())||e.Ie.push(new Ci(st.keyField(),r))}return e.Ie}function jt(n){const e=Z(n);return e.Ee||(e.Ee=P1(e,ms(n))),e.Ee}function P1(n,e){if(n.limitType==="F")return Zl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Ci(s.field,i)}));const t=n.endAt?new Si(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Si(n.startAt.position,n.startAt.inclusive):null;return Zl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ua(n,e,t){return new Gi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qi(n,e){return za(jt(n),jt(e))&&n.limitType===e.limitType}function Ed(n){return`${ja(jt(n))}|lt:${n.limitType}`}function dr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>yd(s))).join(", ")}]`),Hi(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Cr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Cr(s))).join(",")),`Target(${r})`})(jt(n))}; limitType=${n.limitType})`}function Yi(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):W.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of ms(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,l,u){const d=Jl(a,l,u);return a.inclusive?d<=0:d<0})(r.startAt,ms(r),s)||r.endAt&&!(function(a,l,u){const d=Jl(a,l,u);return a.inclusive?d>=0:d>0})(r.endAt,ms(r),s))})(n,e)}function k1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wd(n){return(e,t)=>{let r=!1;for(const s of ms(n)){const i=V1(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function V1(n,e,t){const r=n.field.isKeyField()?W.comparator(e.key,t.key):(function(i,a,l){const u=a.data.field(i),d=l.data.field(i);return u!==null&&d!==null?Sr(u,d):Q(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Q(19790,{direction:n.dir})}}class sr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Fn(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return id(this.inner)}size(){return this.innerSize}}const D1=new xe(W.comparator);function on(){return D1}const Td=new xe(W.comparator);function cs(...n){let e=Td;for(const t of n)e=e.insert(t.key,t);return e}function Id(n){let e=Td;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Wn(){return gs()}function Ad(){return gs()}function gs(){return new sr((n=>n.toString()),((n,e)=>n.isEqual(e)))}const N1=new xe(W.comparator),x1=new Ge(W.comparator);function ue(...n){let e=x1;for(const t of n)e=e.add(t);return e}const O1=new Ge(le);function M1(){return O1}function $a(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ai(e)?"-0":e}}function bd(n){return{integerValue:""+n}}function L1(n,e){return l1(e)?bd(e):$a(n,e)}class Ji{constructor(){this._=void 0}}function F1(n,e,t){return n instanceof Pi?(function(s,i){const a={fields:{[cd]:{stringValue:ad},[ud]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Ua(i)&&(i=Wi(i)),i&&(a.fields[ld]=i),{mapValue:a}})(t,e):n instanceof Rs?Sd(n,e):n instanceof Ss?Cd(n,e):(function(s,i){const a=Rd(s,i),l=tu(a)+tu(s.Ae);return aa(a)&&aa(s.Ae)?bd(l):$a(s.serializer,l)})(n,e)}function U1(n,e,t){return n instanceof Rs?Sd(n,e):n instanceof Ss?Cd(n,e):t}function Rd(n,e){return n instanceof ki?(function(r){return aa(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Pi extends Ji{}class Rs extends Ji{constructor(e){super(),this.elements=e}}function Sd(n,e){const t=Pd(e);for(const r of n.elements)t.some((s=>Ht(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Ss extends Ji{constructor(e){super(),this.elements=e}}function Cd(n,e){let t=Pd(e);for(const r of n.elements)t=t.filter((s=>!Ht(s,r)));return{arrayValue:{values:t}}}class ki extends Ji{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function tu(n){return Ue(n.integerValue||n.doubleValue)}function Pd(n){return Ba(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function B1(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Rs&&s instanceof Rs||r instanceof Ss&&s instanceof Ss?Rr(r.elements,s.elements,Ht):r instanceof ki&&s instanceof ki?Ht(r.Ae,s.Ae):r instanceof Pi&&s instanceof Pi})(n.transform,e.transform)}class j1{constructor(e,t){this.version=e,this.transformResults=t}}class kt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kt}static exists(e){return new kt(void 0,e)}static updateTime(e){return new kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Xi{}function kd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ka(n.key,kt.none()):new Os(n.key,n.data,kt.none());{const t=n.data,r=pt.empty();let s=new Ge(st.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Un(n.key,r,new wt(s.toArray()),kt.none())}}function z1(n,e,t){n instanceof Os?(function(s,i,a){const l=s.value.clone(),u=ru(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Un?(function(s,i,a){if(!hi(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=ru(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(Vd(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function _s(n,e,t,r){return n instanceof Os?(function(i,a,l,u){if(!hi(i.precondition,a))return l;const d=i.value.clone(),f=su(i.fieldTransforms,u,a);return d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Un?(function(i,a,l,u){if(!hi(i.precondition,a))return l;const d=su(i.fieldTransforms,u,a),f=a.data;return f.setAll(Vd(i)),f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((v=>v.field)))})(n,e,t,r):(function(i,a,l){return hi(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l})(n,e,t)}function q1(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Rd(r.transform,s||null);i!=null&&(t===null&&(t=pt.empty()),t.set(r.field,i))}return t||null}function nu(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Rr(r,s,((i,a)=>B1(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Os extends Xi{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Un extends Xi{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Vd(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function ru(n,e,t){const r=new Map;ve(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,U1(a,l,t[s]))}return r}function su(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,F1(i,a,e))}return r}class Ka extends Xi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $1 extends Xi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class K1{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&z1(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=_s(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=_s(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Ad();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=t.has(s.key)?null:l;const u=kd(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(X.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ue())}isEqual(e){return this.batchId===e.batchId&&Rr(this.mutations,e.mutations,((t,r)=>nu(t,r)))&&Rr(this.baseMutations,e.baseMutations,((t,r)=>nu(t,r)))}}class Ha{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ve(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return N1})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Ha(e,t,r,s)}}class H1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class W1{constructor(e,t){this.count=e,this.unchangedNames=t}}var ze,fe;function G1(n){switch(n){case N.OK:return Q(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return Q(15467,{code:n})}}function Dd(n){if(n===void 0)return sn("GRPC error has no .code"),N.UNKNOWN;switch(n){case ze.OK:return N.OK;case ze.CANCELLED:return N.CANCELLED;case ze.UNKNOWN:return N.UNKNOWN;case ze.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case ze.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case ze.INTERNAL:return N.INTERNAL;case ze.UNAVAILABLE:return N.UNAVAILABLE;case ze.UNAUTHENTICATED:return N.UNAUTHENTICATED;case ze.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case ze.NOT_FOUND:return N.NOT_FOUND;case ze.ALREADY_EXISTS:return N.ALREADY_EXISTS;case ze.PERMISSION_DENIED:return N.PERMISSION_DENIED;case ze.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case ze.ABORTED:return N.ABORTED;case ze.OUT_OF_RANGE:return N.OUT_OF_RANGE;case ze.UNIMPLEMENTED:return N.UNIMPLEMENTED;case ze.DATA_LOSS:return N.DATA_LOSS;default:return Q(39323,{code:n})}}(fe=ze||(ze={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";function Q1(){return new TextEncoder}const Y1=new Pn([4294967295,4294967295],0);function iu(n){const e=Q1().encode(n),t=new Gh;return t.update(e),new Uint8Array(t.digest())}function ou(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Pn([t,r],0),new Pn([s,i],0)]}class Wa{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ls(`Invalid padding: ${t}`);if(r<0)throw new ls(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ls(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ls(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Pn.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(Pn.fromNumber(r)));return s.compare(Y1)===1&&(s=new Pn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=iu(e),[r,s]=ou(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Wa(i,s,t);return r.forEach((l=>a.insert(l))),a}insert(e){if(this.ge===0)return;const t=iu(e),[r,s]=ou(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ls extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Zi{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ms.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Zi(X.min(),s,new xe(le),on(),ue())}}class Ms{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ms(r,t,ue(),ue(),ue())}}class di{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Nd{constructor(e,t){this.targetId=e,this.Ce=t}}class xd{constructor(e,t,r=it.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class au{constructor(){this.ve=0,this.Fe=cu(),this.Me=it.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ue(),t=ue(),r=ue();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Q(38017,{changeType:i})}})),new Ms(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=cu()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ve(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class J1{constructor(e){this.Ge=e,this.ze=new Map,this.je=on(),this.Je=ni(),this.He=ni(),this.Ye=new xe(le)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Q(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(la(i))if(r===0){const a=new W(i.path);this.et(t,a,ct.newNoDocument(a,X.min()))}else ve(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const l=this.ut(e),u=l?this.ct(l,e,a):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,l;try{a=Nn(r).toUint8Array()}catch(u){if(u instanceof od)return br("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Wa(a,s,i)}catch(u){return br(u instanceof ls?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const l=this.ot(a);if(l){if(i.current&&la(l.target)){const u=new W(l.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,ct.newNoDocument(u,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=ue();this.He.forEach(((i,a)=>{let l=!0;a.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new Zi(e,t,this.Ye,this.je,r);return this.je=on(),this.Je=ni(),this.He=ni(),this.Ye=new xe(le),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new au,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ge(le),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ge(le),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new au),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ni(){return new xe(W.comparator)}function cu(){return new xe(W.comparator)}const X1={asc:"ASCENDING",desc:"DESCENDING"},Z1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ev={and:"AND",or:"OR"};class tv{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ha(n,e){return n.useProto3Json||Hi(e)?e:{value:e}}function Vi(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Od(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function nv(n,e){return Vi(n,e.toTimestamp())}function zt(n){return ve(!!n,49232),X.fromTimestamp((function(t){const r=Dn(t);return new Pe(r.seconds,r.nanos)})(n))}function Ga(n,e){return da(n,e).canonicalString()}function da(n,e){const t=(function(s){return new Ce(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Md(n){const e=Ce.fromString(n);return ve(jd(e),10190,{key:e.toString()}),e}function fa(n,e){return Ga(n.databaseId,e.path)}function Uo(n,e){const t=Md(e);if(t.get(1)!==n.databaseId.projectId)throw new j(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new j(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new W(Fd(t))}function Ld(n,e){return Ga(n.databaseId,e)}function rv(n){const e=Md(n);return e.length===4?Ce.emptyPath():Fd(e)}function pa(n){return new Ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Fd(n){return ve(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function lu(n,e,t){return{name:fa(n,e),fields:t.value.mapValue.fields}}function sv(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Q(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(d,f){return d.useProto3Json?(ve(f===void 0||typeof f=="string",58123),it.fromBase64String(f||"")):(ve(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),it.fromUint8Array(f||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&(function(d){const f=d.code===void 0?N.UNKNOWN:Dd(d.code);return new j(f,d.message||"")})(a);t=new xd(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Uo(n,r.document.name),i=zt(r.document.updateTime),a=r.document.createTime?zt(r.document.createTime):X.min(),l=new pt({mapValue:{fields:r.document.fields}}),u=ct.newFoundDocument(s,i,a,l),d=r.targetIds||[],f=r.removedTargetIds||[];t=new di(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Uo(n,r.document),i=r.readTime?zt(r.readTime):X.min(),a=ct.newNoDocument(s,i),l=r.removedTargetIds||[];t=new di([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Uo(n,r.document),i=r.removedTargetIds||[];t=new di([],i,s,null)}else{if(!("filter"in e))return Q(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new W1(s,i),l=r.targetId;t=new Nd(l,a)}}return t}function iv(n,e){let t;if(e instanceof Os)t={update:lu(n,e.key,e.value)};else if(e instanceof Ka)t={delete:fa(n,e.key)};else if(e instanceof Un)t={update:lu(n,e.key,e.data),updateMask:pv(e.fieldMask)};else{if(!(e instanceof $1))return Q(16599,{Vt:e.type});t={verify:fa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const l=a.transform;if(l instanceof Pi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Rs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ss)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ki)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw Q(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:nv(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Q(27497)})(n,e.precondition)),t}function ov(n,e){return n&&n.length>0?(ve(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?zt(s.updateTime):zt(i);return a.isEqual(X.min())&&(a=zt(i)),new j1(a,s.transformResults||[])})(t,e)))):[]}function av(n,e){return{documents:[Ld(n,e.path)]}}function cv(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Ld(n,s);const i=(function(d){if(d.length!==0)return Bd(Wt.create(d,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(d){if(d.length!==0)return d.map((f=>(function(T){return{field:fr(T.field),direction:hv(T.dir)}})(f)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=ha(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:s}}function lv(n){let e=rv(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ve(r===1,65062);const f=t.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];t.where&&(i=(function(v){const T=Ud(v);return T instanceof Wt&&gd(T)?T.getFilters():[T]})(t.where));let a=[];t.orderBy&&(a=(function(v){return v.map((T=>(function(S){return new Ci(pr(S.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(T)))})(t.orderBy));let l=null;t.limit&&(l=(function(v){let T;return T=typeof v=="object"?v.value:v,Hi(T)?null:T})(t.limit));let u=null;t.startAt&&(u=(function(v){const T=!!v.before,R=v.values||[];return new Si(R,T)})(t.startAt));let d=null;return t.endAt&&(d=(function(v){const T=!v.before,R=v.values||[];return new Si(R,T)})(t.endAt)),S1(e,s,a,i,l,"F",u,d)}function uv(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Q(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Ud(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=pr(t.unaryFilter.field);return We.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=pr(t.unaryFilter.field);return We.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=pr(t.unaryFilter.field);return We.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=pr(t.unaryFilter.field);return We.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Q(61313);default:return Q(60726)}})(n):n.fieldFilter!==void 0?(function(t){return We.create(pr(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Q(58110);default:return Q(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Wt.create(t.compositeFilter.filters.map((r=>Ud(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Q(1026)}})(t.compositeFilter.op))})(n):Q(30097,{filter:n})}function hv(n){return X1[n]}function dv(n){return Z1[n]}function fv(n){return ev[n]}function fr(n){return{fieldPath:n.canonicalString()}}function pr(n){return st.fromServerFormat(n.fieldPath)}function Bd(n){return n instanceof We?(function(t){if(t.op==="=="){if(Yl(t.value))return{unaryFilter:{field:fr(t.field),op:"IS_NAN"}};if(Ql(t.value))return{unaryFilter:{field:fr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Yl(t.value))return{unaryFilter:{field:fr(t.field),op:"IS_NOT_NAN"}};if(Ql(t.value))return{unaryFilter:{field:fr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fr(t.field),op:dv(t.op),value:t.value}}})(n):n instanceof Wt?(function(t){const r=t.getFilters().map((s=>Bd(s)));return r.length===1?r[0]:{compositeFilter:{op:fv(t.op),filters:r}}})(n):Q(54877,{filter:n})}function pv(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function jd(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class bn{constructor(e,t,r,s,i=X.min(),a=X.min(),l=it.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new bn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new bn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class mv{constructor(e){this.yt=e}}function gv(n){const e=lv({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ua(e,e.limit,"L"):e}class _v{constructor(){this.Cn=new yv}addToCollectionParentIndex(e,t){return this.Cn.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(Vn.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(Vn.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}}class yv{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ge(Ce.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ge(Ce.comparator)).toArray()}}const uu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zd=41943040;class ht{static withCacheSize(e){return new ht(e,ht.DEFAULT_COLLECTION_PERCENTILE,ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}ht.DEFAULT_COLLECTION_PERCENTILE=10,ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ht.DEFAULT=new ht(zd,ht.DEFAULT_COLLECTION_PERCENTILE,ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ht.DISABLED=new ht(-1,0,0);class Pr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Pr(0)}static cr(){return new Pr(-1)}}const hu="LruGarbageCollector",vv=1048576;function du([n,e],[t,r]){const s=le(n,t);return s===0?le(e,r):s}class Ev{constructor(e){this.Ir=e,this.buffer=new Ge(du),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();du(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class wv{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){U(hu,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Or(t)?U(hu,"Ignoring IndexedDB error during garbage collection: ",t):await xr(t)}await this.Vr(3e5)}))}}class Tv{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return D.resolve(Ki.ce);const r=new Ev(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),D.resolve(uu)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uu):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,l,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,a=Date.now(),this.nthSequenceNumber(e,s)))).next((v=>(r=v,l=Date.now(),this.removeTargets(e,r,t)))).next((v=>(i=v,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((v=>(d=Date.now(),hr()<=ce.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${s} in `+(l-a)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${v} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),D.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:v}))))}}function Iv(n,e){return new Tv(n,e)}class Av{constructor(){this.changes=new sr((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ct.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class bv{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Rv{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&_s(r.mutation,s,wt.empty(),Pe.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,ue()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=ue()){const s=Wn();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=cs();return i.forEach(((l,u)=>{a=a.insert(l,u.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Wn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,ue())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,l)=>{t.set(a,l)}))}))}computeViews(e,t,r,s){let i=on();const a=gs(),l=(function(){return gs()})();return t.forEach(((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Un)?i=i.insert(d.key,d):f!==void 0?(a.set(d.key,f.mutation.getFieldMask()),_s(f.mutation,d,f.mutation.getFieldMask(),Pe.now())):a.set(d.key,wt.empty())})),this.recalculateAndSaveOverlays(e,i).next((u=>(u.forEach(((d,f)=>a.set(d,f))),t.forEach(((d,f)=>l.set(d,new bv(f,a.get(d)??null)))),l)))}recalculateAndSaveOverlays(e,t){const r=gs();let s=new xe(((a,l)=>a-l)),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const l of a)l.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let f=r.get(u)||wt.empty();f=l.applyToLocalView(d,f),r.set(u,f);const v=(s.get(l.batchId)||ue()).add(u);s=s.insert(l.batchId,v)}))})).next((()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,f=u.value,v=Ad();f.forEach((T=>{if(!i.has(T)){const R=kd(t.get(T),r.get(T));R!==null&&v.set(T,R),i=i.add(T)}})),a.push(this.documentOverlayCache.saveOverlays(e,d,v))}return D.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return W.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):C1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):D.resolve(Wn());let l=Ts,u=i;return a.next((d=>D.forEach(d,((f,v)=>(l<v.largestBatchId&&(l=v.largestBatchId),i.get(f)?D.resolve():this.remoteDocumentCache.getEntry(e,f).next((T=>{u=u.insert(f,T)}))))).next((()=>this.populateOverlays(e,d,i))).next((()=>this.computeViews(e,u,d,ue()))).next((f=>({batchId:l,changes:Id(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new W(t)).next((r=>{let s=cs();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=cs();return this.indexManager.getCollectionParents(e,i).next((l=>D.forEach(l,(u=>{const d=(function(v,T){return new Gi(T,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next((f=>{f.forEach(((v,T)=>{a=a.insert(v,T)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((u,d)=>{const f=d.getKey();a.get(f)===null&&(a=a.insert(f,ct.newInvalidDocument(f)))}));let l=cs();return a.forEach(((u,d)=>{const f=i.get(u);f!==void 0&&_s(f.mutation,d,wt.empty(),Pe.now()),Yi(t,d)&&(l=l.insert(u,d))})),l}))}}class Sv{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return D.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:zt(s.createTime)}})(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:gv(s.bundledQuery),readTime:zt(s.readTime)}})(t)),D.resolve()}}class Cv{constructor(){this.overlays=new xe(W.comparator),this.qr=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Wn();return D.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),D.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){const s=Wn(),i=t.length+1,a=new W(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return D.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new xe(((d,f)=>d-f));const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Wn(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const l=Wn(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,f)=>l.set(d,f))),!(l.size()>=s)););return D.resolve(l)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new H1(t,r));let i=this.qr.get(t);i===void 0&&(i=ue(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class Pv{constructor(){this.sessionToken=it.EMPTY_BYTE_STRING}getSessionToken(e){return D.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,D.resolve()}}class Qa{constructor(){this.Qr=new Ge(Je.$r),this.Ur=new Ge(Je.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Je(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Je(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new W(new Ce([])),r=new Je(t,e),s=new Je(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new W(new Ce([])),r=new Je(t,e),s=new Je(t,e+1);let i=ue();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Je(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Je{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return W.comparator(e.key,t.key)||le(e.Yr,t.Yr)}static Kr(e,t){return le(e.Yr,t.Yr)||W.comparator(e.key,t.key)}}class kv{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ge(Je.$r)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new K1(i,t,r,s);this.mutationQueue.push(a);for(const l of s)this.Zr=this.Zr.add(new Je(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return D.resolve(a)}lookupMutationBatch(e,t){return D.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return D.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?Fa:this.tr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Je(t,0),s=new Je(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const l=this.Xr(a.Yr);i.push(l)})),D.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ge(le);return t.forEach((s=>{const i=new Je(s,0),a=new Je(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(l=>{r=r.add(l.Yr)}))})),D.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;W.isDocumentKey(i)||(i=i.child(""));const a=new Je(new W(i),0);let l=new Ge(le);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.Yr)),!0)}),a),D.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ve(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return D.forEach(t.mutations,(s=>{const i=new Je(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Je(t,0),s=this.Zr.firstAfterOrEqual(r);return D.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Vv{constructor(e){this.ri=e,this.docs=(function(){return new xe(W.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():ct.newInvalidDocument(t))}getEntries(e,t){let r=on();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ct.newInvalidDocument(s))})),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=on();const a=t.path,l=new W(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||i1(s1(f),r)<=0||(s.has(f.key)||Yi(t,f))&&(i=i.insert(f.key,f.mutableCopy()))}return D.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Q(9500)}ii(e,t){return D.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new Dv(this)}getSize(e){return D.resolve(this.size)}}class Dv extends Av{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),D.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Nv{constructor(e){this.persistence=e,this.si=new sr((t=>ja(t)),za),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.oi=0,this._i=new Qa,this.targetCount=0,this.ai=Pr.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),D.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Pr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.Pr(t),D.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)})),D.waitFor(i).next((()=>s))}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),D.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),D.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this._i.containsKey(t))}}class qd{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ki(0),this.li=!1,this.li=!0,this.hi=new Pv,this.referenceDelegate=e(this),this.Pi=new Nv(this),this.indexManager=new _v,this.remoteDocumentCache=(function(s){return new Vv(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new mv(t),this.Ii=new Sv(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Cv,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new kv(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);const s=new xv(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return D.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class xv extends a1{constructor(e){super(),this.currentSequenceNumber=e}}class Ya{constructor(e){this.persistence=e,this.Ri=new Qa,this.Vi=null}static mi(e){return new Ya(e)}get fi(){if(this.Vi)return this.Vi;throw Q(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),D.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.fi,(r=>{const s=W.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,X.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return D.or([()=>D.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Di{constructor(e,t){this.persistence=e,this.pi=new sr((r=>u1(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=Iv(this,t)}static mi(e,t){return new Di(e,t)}Ei(){}di(e){return D.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return D.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?D.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((l=>{l||(r++,i.removeEntry(a,X.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),D.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),D.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),D.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),D.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=li(e.data.value)),t}br(e,t,r){return D.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return D.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ja{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=ue(),s=ue();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ja(e,t.fromCache,r,s)}}class Ov{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Mv{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return hm()?8:c1(lt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new Ov;return this.Ss(e,t,a).next((l=>{if(i.result=l,this.Vs)return this.bs(e,t,a,l.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(hr()<=ce.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",dr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),D.resolve()):(hr()<=ce.DEBUG&&U("QueryEngine","Query:",dr(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(hr()<=ce.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",dr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jt(t))):D.resolve())}ys(e,t){if(eu(t))return D.resolve(null);let r=jt(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=ua(t,null,"F"),r=jt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=ue(...i);return this.ps.getDocuments(e,a).next((l=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,l);return this.Cs(t,d,a,u.readTime)?this.ys(e,ua(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,s){return eu(t)||s.isEqual(X.min())?D.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?D.resolve(null):(hr()<=ce.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),dr(t)),this.vs(e,a,t,r1(s,Ts)).next((l=>l)))}))}Ds(e,t){let r=new Ge(wd(e));return t.forEach(((s,i)=>{Yi(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return hr()<=ce.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",dr(t)),this.ps.getDocumentsMatchingQuery(e,t,Vn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const Xa="LocalStore",Lv=3e8;class Fv{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new xe(le),this.xs=new sr((i=>ja(i)),za),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rv(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Uv(n,e,t,r){return new Fv(n,e,t,r)}async function $d(n,e){const t=Z(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],l=[];let u=ue();for(const d of s){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){l.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:a,addedBatchIds:l})))}))}))}function Bv(n,e){const t=Z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,d,f){const v=d.batch,T=v.keys();let R=D.resolve();return T.forEach((S=>{R=R.next((()=>f.getEntry(u,S))).next((k=>{const P=d.docVersions.get(S);ve(P!==null,48541),k.version.compareTo(P)<0&&(v.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),f.addEntry(k)))}))})),R.next((()=>l.mutationQueue.removeMutationBatch(u,v)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let u=ue();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function Kd(n){const e=Z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function jv(n,e){const t=Z(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const l=[];e.targetChanges.forEach(((f,v)=>{const T=s.get(v);if(!T)return;l.push(t.Pi.removeMatchingKeys(i,f.removedDocuments,v).next((()=>t.Pi.addMatchingKeys(i,f.addedDocuments,v))));let R=T.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(v)!==null?R=R.withResumeToken(it.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):f.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(f.resumeToken,r)),s=s.insert(v,R),(function(k,P,L){return k.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=Lv?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(T,R,f)&&l.push(t.Pi.updateTargetData(i,R))}));let u=on(),d=ue();if(e.documentUpdates.forEach((f=>{e.resolvedLimboDocuments.has(f)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,f))})),l.push(zv(i,a,e.documentUpdates).next((f=>{u=f.ks,d=f.qs}))),!r.isEqual(X.min())){const f=t.Pi.getLastRemoteSnapshotVersion(i).next((v=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));l.push(f)}return D.waitFor(l).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,u,d))).next((()=>u))})).then((i=>(t.Ms=s,i)))}function zv(n,e,t){let r=ue(),s=ue();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=on();return t.forEach(((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(X.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):U(Xa,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)})),{ks:a,qs:s}}))}function qv(n,e){const t=Z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Fa),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function $v(n,e){const t=Z(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,D.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new bn(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function ma(n,e,t){const r=Z(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Or(a))throw a;U(Xa,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function fu(n,e,t){const r=Z(n);let s=X.min(),i=ue();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(u,d,f){const v=Z(u),T=v.xs.get(f);return T!==void 0?D.resolve(v.Ms.get(T)):v.Pi.getTargetData(d,f)})(r,a,jt(e)).next((l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,l.targetId).next((u=>{i=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:X.min(),t?i:ue()))).next((l=>(Kv(r,k1(e),l),{documents:l,Qs:i})))))}function Kv(n,e,t){let r=n.Os.get(e)||X.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class pu{constructor(){this.activeTargetIds=M1()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Hv{constructor(){this.Mo=new pu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new pu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Wv{Oo(e){}shutdown(){}}const mu="ConnectivityMonitor";class gu{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){U(mu,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){U(mu,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ri=null;function ga(){return ri===null?ri=(function(){return 268435456+Math.round(2147483648*Math.random())})():ri++,"0x"+ri.toString(16)}const Bo="RestConnection",Gv={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Qv{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===bi?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=ga(),l=this.zo(e,t.toUriEncodedString());U(Bo,`Sending RPC '${e}' ${a}:`,l,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(l),f=Vr(d);return this.Jo(e,l,u,r,f).then((v=>(U(Bo,`Received RPC '${e}' ${a}: `,v),v)),(v=>{throw br(Bo,`RPC '${e}' ${a} failed with error: `,v,"url: ",l,"request:",r),v}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=Gv[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class Yv{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ot="WebChannelConnection";class Jv extends Qv{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=ga();return new Promise(((l,u)=>{const d=new Qh;d.setWithCredentials(!0),d.listenOnce(Yh.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case ci.NO_ERROR:const v=d.getResponseJson();U(ot,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(v)),l(v);break;case ci.TIMEOUT:U(ot,`RPC '${e}' ${a} timed out`),u(new j(N.DEADLINE_EXCEEDED,"Request time out"));break;case ci.HTTP_ERROR:const T=d.getStatus();if(U(ot,`RPC '${e}' ${a} failed with status:`,T,"response text:",d.getResponseText()),T>0){let R=d.getResponseJson();Array.isArray(R)&&(R=R[0]);const S=R?.error;if(S&&S.status&&S.message){const k=(function(L){const M=L.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(M)>=0?M:N.UNKNOWN})(S.status);u(new j(k,S.message))}else u(new j(N.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new j(N.UNAVAILABLE,"Connection failed."));break;default:Q(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{U(ot,`RPC '${e}' ${a} completed.`)}}));const f=JSON.stringify(s);U(ot,`RPC '${e}' ${a} sending request:`,s),d.send(t,"POST",f,r,15)}))}T_(e,t,r){const s=ga(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Zh(),l=Xh(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const f=i.join("");U(ot,`Creating RPC '${e}' stream ${s}: ${f}`,u);const v=a.createWebChannel(f,u);this.I_(v);let T=!1,R=!1;const S=new Yv({Yo:P=>{R?U(ot,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(T||(U(ot,`Opening RPC '${e}' stream ${s} transport.`),v.open(),T=!0),U(ot,`RPC '${e}' stream ${s} sending:`,P),v.send(P))},Zo:()=>v.close()}),k=(P,L,M)=>{P.listen(L,(z=>{try{M(z)}catch(ne){setTimeout((()=>{throw ne}),0)}}))};return k(v,as.EventType.OPEN,(()=>{R||(U(ot,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),k(v,as.EventType.CLOSE,(()=>{R||(R=!0,U(ot,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(v))})),k(v,as.EventType.ERROR,(P=>{R||(R=!0,br(ot,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),S.a_(new j(N.UNAVAILABLE,"The operation could not be completed")))})),k(v,as.EventType.MESSAGE,(P=>{if(!R){const L=P.data[0];ve(!!L,16349);const M=L,z=M?.error||M[0]?.error;if(z){U(ot,`RPC '${e}' stream ${s} received error:`,z);const ne=z.status;let Y=(function(g){const m=ze[g];if(m!==void 0)return Dd(m)})(ne),F=z.message;Y===void 0&&(Y=N.INTERNAL,F="Unknown error status: "+ne+" with message "+z.message),R=!0,S.a_(new j(Y,F)),v.close()}else U(ot,`RPC '${e}' stream ${s} received:`,L),S.u_(L)}})),k(l,Jh.STAT_EVENT,(P=>{P.stat===sa.PROXY?U(ot,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===sa.NOPROXY&&U(ot,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function jo(){return typeof document<"u"?document:null}function eo(n){return new tv(n,!0)}class Hd{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&U("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const _u="PersistentStream";class Wd{constructor(e,t,r,s,i,a,l,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Hd(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(sn(t.toString()),sn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new j(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return U(_u,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(U(_u,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Xv extends Wd{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=sv(this.serializer,e),r=(function(i){if(!("targetChange"in i))return X.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?X.min():a.readTime?zt(a.readTime):X.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=pa(this.serializer),t.addTarget=(function(i,a){let l;const u=a.target;if(l=la(u)?{documents:av(i,u)}:{query:cv(i,u).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Od(i,a.resumeToken);const d=ha(i,a.expectedCount);d!==null&&(l.expectedCount=d)}else if(a.snapshotVersion.compareTo(X.min())>0){l.readTime=Vi(i,a.snapshotVersion.toTimestamp());const d=ha(i,a.expectedCount);d!==null&&(l.expectedCount=d)}return l})(this.serializer,e);const r=uv(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=pa(this.serializer),t.removeTarget=e,this.q_(t)}}class Zv extends Wd{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ve(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ve(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ve(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=ov(e.writeResults,e.commitTime),r=zt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=pa(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>iv(this.serializer,r)))};this.q_(t)}}class e0{}class t0 extends e0{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new j(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,da(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new j(N.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Ho(e,da(t,r),s,a,l,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new j(N.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class n0{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(sn(t),this.aa=!1):U("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const nr="RemoteStore";class r0{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{ir(this)&&(U(nr,"Restarting streams for network reachability change."),await(async function(u){const d=Z(u);d.Ea.add(4),await Ls(d),d.Ra.set("Unknown"),d.Ea.delete(4),await to(d)})(this))}))})),this.Ra=new n0(r,s)}}async function to(n){if(ir(n))for(const e of n.da)await e(!0)}async function Ls(n){for(const e of n.da)await e(!1)}function Gd(n,e){const t=Z(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),nc(t)?tc(t):Mr(t).O_()&&ec(t,e))}function Za(n,e){const t=Z(n),r=Mr(t);t.Ia.delete(e),r.O_()&&Qd(t,e),t.Ia.size===0&&(r.O_()?r.L_():ir(t)&&t.Ra.set("Unknown"))}function ec(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Mr(n).Y_(e)}function Qd(n,e){n.Va.Ue(e),Mr(n).Z_(e)}function tc(n){n.Va=new J1({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Mr(n).start(),n.Ra.ua()}function nc(n){return ir(n)&&!Mr(n).x_()&&n.Ia.size>0}function ir(n){return Z(n).Ea.size===0}function Yd(n){n.Va=void 0}async function s0(n){n.Ra.set("Online")}async function i0(n){n.Ia.forEach(((e,t)=>{ec(n,e)}))}async function o0(n,e){Yd(n),nc(n)?(n.Ra.ha(e),tc(n)):n.Ra.set("Unknown")}async function a0(n,e,t){if(n.Ra.set("Online"),e instanceof xd&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.Ia.delete(l),s.Va.removeTarget(l))})(n,e)}catch(r){U(nr,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ni(n,r)}else if(e instanceof di?n.Va.Ze(e):e instanceof Nd?n.Va.st(e):n.Va.tt(e),!t.isEqual(X.min()))try{const r=await Kd(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const l=i.Va.Tt(a);return l.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ia.get(d);f&&i.Ia.set(d,f.withResumeToken(u.resumeToken,a))}})),l.targetMismatches.forEach(((u,d)=>{const f=i.Ia.get(u);if(!f)return;i.Ia.set(u,f.withResumeToken(it.EMPTY_BYTE_STRING,f.snapshotVersion)),Qd(i,u);const v=new bn(f.target,u,d,f.sequenceNumber);ec(i,v)})),i.remoteSyncer.applyRemoteEvent(l)})(n,t)}catch(r){U(nr,"Failed to raise snapshot:",r),await Ni(n,r)}}async function Ni(n,e,t){if(!Or(e))throw e;n.Ea.add(1),await Ls(n),n.Ra.set("Offline"),t||(t=()=>Kd(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{U(nr,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await to(n)}))}function Jd(n,e){return e().catch((t=>Ni(n,t,e)))}async function no(n){const e=Z(n),t=On(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fa;for(;c0(e);)try{const s=await qv(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,l0(e,s)}catch(s){await Ni(e,s)}Xd(e)&&Zd(e)}function c0(n){return ir(n)&&n.Ta.length<10}function l0(n,e){n.Ta.push(e);const t=On(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Xd(n){return ir(n)&&!On(n).x_()&&n.Ta.length>0}function Zd(n){On(n).start()}async function u0(n){On(n).ra()}async function h0(n){const e=On(n);for(const t of n.Ta)e.ea(t.mutations)}async function d0(n,e,t){const r=n.Ta.shift(),s=Ha.from(r,e,t);await Jd(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await no(n)}async function f0(n,e){e&&On(n).X_&&await(async function(r,s){if((function(a){return G1(a)&&a!==N.ABORTED})(s.code)){const i=r.Ta.shift();On(r).B_(),await Jd(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await no(r)}})(n,e),Xd(n)&&Zd(n)}async function yu(n,e){const t=Z(n);t.asyncQueue.verifyOperationInProgress(),U(nr,"RemoteStore received new credentials");const r=ir(t);t.Ea.add(3),await Ls(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await to(t)}async function p0(n,e){const t=Z(n);e?(t.Ea.delete(2),await to(t)):e||(t.Ea.add(2),await Ls(t),t.Ra.set("Unknown"))}function Mr(n){return n.ma||(n.ma=(function(t,r,s){const i=Z(t);return i.sa(),new Xv(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:s0.bind(null,n),t_:i0.bind(null,n),r_:o0.bind(null,n),H_:a0.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),nc(n)?tc(n):n.Ra.set("Unknown")):(await n.ma.stop(),Yd(n))}))),n.ma}function On(n){return n.fa||(n.fa=(function(t,r,s){const i=Z(t);return i.sa(),new Zv(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:u0.bind(null,n),r_:f0.bind(null,n),ta:h0.bind(null,n),na:d0.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await no(n)):(await n.fa.stop(),n.Ta.length>0&&(U(nr,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class rc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new tn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,l=new rc(e,t,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sc(n,e){if(sn("AsyncQueue",`${e}: ${n}`),Or(n))return new j(N.UNAVAILABLE,`${e}: ${n}`);throw n}class Tr{static emptySet(e){return new Tr(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||W.comparator(t.key,r.key):(t,r)=>W.comparator(t.key,r.key),this.keyedMap=cs(),this.sortedSet=new xe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Tr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Tr;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class vu{constructor(){this.ga=new xe(W.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Q(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class kr{constructor(e,t,r,s,i,a,l,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((l=>{a.push({type:0,doc:l})})),new kr(e,t,Tr.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class m0{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class g0{constructor(){this.queries=Eu(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=Z(t),i=s.queries;s.queries=Eu(),i.forEach(((a,l)=>{for(const u of l.Sa)u.onError(r)}))})(this,new j(N.ABORTED,"Firestore shutting down"))}}function Eu(){return new sr((n=>Ed(n)),Qi)}async function ef(n,e){const t=Z(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new m0,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const l=sc(a,`Initialization of query '${dr(e.query)}' failed`);return void e.onError(l)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&ic(t)}async function tf(n,e){const t=Z(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function _0(n,e){const t=Z(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const l of a.Sa)l.Fa(s)&&(r=!0);a.wa=s}}r&&ic(t)}function y0(n,e,t){const r=Z(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function ic(n){n.Ca.forEach((e=>{e.next()}))}var _a,wu;(wu=_a||(_a={})).Ma="default",wu.Cache="cache";class nf{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new kr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=kr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_a.Cache}}class rf{constructor(e){this.key=e}}class sf{constructor(e){this.key=e}}class v0{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ue(),this.mutatedKeys=ue(),this.eu=wd(e),this.tu=new Tr(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new vu,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((f,v)=>{const T=s.get(f),R=Yi(this.query,v)?v:null,S=!!T&&this.mutatedKeys.has(T.key),k=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let P=!1;T&&R?T.data.isEqual(R.data)?S!==k&&(r.track({type:3,doc:R}),P=!0):this.su(T,R)||(r.track({type:2,doc:R}),P=!0,(u&&this.eu(R,u)>0||d&&this.eu(R,d)<0)&&(l=!0)):!T&&R?(r.track({type:0,doc:R}),P=!0):T&&!R&&(r.track({type:1,doc:T}),P=!0,(u||d)&&(l=!0)),P&&(R?(a=a.add(R),i=k?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:a,iu:r,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((f,v)=>(function(R,S){const k=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q(20277,{Rt:P})}};return k(R)-k(S)})(f.type,v.type)||this.eu(f.doc,v.doc))),this.ou(r),s=s??!1;const l=t&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,a.length!==0||d?{snapshot:new kr(this.query,e.tu,i,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vu,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ue(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new sf(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new rf(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=ue();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return kr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const oc="SyncEngine";class E0{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class w0{constructor(e){this.key=e,this.hu=!1}}class T0{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new sr((l=>Ed(l)),Qi),this.Iu=new Map,this.Eu=new Set,this.du=new xe(W.comparator),this.Au=new Map,this.Ru=new Qa,this.Vu={},this.mu=new Map,this.fu=Pr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function I0(n,e,t=!0){const r=hf(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await of(r,e,t,!0),s}async function A0(n,e){const t=hf(n);await of(t,e,!0,!1)}async function of(n,e,t,r){const s=await $v(n.localStore,jt(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let l;return r&&(l=await b0(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&Gd(n.remoteStore,s),l}async function b0(n,e,t,r,s){n.pu=(v,T,R)=>(async function(k,P,L,M){let z=P.view.ru(L);z.Cs&&(z=await fu(k.localStore,P.query,!1).then((({documents:E})=>P.view.ru(E,z))));const ne=M&&M.targetChanges.get(P.targetId),Y=M&&M.targetMismatches.get(P.targetId)!=null,F=P.view.applyChanges(z,k.isPrimaryClient,ne,Y);return Iu(k,P.targetId,F.au),F.snapshot})(n,v,T,R);const i=await fu(n.localStore,e,!0),a=new v0(e,i.Qs),l=a.ru(i.documents),u=Ms.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),d=a.applyChanges(l,n.isPrimaryClient,u);Iu(n,t,d.au);const f=new E0(e,t,a);return n.Tu.set(e,f),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function R0(n,e,t){const r=Z(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!Qi(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ma(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Za(r.remoteStore,s.targetId),ya(r,s.targetId)})).catch(xr)):(ya(r,s.targetId),await ma(r.localStore,s.targetId,!0))}async function S0(n,e){const t=Z(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Za(t.remoteStore,r.targetId))}async function C0(n,e,t){const r=O0(n);try{const s=await(function(a,l){const u=Z(a),d=Pe.now(),f=l.reduce(((R,S)=>R.add(S.key)),ue());let v,T;return u.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let S=on(),k=ue();return u.Ns.getEntries(R,f).next((P=>{S=P,S.forEach(((L,M)=>{M.isValidDocument()||(k=k.add(L))}))})).next((()=>u.localDocuments.getOverlayedDocuments(R,S))).next((P=>{v=P;const L=[];for(const M of l){const z=q1(M,v.get(M.key).overlayedDocument);z!=null&&L.push(new Un(M.key,z,fd(z.value.mapValue),kt.exists(!0)))}return u.mutationQueue.addMutationBatch(R,d,L,l)})).next((P=>{T=P;const L=P.applyToLocalDocumentSet(v,k);return u.documentOverlayCache.saveOverlays(R,P.batchId,L)}))})).then((()=>({batchId:T.batchId,changes:Id(v)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,l,u){let d=a.Vu[a.currentUser.toKey()];d||(d=new xe(le)),d=d.insert(l,u),a.Vu[a.currentUser.toKey()]=d})(r,s.batchId,t),await Fs(r,s.changes),await no(r.remoteStore)}catch(s){const i=sc(s,"Failed to persist write");t.reject(i)}}async function af(n,e){const t=Z(n);try{const r=await jv(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?ve(a.hu,14607):s.removedDocuments.size>0&&(ve(a.hu,42227),a.hu=!1))})),await Fs(t,r,e)}catch(r){await xr(r)}}function Tu(n,e,t){const r=Z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const l=a.view.va(e);l.snapshot&&s.push(l.snapshot)})),(function(a,l){const u=Z(a);u.onlineState=l;let d=!1;u.queries.forEach(((f,v)=>{for(const T of v.Sa)T.va(l)&&(d=!0)})),d&&ic(u)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function P0(n,e,t){const r=Z(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new xe(W.comparator);a=a.insert(i,ct.newNoDocument(i,X.min()));const l=ue().add(i),u=new Zi(X.min(),new Map,new xe(le),a,l);await af(r,u),r.du=r.du.remove(i),r.Au.delete(e),ac(r)}else await ma(r.localStore,e,!1).then((()=>ya(r,e,t))).catch(xr)}async function k0(n,e){const t=Z(n),r=e.batch.batchId;try{const s=await Bv(t.localStore,e);lf(t,r,null),cf(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Fs(t,s)}catch(s){await xr(s)}}async function V0(n,e,t){const r=Z(n);try{const s=await(function(a,l){const u=Z(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let f;return u.mutationQueue.lookupMutationBatch(d,l).next((v=>(ve(v!==null,37113),f=v.keys(),u.mutationQueue.removeMutationBatch(d,v)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f))).next((()=>u.localDocuments.getDocuments(d,f)))}))})(r.localStore,e);lf(r,e,t),cf(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Fs(r,s)}catch(s){await xr(s)}}function cf(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function lf(n,e,t){const r=Z(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ya(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||uf(n,r)}))}function uf(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Za(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),ac(n))}function Iu(n,e,t){for(const r of t)r instanceof rf?(n.Ru.addReference(r.key,e),D0(n,r)):r instanceof sf?(U(oc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||uf(n,r.key)):Q(19791,{wu:r})}function D0(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(U(oc,"New document in limbo: "+t),n.Eu.add(r),ac(n))}function ac(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new W(Ce.fromString(e)),r=n.fu.next();n.Au.set(r,new w0(t)),n.du=n.du.insert(t,r),Gd(n.remoteStore,new bn(jt(qa(t.path)),r,"TargetPurposeLimboResolution",Ki.ce))}}async function Fs(n,e,t){const r=Z(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((l,u)=>{a.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const f=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(d){s.push(d);const f=Ja.As(u.targetId,d);i.push(f)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(u,d){const f=Z(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>D.forEach(d,(T=>D.forEach(T.Es,(R=>f.persistence.referenceDelegate.addReference(v,T.targetId,R))).next((()=>D.forEach(T.ds,(R=>f.persistence.referenceDelegate.removeReference(v,T.targetId,R)))))))))}catch(v){if(!Or(v))throw v;U(Xa,"Failed to update sequence numbers: "+v)}for(const v of d){const T=v.targetId;if(!v.fromCache){const R=f.Ms.get(T),S=R.snapshotVersion,k=R.withLastLimboFreeSnapshotVersion(S);f.Ms=f.Ms.insert(T,k)}}})(r.localStore,i))}async function N0(n,e){const t=Z(n);if(!t.currentUser.isEqual(e)){U(oc,"User change. New user:",e.toKey());const r=await $d(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((l=>{l.forEach((u=>{u.reject(new j(N.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Fs(t,r.Ls)}}function x0(n,e){const t=Z(n),r=t.Au.get(e);if(r&&r.hu)return ue().add(r.key);{let s=ue();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const l=t.Tu.get(a);s=s.unionWith(l.view.nu)}return s}}function hf(n){const e=Z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=af.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=x0.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=P0.bind(null,e),e.Pu.H_=_0.bind(null,e.eventManager),e.Pu.yu=y0.bind(null,e.eventManager),e}function O0(n){const e=Z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=k0.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=V0.bind(null,e),e}class xi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=eo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Uv(this.persistence,new Mv,e.initialUser,this.serializer)}Cu(e){return new qd(Ya.mi,this.serializer)}Du(e){return new Hv}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}xi.provider={build:()=>new xi};class M0 extends xi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ve(this.persistence.referenceDelegate instanceof Di,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new wv(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ht.withCacheSize(this.cacheSizeBytes):ht.DEFAULT;return new qd((r=>Di.mi(r,t)),this.serializer)}}class va{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Tu(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=N0.bind(null,this.syncEngine),await p0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new g0})()}createDatastore(e){const t=eo(e.databaseInfo.databaseId),r=(function(i){return new Jv(i)})(e.databaseInfo);return(function(i,a,l,u){return new t0(i,a,l,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,l){return new r0(r,s,i,a,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>Tu(this.syncEngine,t,0)),(function(){return gu.v()?new gu:new Wv})())}createSyncEngine(e,t){return(function(s,i,a,l,u,d,f){const v=new T0(s,i,a,l,u,d);return f&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Z(t);U(nr,"RemoteStore shutting down."),r.Ea.add(5),await Ls(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}va.provider={build:()=>new va};class df{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):sn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Mn="FirestoreClient";class L0{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=at.UNAUTHENTICATED,this.clientId=Ma.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{U(Mn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(U(Mn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new tn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=sc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function zo(n,e){n.asyncQueue.verifyOperationInProgress(),U(Mn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await $d(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Au(n,e){n.asyncQueue.verifyOperationInProgress();const t=await F0(n);U(Mn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>yu(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>yu(e.remoteStore,s))),n._onlineComponents=e}async function F0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U(Mn,"Using user provided OfflineComponentProvider");try{await zo(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;br("Error using user provided cache. Falling back to memory cache: "+t),await zo(n,new xi)}}else U(Mn,"Using default OfflineComponentProvider"),await zo(n,new M0(void 0));return n._offlineComponents}async function ff(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U(Mn,"Using user provided OnlineComponentProvider"),await Au(n,n._uninitializedComponentsProvider._online)):(U(Mn,"Using default OnlineComponentProvider"),await Au(n,new va))),n._onlineComponents}function U0(n){return ff(n).then((e=>e.syncEngine))}async function pf(n){const e=await ff(n),t=e.eventManager;return t.onListen=I0.bind(null,e.syncEngine),t.onUnlisten=R0.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=A0.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=S0.bind(null,e.syncEngine),t}function B0(n,e,t={}){const r=new tn;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,l,u,d){const f=new df({next:T=>{f.Nu(),a.enqueueAndForget((()=>tf(i,v)));const R=T.docs.has(l);!R&&T.fromCache?d.reject(new j(N.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&T.fromCache&&u&&u.source==="server"?d.reject(new j(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(T)},error:T=>d.reject(T)}),v=new nf(qa(l.path),f,{includeMetadataChanges:!0,qa:!0});return ef(i,v)})(await pf(n),n.asyncQueue,e,t,r))),r.promise}function j0(n,e,t={}){const r=new tn;return n.asyncQueue.enqueueAndForget((async()=>(function(i,a,l,u,d){const f=new df({next:T=>{f.Nu(),a.enqueueAndForget((()=>tf(i,v))),T.fromCache&&u.source==="server"?d.reject(new j(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(T)},error:T=>d.reject(T)}),v=new nf(l,f,{includeMetadataChanges:!0,qa:!0});return ef(i,v)})(await pf(n),n.asyncQueue,e,t,r))),r.promise}function mf(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const bu=new Map;const gf="firestore.googleapis.com",Ru=!0;class Su{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new j(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gf,this.ssl=Ru}else this.host=e.host,this.ssl=e.ssl??Ru;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=zd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vv)throw new j(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}n1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mf(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new j(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new j(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new j(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ro{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Su({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new j(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new j(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Su(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Hy;switch(r.type){case"firstParty":return new Yy(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new j(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=bu.get(t);r&&(U("ComponentProvider","Removing Datastore"),bu.delete(t),r.terminate())})(this),Promise.resolve()}}function z0(n,e,t,r={}){n=Kt(n,ro);const s=Vr(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;s&&(sh(`https://${l}`),ih("Firestore",!0)),i.host!==gf&&i.host!==l&&br("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:s,emulatorOptions:r};if(!Jn(u,a)&&(n._setSettings(u),r.mockUserToken)){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=at.MOCK_USER;else{d=nm(r.mockUserToken,n._app?.options.projectId);const v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new j(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new at(v)}n._authCredentials=new Wy(new td(d,f))}}class so{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new so(this.firestore,e,this._query)}}class $e{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $e(this.firestore,e,this._key)}toJSON(){return{type:$e._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(xs(t,$e._jsonSchema))return new $e(e,r||null,new W(Ce.fromString(t.referencePath)))}}$e._jsonSchemaVersion="firestore/documentReference/1.0",$e._jsonSchema={type:qe("string",$e._jsonSchemaVersion),referencePath:qe("string")};class kn extends so{constructor(e,t,r){super(e,t,qa(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $e(this.firestore,null,new W(e))}withConverter(e){return new kn(this.firestore,e,this._path)}}function q0(n,e,...t){if(n=Xe(n),nd("collection","path",e),n instanceof ro){const r=Ce.fromString(e,...t);return jl(r),new kn(n,null,r)}{if(!(n instanceof $e||n instanceof kn))throw new j(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ce.fromString(e,...t));return jl(r),new kn(n.firestore,null,r)}}function Rt(n,e,...t){if(n=Xe(n),arguments.length===1&&(e=Ma.newId()),nd("doc","path",e),n instanceof ro){const r=Ce.fromString(e,...t);return Bl(r),new $e(n,null,new W(r))}{if(!(n instanceof $e||n instanceof kn))throw new j(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ce.fromString(e,...t));return Bl(r),new $e(n.firestore,n instanceof kn?n.converter:null,new W(r))}}const Cu="AsyncQueue";class Pu{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Hd(this,"async_queue_retry"),this._c=()=>{const r=jo();r&&U(Cu,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=jo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=jo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new tn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Or(e))throw e;U(Cu,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,sn("INTERNAL UNHANDLED ERROR: ",ku(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=rc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&Q(47125,{Pc:ku(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function ku(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Lr extends ro{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Pu,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Pu(e),this._firestoreClient=void 0,await e}}}function $0(n,e){const t=typeof n=="object"?n:lh(),r=typeof n=="string"?n:bi,s=Ra(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=em("firestore");i&&z0(s,...i)}return s}function cc(n){if(n._terminated)throw new j(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||K0(n),n._firestoreClient}function K0(n){const e=n._freezeSettings(),t=(function(s,i,a,l){return new f1(s,i,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,mf(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new L0(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class At{constructor(e){this._byteString=e}static fromBase64String(e){try{return new At(it.fromBase64String(e))}catch(t){throw new j(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new At(it.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:At._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xs(e,At._jsonSchema))return At.fromBase64String(e.bytes)}}At._jsonSchemaVersion="firestore/bytes/1.0",At._jsonSchema={type:qe("string",At._jsonSchemaVersion),bytes:qe("string")};class io{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new j(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class lc{constructor(e){this._methodName=e}}class qt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new j(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new j(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:qt._jsonSchemaVersion}}static fromJSON(e){if(xs(e,qt._jsonSchema))return new qt(e.latitude,e.longitude)}}qt._jsonSchemaVersion="firestore/geoPoint/1.0",qt._jsonSchema={type:qe("string",qt._jsonSchemaVersion),latitude:qe("number"),longitude:qe("number")};class $t{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:$t._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xs(e,$t._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new $t(e.vectorValues);throw new j(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$t._jsonSchemaVersion="firestore/vectorValue/1.0",$t._jsonSchema={type:qe("string",$t._jsonSchemaVersion),vectorValues:qe("object")};const H0=/^__.*__$/;class W0{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Un(e,this.data,this.fieldMask,t,this.fieldTransforms):new Os(e,this.data,t,this.fieldTransforms)}}class _f{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Un(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function yf(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q(40011,{Ac:n})}}class uc{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new uc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Oi(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(yf(this.Ac)&&H0.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class G0{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||eo(e)}Cc(e,t,r,s=!1){return new uc({Ac:e,methodName:t,Dc:r,path:st.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vf(n){const e=n._freezeSettings(),t=eo(n._databaseId);return new G0(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Q0(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);hc("Data must be an object, but it was:",a,r);const l=Ef(r,a);let u,d;if(i.merge)u=new wt(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const v of i.mergeFields){const T=Ea(e,v,t);if(!a.contains(T))throw new j(N.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Tf(f,T)||f.push(T)}u=new wt(f),d=a.fieldTransforms.filter((v=>u.covers(v.field)))}else u=null,d=a.fieldTransforms;return new W0(new pt(l),u,d)}class oo extends lc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof oo}}function Y0(n,e,t,r){const s=n.Cc(1,e,t);hc("Data must be an object, but it was:",s,r);const i=[],a=pt.empty();Fn(r,((u,d)=>{const f=dc(e,u,t);d=Xe(d);const v=s.yc(f);if(d instanceof oo)i.push(f);else{const T=ao(d,v);T!=null&&(i.push(f),a.set(f,T))}}));const l=new wt(i);return new _f(a,l,s.fieldTransforms)}function J0(n,e,t,r,s,i){const a=n.Cc(1,e,t),l=[Ea(e,r,t)],u=[s];if(i.length%2!=0)throw new j(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<i.length;T+=2)l.push(Ea(e,i[T])),u.push(i[T+1]);const d=[],f=pt.empty();for(let T=l.length-1;T>=0;--T)if(!Tf(d,l[T])){const R=l[T];let S=u[T];S=Xe(S);const k=a.yc(R);if(S instanceof oo)d.push(R);else{const P=ao(S,k);P!=null&&(d.push(R),f.set(R,P))}}const v=new wt(d);return new _f(f,v,a.fieldTransforms)}function ao(n,e){if(wf(n=Xe(n)))return hc("Unsupported field value:",e,n),Ef(n,e);if(n instanceof lc)return(function(r,s){if(!yf(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const l of r){let u=ao(l,s.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=Xe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return L1(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Pe.fromDate(r);return{timestampValue:Vi(s.serializer,i)}}if(r instanceof Pe){const i=new Pe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vi(s.serializer,i)}}if(r instanceof qt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof At)return{bytesValue:Od(s.serializer,r._byteString)};if(r instanceof $e){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ga(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof $t)return(function(a,l){return{mapValue:{fields:{[hd]:{stringValue:dd},[Ri]:{arrayValue:{values:a.toArray().map((d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return $a(l.serializer,d)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${La(r)}`)})(n,e)}function Ef(n,e){const t={};return id(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fn(n,((r,s)=>{const i=ao(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function wf(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pe||n instanceof qt||n instanceof At||n instanceof $e||n instanceof lc||n instanceof $t)}function hc(n,e,t){if(!wf(t)||!rd(t)){const r=La(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Ea(n,e,t){if((e=Xe(e))instanceof io)return e._internalPath;if(typeof e=="string")return dc(n,e);throw Oi("Field path arguments must be of type string or ",n,!1,void 0,t)}const X0=new RegExp("[~\\*/\\[\\]]");function dc(n,e,t){if(e.search(X0)>=0)throw Oi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new io(...e.split("."))._internalPath}catch{throw Oi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Oi(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new j(N.INVALID_ARGUMENT,l+n+u)}function Tf(n,e){return n.some((t=>t.isEqual(e)))}class If{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new $e(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Z0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Af("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Z0 extends If{data(){return super.data()}}function Af(n,e){return typeof e=="string"?dc(n,e):e instanceof io?e._internalPath:e._delegate._internalPath}function eE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new j(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tE{convertValue(e,t="none"){switch(xn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ue(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Nn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Q(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Fn(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[Ri].arrayValue?.values?.map((r=>Ue(r.doubleValue)));return new $t(t)}convertGeoPoint(e){return new qt(Ue(e.latitude),Ue(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Wi(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Is(e));default:return null}}convertTimestamp(e){const t=Dn(e);return new Pe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ce.fromString(e);ve(jd(r),9688,{name:e});const s=new As(r.get(1),r.get(3)),i=new W(r.popFirst(5));return s.isEqual(t)||sn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function nE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class us{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gn extends If{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Af("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new j(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Gn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Gn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Gn._jsonSchema={type:qe("string",Gn._jsonSchemaVersion),bundleSource:qe("string","DocumentSnapshot"),bundleName:qe("string"),bundle:qe("string")};class fi extends Gn{data(e={}){return super.data(e)}}class Ir{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new us(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new fi(this._firestore,this._userDataWriter,r.key,r,new us(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new j(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((l=>{const u=new fi(s._firestore,s._userDataWriter,l.doc.key,l.doc,new us(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((l=>i||l.type!==3)).map((l=>{const u=new fi(s._firestore,s._userDataWriter,l.doc.key,l.doc,new us(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),f=a.indexOf(l.doc.key)),{type:rE(l.type),doc:u,oldIndex:d,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new j(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ir._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ma.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rE(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q(61501,{type:n})}}function ys(n){n=Kt(n,$e);const e=Kt(n.firestore,Lr);return B0(cc(e),n._key).then((t=>aE(e,n,t)))}Ir._jsonSchemaVersion="firestore/querySnapshot/1.0",Ir._jsonSchema={type:qe("string",Ir._jsonSchemaVersion),bundleSource:qe("string","QuerySnapshot"),bundleName:qe("string"),bundle:qe("string")};class bf extends tE{constructor(e){super(),this.firestore=e}convertBytes(e){return new At(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $e(this.firestore,null,t)}}function sE(n){n=Kt(n,so);const e=Kt(n.firestore,Lr),t=cc(e),r=new bf(e);return eE(n._query),j0(t,n._query).then((s=>new Ir(e,r,n,s)))}function gr(n,e,t){n=Kt(n,$e);const r=Kt(n.firestore,Lr),s=nE(n.converter,e,t);return fc(r,[Q0(vf(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,kt.none())])}function iE(n,e,t,...r){n=Kt(n,$e);const s=Kt(n.firestore,Lr),i=vf(s);let a;return a=typeof(e=Xe(e))=="string"||e instanceof io?J0(i,"updateDoc",n._key,e,t,r):Y0(i,"updateDoc",n._key,e),fc(s,[a.toMutation(n._key,kt.exists(!0))])}function oE(n){return fc(Kt(n.firestore,Lr),[new Ka(n._key,kt.none())])}function fc(n,e){return(function(r,s){const i=new tn;return r.asyncQueue.enqueueAndForget((async()=>C0(await U0(r),s,i))),i.promise})(cc(n),e)}function aE(n,e,t){const r=t.docs.get(e._key),s=new bf(n);return new Gn(n,s,e._key,r,new us(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Nr=s})(Dr),Ar(new Xn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Lr(new Gy(r.getProvider("auth-internal")),new Jy(a,r.getProvider("app-check-internal")),(function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new j(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new As(d.options.projectId,f)})(a,s),a);return i={useFetchStreams:t,...i},l._setSettings(i),l}),"PUBLIC").setMultipleInstances(!0)),Cn(Ml,Ll,e),Cn(Ml,Ll,"esm2020")})();const cE={apiKey:"AIzaSyCVOWRz48Jz9lT1in3tIqVGDosmMlEmcq0",authDomain:"tracker-92901.firebaseapp.com",projectId:"tracker-92901",storageBucket:"tracker-92901.firebasestorage.app",messagingSenderId:"222325967743",appId:"1:222325967743:web:c86334e2754db3841b684a",measurementId:"G-GM4CCLCWHQ"},Rf=ch(cE),Ft=$y(Rf),Tt=$0(Rf),lr=""+new URL("../assets/sparkles.TOf8JALk.gif",import.meta.url).href;async function ur(n,e){const t=new TextEncoder,r=await crypto.subtle.importKey("raw",t.encode(n),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t.encode(e),iterations:1e5,hash:"SHA-256"},r,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function Vu(n,e){const t=new TextEncoder,r=n.toLowerCase().trim(),s=await crypto.subtle.importKey("raw",t.encode(r),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t.encode(e+"-recovery"),iterations:1e5,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function qo(){return crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function lE(n){const e=await crypto.subtle.exportKey("raw",n);return btoa(String.fromCharCode(...new Uint8Array(e)))}async function uE(n){const e=Uint8Array.from(atob(n),t=>t.charCodeAt(0));return crypto.subtle.importKey("raw",e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function Sf(n,e){const t=new TextEncoder,r=crypto.getRandomValues(new Uint8Array(12)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,t.encode(n)),i=new Uint8Array(r.length+s.byteLength);return i.set(r),i.set(new Uint8Array(s),r.length),btoa(String.fromCharCode(...i))}async function Cf(n,e){const t=Uint8Array.from(atob(n),l=>l.charCodeAt(0)),r=t.slice(0,12),s=t.slice(12),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},e,s);return new TextDecoder().decode(i)}async function ss(n,e){const t=await lE(n);return Sf(t,e)}async function $o(n,e){try{const t=await Cf(n,e);return uE(t)}catch{throw new Error("DECRYPT_FAILED")}}async function hE(n,e,t){const r={...n};for(const s of e)n[s]!=null&&(r[s]=await Sf(String(n[s]),t));return r}async function dE(n,e,t){const r={...n};for(const s of e)if(n[s])try{r[s]=await Cf(n[s],t)}catch(i){console.error(`Failed to decrypt field ${s}:`,i),r[s]=null}return r}const Hn=Jf(!1),fE=n=>n;function ft(n,{delay:e=0,duration:t=400,easing:r=fE}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function Qn(n){return n*n*n}function Yn(n){const e=n-1;return e*e*e+1}var pE=de("<option> </option>"),mE=de('<div class="login-hint"> </div>'),gE=de('<div class="overlay" style="z-index: 1000;"><h2>Recovery Setup</h2> <p style="font-size: 10pt; width: 80vw">If you do not want to provide a recovery answer, please create an account without an email.</p> <br/> <select class="login_input" style="width: 350px; padding: 0; margin:0"><option>Choose a security question</option><!></select> <br/> <input type="text" placeholder="Your answer" class="login_input" style="width: 347px;"/> <br/><br/> <span><button>Complete Signup</button> <button>Cancel</button></span> <!></div>'),_E=de('<div class="login-hint"> </div>'),yE=de('<div class="overlay" style="z-index: 1000;"><h2>Account Recovery</h2> <p style="font-size: 10pt; width: 90vw">Your password was recently reset. Please answer your security question to recover your data.</p> <br/> <p><i> </i></p> <br/> <input type="text" placeholder="Your answer" class="login_input" style="width: 347px;"/> <br/><br/> <span><button>Recover Data</button> <button>Cancel</button></span> <!> <br/> <p style="font-size: 10pt; width: 90vw">If you cannot remember your answer, your data is unfortunately unrecoverable.</p></div>'),vE=de(`<div class="overlay" style="z-index: 1000;"><h3>Privacy Notice</h3> <p style="font-size: 10pt; width: clamp(320px, 33vw, 33vw); text-align:justify">All personal data is locally encrypted using 256-bit AES-GCM before being sent to to Google Firebase. Importantly, I cannot see it, and neither can they! <br/><br/>For accounts that are setup without an email, your data will be unrecoverable if you forget your password. (Password resetting is not possible in this case.) For accounts that <i>are</i> setup with email, you will be asked to answer a security question on signup, which enables data recovery. <br/><br/>The diagram below details Good Calendar's mechanism for securing and recovering data. Elements in <span style="color: #d65c5c">red</span> are viewable by myself and the Firebase server and, together, cannot decrypt your data.</p><br/> <div><svg width="clamp(400px, 80vw, 60vw)" viewBox="25 80 792 282" font-weight="bold"><text fill="#d65c5c" xml:space="preserve" transform="matrix(1 0 -0 1 .000061035159 612)" font-size="9.9626" font-family="Kp"><tspan y="-506.88" x="646.222 651.45236 656.1746 660.2194 665.38009 670.10238 674.14718 676.2991 682.96408 692.0898 697.00137 701.12588 704.6327 709.355 715.94027 722.86428 727.58657">Server&#x2019;sMasterKey</tspan></text><text fill="#5c5cd6" xml:space="preserve" transform="matrix(1 0 -0 1 .000030517579 612)" font-size="9.9626" font-family="Kp"><tspan y="-453.856" x="138.687 144.11663 149.02819 153.1527 157.2772 164.98827 170.22859 174.2734">Password</tspan></text><text fill="#5c5cd6" xml:space="preserve" transform="matrix(1 0 -0 1 .000030517579 612)" font-size="9.9626" font-family="Kp"><tspan y="-453.856" x="369.44 374.8696 379.78117 383.90568 388.03019 395.74125 400.98158 405.0264 413.48466 420.40864 425.1309">PasswordKey</tspan></text><text fill="#d65c5c" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="9.9626" font-family="Kp"><tspan y="-453.856" x="660.658 665.88839 670.61068 674.65548 679.8161 684.5384 688.5832 690.7351 697.4001 705.13107 709.97286 713.4797">Server&#x2019;sData</tspan></text><text fill="#d65c5c" xml:space="preserve" transform="matrix(1 0 -0 1 .000030517579 612)" font-size="9.9626" font-family="Kp"><tspan y="-397.882" x="142.323 149.79496 153.91947 158.64174 165.22702 168.82352">UserID</tspan></text><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 .000030517579 612)" font-size="8.9664" font-family="Kp"><tspan y="-401.55" x="257.272 263.27949 267.69993 272.98115 278.3072 283.02354 290.89604 296.17726 300.4273 304.1394">Randomness</tspan></text><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 .000030517579 612)" font-size="7.5716" font-family="Kp"><tspan y="-394.728" x="263.428 266.00993 269.99259 276.38304 279.51768 281.81187 285.83238 290.17848 294.69114 299.22654">(onsignup)</tspan></text><text fill="#5c5cd6" xml:space="preserve" transform="matrix(1 0 -0 1 .000030517579 612)" font-size="9.9626" font-family="Kp"><tspan y="-397.882" x="486.979 496.10475 501.0163 505.1408 508.64765 513.36996 519.9552 526.8792 531.6015">MasterKey</tspan></text><text fill="#5c5cd6" xml:space="preserve" transform="matrix(1 0 -0 1 .00005340576 612)" font-size="9.9626" font-family="Kp"><tspan y="-342.61" x="123.195 128.42537 133.14765 137.68064 143.61835 147.66316 150.68183 154.18866 161.96945 169.30193 175.16989 179.2944 186.91579 191.63806">SecurityAnswer</tspan></text><text fill="#5c5cd6" xml:space="preserve" transform="matrix(1 0 -0 1 .000061035159 612)" font-size="9.9626" font-family="Kp"><tspan y="-342.61" x="370.023 376.69795 381.4202 385.9532 391.1935 396.35417 401.07643 405.12126 412.90205 419.82603 424.54829">RecoveryKey</tspan></text><text fill="#5c5cd6" xml:space="preserve" transform="matrix(1 0 -0 1 .00012207031 612)" font-size="9.9626" font-family="Kp"><tspan y="-342.61" x="667.428 672.86758 678.1079 684.0456 690.63088 698.3618 703.2036 706.71047">YourData</tspan></text><text fill="#d65c5c" xml:space="preserve" transform="matrix(1 0 -0 1 .000061035159 612)" font-size="9.9626" font-family="Kp"><tspan y="-289.731" x="641.271 646.50137 651.22366 655.26846 660.4291 665.15139 669.19619 671.3481 678.01309 684.688 689.4103 693.94326 699.1836 704.34426 709.0665 713.1113 720.89218 727.81619 732.53848">Server&#x2019;sRecoveryKey</tspan></text><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M-245.70612 55.79094H-66.13823"></path><path transform="matrix(1,0,0,-1,364.59785,155.65206)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="8.9664" font-family="Kp"><tspan y="-469.62" x="256.076 260.70268 264.95274 270.23396 274.484 278.07954 282.4372 285.59336 289.8434">generates</tspan></text><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="7.5716" font-family="Kp"><tspan y="-458.975" x="238.21099 242.79938 247.51648 252.93775 258.8133 263.05339 269.11067 273.16905 275.46324 281.12678 285.10188 291.12889 296.28514 299.0412 303.16773 307.29426">PBKDF2viaSHA-256</tspan></text><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M-113.06291-.18431H51.40237"></path><path transform="matrix(1,0,0,-1,482.13844,211.6273)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" d="M-51.51788-6.2008H-9.644501V5.83216H-51.51788Z" fill="var(--V-background-white)"></path><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 .000030517579 612)" font-size="8.9664" font-family="Kp"><tspan y="-398.902" x="381.166 385.79267 390.04273 395.32395 399.574 403.16954 407.5272 410.68336 414.9334">generates</tspan></text><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M94.93706 8.11462 97.05981 9.41722 97.54662 10.82631 100.50012 10.4179 101.47372 13.23608 104.42725 12.82767 105.40085 15.64586 108.35435 15.23746 109.32797 18.05562 112.28146 17.64722 113.25508 20.46541 116.2086 20.05699 117.18219 22.87518 120.13571 22.46677 121.10931 25.28496 124.06282 24.87656 125.03644 27.69473 127.98994 27.28633 128.96356 30.10452 131.91706 29.6961 132.89067 32.51428 135.8442 32.10587 136.81778 34.92406 139.7713 34.51566 140.7449 37.33383 143.69841 36.92543 144.67203 39.74362 147.62554 39.3352 148.59914 42.1534 151.55265 41.74498 152.52626 44.56316 155.47977 44.15475 156.45337 46.97293 159.40689 46.56453 160.3805 49.38272 163.334 48.9743 164.30762 51.7925 167.26113 51.38408 168.23473 54.20227 171.18824 53.79387 172.16185 56.61205 175.11536 56.20364 176.08896 59.02182 179.04248 58.6134 180.01607 61.4316 182.96959 61.02318 183.9432 63.84137 186.8967 63.43297 187.87032 66.25114 190.82382 65.84274 191.79744 68.66093 194.75095 68.25252 195.72455 71.0707 198.67807 70.66228 199.65166 73.48047 202.60518 73.07207 203.5788 75.89024 206.53229 75.48184 207.5059 78.30003 210.45941 77.89162 211.43302 80.70981 214.38654 80.30139 215.36014 83.11958 218.31365 82.71118 219.28725 85.52934 222.24077 85.12094 223.21439 87.93913 226.16788 87.53072 227.1415 90.3489 230.09502 89.94049 231.0686 92.75868 234.02213 92.35028 234.99573 95.16846 237.94924 94.76006 238.92284 97.57823 240.39962 97.37402 244.04094 99.60915"></path><path transform="matrix(-.85231,.52295,.52295,.85231,525.2118,203.45862)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><path transform="matrix(.85223,-.52307,-.52307,-.85223,674.74026,111.70356)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M96.52023-9.38838 98.64764-10.68346 100.12367-10.47401 101.10727-13.28873 104.05936-12.86987 105.04297-15.68459 107.99506-15.26573 108.97867-18.08043 111.93074-17.66158 112.91435-20.4763 115.86644-20.05743 116.85007-22.87215 119.80215-22.45328 120.78575-25.268 123.73784-24.84915 124.72145-27.66385 127.67354-27.245 128.65715-30.05972 131.60924-29.64085 132.59284-32.45557 135.54492-32.0367 136.52854-34.85143 139.48062-34.43257 140.46424-37.24727 143.4163-36.82841 144.39992-39.64313 147.352-39.22427 148.33562-42.03899 151.2877-41.62012 152.2713-44.43484 155.22339-44.01598 156.20702-46.83069 159.1591-46.41183 160.14272-49.22655 163.0948-48.8077 164.0784-51.6224 167.03049-51.20354 168.0141-54.01826 170.96619-53.5994 171.9498-56.41411 174.90187-55.99525 175.88549-58.80997 178.83757-58.39111 179.82118-61.20581 182.77327-60.78696 183.75687-63.60168 186.70896-63.18282 187.69257-65.99753 190.64466-65.57867 191.62827-68.39339 194.58036-67.97453 195.56397-70.78923 198.51605-70.37038 199.49967-73.1851 202.45175-72.76624 203.43537-75.58095 206.38744-75.16208 207.37105-77.9768 210.32314-77.55795 211.30675-80.37265 214.25884-79.9538 215.24243-82.76852 218.19452-82.34966 219.17813-85.16437 222.13022-84.7455 223.11383-87.56023 226.06592-87.14137 227.04952-89.95607 230.0016-89.53722 230.98522-92.35193 233.9373-91.93307 234.92093-94.74779 237.873-94.32892 238.85662-97.14365 241.8087-96.72478 242.3005-98.13214 244.72724-99.6106"></path><path transform="matrix(-.85414,-.51993,-.51993,.85414,526.7945,220.70189)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><path transform="matrix(.85397,.52022,.52022,-.85397,675.42697,311.18318)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M-230.21404-55.45715H-65.55542"></path><path transform="matrix(1,0,0,-1,365.18067,266.90016)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="8.9664" font-family="Kp"><tspan y="-337.364" x="264.113 268.7397 272.98976 278.27098 282.52104 286.11656 290.4742 293.63038 297.88044">generates</tspan></text><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="7.5716" font-family="Kp"><tspan y="-326.71903" x="246.248 250.8364 255.5535 260.97477 266.8503 271.0904 277.14768 281.20606 283.50025 289.1638 293.1389 299.1659 304.32215 307.07823 311.20475 315.33128">PBKDF2viaSHA-256</tspan></text><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M259.04124-46.92056V-44.42987L258.0948-43.27792 259.9877-40.97403 258.0948-38.67015 259.9877-36.36626 258.0948-34.06236 259.9877-31.75847 258.0948-29.45459 259.9877-27.1507 258.0948-24.8468 259.9877-22.54291 258.0948-20.23903 259.9877-17.93513 258.0948-15.63124 259.9877-13.32735 258.0948-11.02347 259.9877-8.71957 258.0948-6.41568 259.9877-4.11179 258.0948-1.8079 259.9877 .49597 258.0948 2.79987 259.9877 5.10376 258.0948 7.40764 259.9877 9.71153 258.0948 12.01543 259.9877 14.31932 258.0948 16.6232 259.9877 18.9271 258.0948 21.23099 259.9877 23.53488 258.0948 25.83876 259.9877 28.14265 258.0948 30.44655 259.9877 32.75044 258.0948 35.05432 259.9877 37.35822 258.0948 39.66211 259.9877 41.966 258.0948 44.26988 259.04124 45.42183V48.62921"></path><path transform="matrix(0,1,1,0,689.5282,258.6126)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><path transform="matrix(0,-1,-1,-0,689.5282,162.56472)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="var(--V-medium-text)" d="M-2.5903 2.98882C-2.11707 1.1955-1.06248 .34868 0 0-1.06248-.34868-2.11707-1.1955-2.5903-2.98882"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M4.4777 61.42294C39.5597 67.06998 99.57834 66.49132 168.7418 53.99678"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" d="M22.62114 53.71736H125.0372V75.30849H22.62114Z" fill="var(--V-background-white)"></path><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="8.9664" font-family="Kp"><tspan y="-467.216" x="460.286 464.53608 469.8173 473.897 477.53736 482.2537 487.62458 490.78074 496.77928 501.1997 506.48094 514.0934 519.41946 523.6695 527.7492 531.3896 536.1059 541.47677 544.63296">encryptsanddecrypts</tspan></text><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="7.5716" font-family="Kp"><tspan y="-456.652" x="486.885 492.4577 497.05366 501.02876 503.78483 509.5165 514.809">AES-GCM</tspan></text><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M-258.8948 7.85413C-233.27727 24.7853-198.6652 41.5772-156.42032 55.54402"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" d="M-238.33768 22.47188H-209.51052V33.39301H-238.33768Z" fill="var(--V-background-white)"></path><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="8.9664" font-family="Kp"><tspan y="-425.301" x="194.349 198.76944 204.76798 208.48007 212.90052 215.62631">assalt</tspan></text><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M-260.10447-6.8479C-230.2983-24.98552-193.27509-41.56668-148.38288-55.22986"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" d="M-235.24535-33.23903H-206.41819V-22.317898H-235.24535Z" fill="var(--V-background-white)"></path><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="8.9664" font-family="Kp"><tspan y="-369.591" x="197.441 201.86144 207.85997 211.57207 215.99251 218.7183">assalt</tspan></text><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M110.96405-2.472 258.30839-1.61024"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" d="M133.42818-12.8367H235.84424V8.754429H133.42818Z" fill="var(--V-background-white)"></path><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="8.9664" font-family="Kp"><tspan y="-400.663" x="571.091 575.34109 580.62228 584.70199 588.34237 593.05868 598.4295 601.5857 607.5842 612.00466 617.2858 624.8983 630.22439 634.4744 638.55416 642.1945 646.9108 652.2817 655.43789">encryptsanddecrypts</tspan></text><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="7.5716" font-family="Kp"><tspan y="-390.099" x="597.691 603.2637 607.8596 611.8347 614.59078 620.32247 625.615">AES-GCM</tspan></text><path transform="matrix(1,0,0,-1,430.487,211.443)" stroke-width="1" stroke-linecap="butt" stroke-miterlimit="10" stroke-linejoin="miter" fill="none" stroke="var(--V-medium-text)" d="M3.8949-61.1381C39.89847-67.07677 100.25749-66.78949 169.8765-54.62994"></path><path transform="matrix(1,0,0,-1,430.487,211.443)" d="M23.07187-75.46638H125.48793V-53.875249H23.07187Z" fill="var(--V-background-white)"></path><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="8.9664" font-family="Kp"><tspan y="-338.034" x="460.736 464.98606 470.26728 474.347 477.98735 482.70368 488.07456 491.2307 497.22926 501.6497 506.9309 514.5434 519.86947 524.1195 528.1992 531.8396 536.5559 541.92678 545.08297">encryptsanddecrypts</tspan></text><text fill="var(--V-medium-text)" xml:space="preserve" transform="matrix(1 0 -0 1 0 612)" font-size="7.5716" font-family="Kp"><tspan y="-327.47" x="487.336 492.9087 497.50465 501.47975 504.2358 509.9675 515.26">AES-GCM</tspan></text></svg></div> <p style="font-size: 10pt; width: clamp(320px, 33vw, 33vw); text-align:justify">The code for this project is avalible on GitHub. Feel free to email for suggestions, errors, and improvements <a href="https://github.com/hayekn/goodcalendar" target="_blank"><svg height="12pt" style="transform:translateY(3px); margin-left: 2px" viewBox="0 0 448 512"><path fill="var(--V-medium-text)" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg></a></p><br/> <button>Return</button></div>`),EE=de('<div class="parent"><br/> <h1 class="title">Good Calendar</h1> <div style="margin-top: 2rem; position:relative"><div style="display: flex; flex-direction: column; align-items: flex-start; gap: 0.5rem;"><input type="text" placeholder="Username or Email" class="login_input" style="width: 200px;"/> <div style="display: flex; align-items: center; position: relative;"><input placeholder="Password" class="login_input" style="width: 200px;"/> <button class="login-show-password"> </button></div></div></div> <div style="position:relative"><div style="text-align:center"><button style="font-size:11pt;">Login</button> <button style="font-size:11pt;">Sign up</button></div> <div style="margin-top: 5px; text-align:center"><button style="font-size:11pt;">Forgot Password</button></div></div> <div class="login-hint"><!></div> <p style="text-align: center; width: clamp(350px, 45vw, 45vw); color: var(--V-medium-text); font-size: 12pt">Track the quality of your days and nights using color-coded ratings and comments. Dedicated to my girlfriend and her chronic migranes. All data is encrypted and private.</p> <p style="text-align: center; max-width: 550px; color: var(--V-medium-text); font-size: 9pt">For demo, username and password: <span style="text-decoration:underline">goodcalendar</span></p> <span><a href="https://nicholashayek.com/" style="margin: 0; padding: 0px 10px"><svg height="25px" viewBox="0 0 576 512"><path fill="var(--V-medium-text)" d="M575.8 255.5c0 18-15 32.1-32 32.1l-32 0 .7 160.2c0 2.7-.2 5.4-.5 8.1l0 16.2c0 22.1-17.9 40-40 40l-16 0c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1L416 512l-24 0c-22.1 0-40-17.9-40-40l0-24 0-64c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32 14.3-32 32l0 64 0 24c0 22.1-17.9 40-40 40l-24 0-31.9 0c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2l-16 0c-22.1 0-40-17.9-40-40l0-112c0-.9 0-1.9 .1-2.8l0-69.7-32 0c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"></path></svg></a> <button style="background-color: rgb(0, 0, 0, 0); margin: 0; padding: 0px 10px"><svg height="25px" viewBox="0 0 512 512"><path fill="var(--V-medium-text)" d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"></path></svg></button> <button style="background-color: rgb(0, 0, 0, 0); margin: 0; padding: 0px 10px"><svg height="25px" viewBox="0 0 448 512"><path fill="var(--V-medium-text)" d="M383.9 308.3l23.9-62.6c4-10.5-3.7-21.7-15-21.7h-58.5c11-18.9 17.8-40.6 17.8-64v-.3c39.2-7.8 64-19.1 64-31.7 0-13.3-27.3-25.1-70.1-33-9.2-32.8-27-65.8-40.6-82.8-9.5-11.9-25.9-15.6-39.5-8.8l-27.6 13.8c-9 4.5-19.6 4.5-28.6 0L182.1 3.4c-13.6-6.8-30-3.1-39.5 8.8-13.5 17-31.4 50-40.6 82.8-42.7 7.9-70 19.7-70 33 0 12.6 24.8 23.9 64 31.7v.3c0 23.4 6.8 45.1 17.8 64H56.3c-11.5 0-19.2 11.7-14.7 22.3l25.8 60.2C27.3 329.8 0 372.7 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-48.4-25.8-90.4-64.1-114.1zM176 480l-41.6-192 49.6 32 24 40-32 120zm96 0l-32-120 24-40 49.6-32L272 480zm41.7-298.5c-3.9 11.9-7 24.6-16.5 33.4-10.1 9.3-48 22.4-64-25-2.8-8.4-15.4-8.4-18.3 0-17 50.2-56 32.4-64 25-9.5-8.8-12.7-21.5-16.5-33.4-.8-2.5-6.3-5.7-6.3-5.8v-10.8c28.3 3.6 61 5.8 96 5.8s67.7-2.1 96-5.8v10.8c-.1.1-5.6 3.2-6.4 5.8z"></path></svg></button></span></div>'),wE=de("<!> <!> <!> <!>",1);function TE(n,e){Ui(e,!1);let t=oe(""),r=oe(""),s=oe(""),i="",a=oe(!0),l=oe(!1),u=oe(""),d=oe(""),f=["What is your mother's maiden name?","What city were you born in?","What was the name of your first pet?","What is your favorite book?","What was the make of your first car?"],v=oe(!1),T=oe(!1),R=oe(""),S=null,k=null,P=oe(""),L=Ct(e,"darkMode",8,()=>{});async function M(){V(s,"Signing up...");try{if(_(t).includes("@")){i=_(t);const q=(await Al(Ft,i,_(r))).user.uid;k=_(r),S=q,console.log("Created temporary user."),V(s,""),V(T,!0),window.addEventListener("beforeunload",function($){_(T)&&(event.returnValue="Are you sure?")})}else{i=`${_(t)}@tracker.app`;const q=(await Al(Ft,i,_(r))).user.uid;k=_(r),S=q;const $=await qo(),J=await ur(k,S),he=await ss($,J);await gr(Rt(Tt,"users",S),{wrappedMasterKey:he,timestamp:Date.now()},{merge:!0}),window.sessionEncryptionKey=$,S=null,k=null,console.log("Completed user registration."),Hn.set(!0)}}catch(x){console.error(x),V(s,x.message)}}async function z(){if(!_(u)||!_(d).trim()){V(s,"Please select a question and provide an answer");return}try{const x=await qo(),q=await ur(k,S),$=await ss(x,q),J=await Vu(_(d),S),he=await ss(x,J);await gr(Rt(Tt,"users",S),{wrappedMasterKey:$,wrappedRecoveryKey:he,securityQuestion:_(u),timestamp:Date.now()},{merge:!0}),window.sessionEncryptionKey=x,V(T,!1),V(u,""),V(d,""),S=null,k=null,console.log("Completed user registration."),Hn.set(!0)}catch(x){console.error(x),V(s,x.message);return}}async function ne(){await oE(Rt(Tt,"users",S)),Ft.currentUser.delete(),console.log("Deleted temporary user."),V(T,!1),V(u,""),V(d,""),S=null,k=null}async function Y(){V(s,"Logging in...");try{if(_(t).includes("@")){i=_(t);const q=(await bl(Ft,i,_(r))).user.uid,J=(await ys(Rt(Tt,"users",q))).data(),he=await ur(_(r),q);try{const re=await $o(J.wrappedMasterKey,he);window.sessionEncryptionKey=re,console.log("Login successful")}catch{console.log("Decryption Error. Prompting for security question"),S=q,k=_(r),V(P,J.securityQuestion),V(v,!0),V(s,"");return}Hn.set(!0)}else{i=`${_(t)}@tracker.app`;const q=(await bl(Ft,i,_(r))).user.uid,$=await ys(Rt(Tt,"users",q));if(!$.exists()||!$.data().wrappedMasterKey){const J=await qo(),he=await ur(_(r),q),re=await ss(J,he);await gr(Rt(Tt,"users",q),{wrappedMasterKey:re,timestamp:Date.now()},{merge:!0}),window.sessionEncryptionKey=J}else{const J=$.data(),he=await ur(_(r),q),re=await $o(J.wrappedMasterKey,he);window.sessionEncryptionKey=re}console.log("Login successful"),Hn.set(!0)}}catch(x){console.error(x),V(s,x.message);return}}async function F(){if(!_(R).trim()){V(s,"Please provide an answer");return}try{const q=(await ys(Rt(Tt,"users",S))).data(),$=await Vu(_(R),S),J=await $o(q.wrappedRecoveryKey,$),he=await ur(k,S),re=await ss(J,he);await gr(Rt(Tt,"users",S),{wrappedMasterKey:re,timestamp:Date.now()},{merge:!0}),window.sessionEncryptionKey=J,V(v,!1),V(R,""),V(P,""),S=null,k=null,V(s,""),console.log("Recovery successful. Master key re-encrypted"),Hn.set(!0)}catch(x){console.error(x),V(s,"Incorrect answer. Please try again.")}}function E(){V(v,!1),V(R,""),V(P,""),S=null,k=null,Lh(Ft),V(s,"")}async function g(){if(V(s,""),_(t).includes("@"))i=_(t);else{V(s,"You can only reset the password of an account which uses a valid email.");return}k_(Ft,i).then(()=>{V(s,"If this email is associated with an account, an email has been sent.")}).catch(x=>{V(s,x.message)})}function m(x){switch(!0){case x.startsWith("Firebase: Error (auth/invalid-credential)."):return"Incorrect password or the account doesn't exist.";case x.startsWith("Firebase: Missing password requirements:"):return"Your password must contain at least one uppercase character, lowercase character, and number. Minimum length is 6 characters.";case x.startsWith("Firebase: Error (auth/email-already-in-use)."):return"This account already exists.";case x.startsWith("Firebase: Error (auth/invalid-email)."):return"Your username cannot have any spaces. If using email, it must be valid.";case x.startsWith("Firebase: Error (auth/missing-password)."):return"Missing password";default:return x}}Mi();var I=wE(),w=St(I);{var A=x=>{var q=gE(),$=B(H(q),6);Ve(()=>{_(u),Rp(()=>{})});var J=H($);J.value=J.__value="";var he=B(J);Ia(he,1,()=>f,Ta,(_e,Te)=>{var ke=pE(),et=H(ke,!0);K(ke);var ut={};Ve(()=>{Me(et,_(Te)),ut!==(ut=_(Te))&&(ke.value=(ke.__value=_(Te))??"")}),te(_e,ke)}),K($);var re=B($,4);An(re);var ge=B(re,5),De=H(ge),Ze=B(De,2);K(ge);var Ke=B(ge,2);{var Ne=_e=>{var Te=mE(),ke=H(Te,!0);K(Te),Ve(()=>Me(ke,_(s))),te(_e,Te)};Ie(Ke,_e=>{_(s)&&_e(Ne)})}K(q),jp($,()=>_(u),_e=>V(u,_e)),Jt(re,()=>_(d),_e=>V(d,_e)),me("click",De,z),me("click",Ze,ne),dt(1,q,()=>ft,()=>({delay:0,duration:400,easing:Qn})),dt(2,q,()=>ft,()=>({delay:0,duration:400,easing:Yn})),te(x,q)};Ie(w,x=>{_(T)&&x(A)})}var y=B(w,2);{var ie=x=>{var q=yE(),$=B(H(q),6),J=H($),he=H(J,!0);K(J),K($);var re=B($,4);An(re);var ge=B(re,5),De=H(ge),Ze=B(De,2);K(ge);var Ke=B(ge,2);{var Ne=_e=>{var Te=_E(),ke=H(Te,!0);K(Te),Ve(()=>Me(ke,_(s))),te(_e,Te)};Ie(Ke,_e=>{_(s)&&_e(Ne)})}Wo(4),K(q),Ve(()=>Me(he,_(P))),Jt(re,()=>_(R),_e=>V(R,_e)),me("click",De,F),me("click",Ze,E),dt(1,q,()=>ft,()=>({delay:0,duration:400,easing:Qn})),dt(2,q,()=>ft,()=>({delay:0,duration:400,easing:Yn})),te(x,q)};Ie(y,x=>{_(v)&&x(ie)})}var ae=B(y,2);{var ee=x=>{var q=vE(),$=B(H(q),10);K(q),me("click",$,()=>{V(l,!_(l))}),te(x,q)};Ie(ae,x=>{_(l)&&x(ee)})}var Re=B(ae,2);{var Ee=x=>{var q=EE(),$=B(H(q),4),J=H($),he=H(J);An(he);var re=B(he,2),ge=H(re);An(ge);var De=B(ge,2),Ze=H(De,!0);K(De),K(re),K(J),K($);var Ke=B($,2),Ne=H(Ke),_e=H(Ne),Te=B(_e,2);K(Ne);var ke=B(Ne,2),et=H(ke);K(ke),K(Ke);var ut=B(Ke,2),bt=H(ut);{var Gt=pe=>{var Dt=Ko();Ve(Fr=>Me(Dt,Fr),[()=>(_(s),we(()=>m(_(s))))]),te(pe,Dt)};Ie(bt,pe=>{_(s)&&!_(v)&&!_(T)&&pe(Gt)})}K(ut);var un=B(ut,6),mt=B(H(un),2),be=B(mt,2);K(un),K(q),Ve(()=>{he.disabled=_(T)||_(v),Hu(ge,"type",_(a)?"password":"text"),ge.disabled=_(T)||_(v),Me(Ze,_(a)?"show":"hide"),_e.disabled=_(T)||_(v),Te.disabled=_(T)||_(v),et.disabled=_(T)||_(v)}),Jt(he,()=>_(t),pe=>V(t,pe)),Jt(ge,()=>_(r),pe=>V(r,pe)),me("click",De,()=>V(a,!_(a))),me("click",_e,Y),me("click",Te,M),me("click",et,g),me("click",mt,function(...pe){L()?.apply(this,pe)}),me("click",be,()=>{V(l,!_(l))}),te(x,q)};Ie(Re,x=>{!_(T)&&!_(v)&&x(Ee)})}te(n,I),Bi()}var IE=de("<h3>Entry logged!</h3>"),AE=de('<h3 style="margin: 0px;">Entry logged!</h3> <h4>You can still log your day.</h4>',1),bE=de('<h3 style="margin: 0px;">Entry logged!</h3> <h4>Come back tomorrow!</h4>',1),RE=de('<div class="overlay"><!> <button>Return</button></div>'),SE=de('<h3 style="margin-top: 0; font-style: italic;"> </h3>'),CE=de('<input type="range" min="0" max="10" step="0.1"/> <textarea placeholder="Optional notes..." style="margin-top:0"></textarea> <button> </button>',1),PE=de('<h3 style="margin-top: 0; font-style: italic;"> </h3> <!>',1),kE=de('<div class="parent"><h1 class="title svelte-kkv8mu"></h1> <!></div>'),VE=de('<!> <button class="floating-button" style="opacity: 0; left: 2%;"></button>',1);function DE(n,e){Ui(e,!1);let t=Ct(e,"user",8),r=Ct(e,"externalEntry",8,null),s=Ct(e,"onSaved",8,()=>{}),i=Ct(e,"invert",8),a=Ct(e,"selectedCalendar",8),l=new Date;const u=l.getFullYear(),d=l.getMonth(),f=l.getDate();function v(y){return y.toString().padStart(2,"0")}let T=t().uid;if(t().email){const y=t().email.split("@")[0];name=y.charAt(0).toUpperCase()+y.slice(1)}else name="Temp";`${u}${v(d+1)}${v(f)}`;let R=oe(5),S=oe(""),k=oe(!1),P=oe(""),L=oe(!1),M=oe(""),z=oe(""),ne=oe(!1);function Y(y){return i()&&(y=10-y),`hsl(${120*(y/10)}, 70%, var(--V-brightness))`}function F(){return _(R)/10}async function E(y){if(_(k)&&!_(ne))return;if(!window.sessionEncryptionKey){console.error("No encryption key available!");return}V(L,!0);const ie=Rt(Tt,"users",T,a(),y.key);let ae={};y.period==="day"?ae={valueDay:_(R),textDay:_(S),timestamp:Date.now()}:ae={valueNight:_(R),textNight:_(S),timestamp:Date.now()};const ee=await hE(ae,["textDay","textNight","valueDay","valueNight"],window.sessionEncryptionKey);await gr(ie,ee,{merge:!0}),console.log("Logged "+y.key+" at "+y.period),y.period==="day"?y.filledNight&&V(z,"Come back tomorrow!"):y.filledDay&&V(z,"Come back tomorrow!"),s()()}function g(){V(L,!1)}_r(()=>vt(r()),()=>{if(r()){let y=r().period==="day"&&r().filledDay||r().period==="night"&&r().filledNight;!r().current&&y?V(k,!0):!r().current&&!y?V(k,!0):r().current&&(V(k,!1),V(S,r().period==="day"?r().textDay:r().textNight),V(R,(r().period==="day"?r().valueDay:r().valueNight)||5))}}),_r(()=>(vt(i()),_(R)),()=>{i()?V(P,_(R)<=0?"celebrate":""):V(P,_(R)>=10?"celebrate":"")}),_r(()=>(vt(i()),_(R)),()=>{(i()||_(R))&&V(M,Y(_(R)))}),wa(),Mi();var m=VE(),I=St(m);{var w=y=>{var ie=pi(),ae=St(ie);{var ee=Ee=>{var x=RE(),q=H(x);{var $=re=>{var ge=IE();te(re,ge)},J=re=>{var ge=pi(),De=St(ge);{var Ze=Ne=>{var _e=AE();Wo(2),te(Ne,_e)},Ke=Ne=>{var _e=bE();Wo(2),te(Ne,_e)};Ie(De,Ne=>{vt(r()),we(()=>r().period==="night"&&!r().filledDay)?Ne(Ze):Ne(Ke,!1)},!0)}te(re,ge)};Ie(q,re=>{vt(r()),we(()=>r().period==="day"&&!r().filledNight)?re($):re(J,!1)})}var he=B(q,2);he.__click=g,K(x),te(Ee,x)},Re=Ee=>{var x=kE(),q=H(x);q.textContent=`Welcome ${name??""}!`;var $=B(q,2);{var J=re=>{var ge=SE(),De=H(ge,!0);K(ge),Ve(()=>Me(De,_(z)||"Viewing past entries")),te(re,ge)},he=re=>{var ge=PE(),De=St(ge),Ze=H(De);K(De);var Ke=B(De,2);Wu(Ke,()=>(vt(r()),we(()=>`${r().key}`)),Ne=>{var _e=CE(),Te=St(_e);An(Te);var ke=B(Te,2);Sp(ke);var et=B(ke,2);et.__click=()=>E(r());var ut=H(et);K(et),Ve((bt,Gt)=>{Te.disabled=_(k)&&!_(ne),Up(Te,1,Mp(_(P)),"svelte-kkv8mu"),yr(Te,`--fill-percentage: ${bt??""}%; --slider-color: ${_(M)??""}; margin-bottom: 0`),et.disabled=_(k)&&!_(ne),Me(ut,`Save (${Gt??""}/10)`)},[()=>we(F),()=>(_(R),we(()=>parseFloat(_(R)).toFixed(1)))]),Jt(Te,()=>_(R),bt=>V(R,bt)),dt(1,Te,()=>ft,()=>({delay:0,duration:100,easing:Qn})),dt(2,Te,()=>ft,()=>({delay:0,duration:100,easing:Yn})),Jt(ke,()=>_(S),bt=>V(S,bt)),dt(1,ke,()=>ft,()=>({delay:0,duration:100,easing:Qn})),dt(2,ke,()=>ft,()=>({delay:0,duration:100,easing:Yn})),dt(1,et,()=>ft,()=>({delay:0,duration:100,easing:Qn})),dt(2,et,()=>ft,()=>({delay:0,duration:100,easing:Yn})),te(Ne,_e)}),Ve(()=>Me(Ze,`Rate your ${vt(r()),we(()=>r().period==="day"?"day":"night")??""}`)),te(re,ge)};Ie($,re=>{_(k)&&!_(ne)?re(J):re(he,!1)})}K(x),te(Ee,x)};Ie(ae,Ee=>{_(L)?Ee(ee):Ee(Re,!1)})}te(y,ie)};Ie(I,y=>{r()&&y(w)})}var A=B(I,2);A.__dblclick=()=>{console.log("Activated override!"),V(ne,!_(ne))},te(n,m),Bi()}Pp(["click","dblclick"]);var NE=de('<div class="month-nav"><button class="nav-btn" aria-label="Previous month"></button> <p> </p> <button class="nav-btn" aria-label="Next month"></button></div>'),xE=de('<div class="day"><div class="day-number"> </div>  <div class="day-half top-half"></div>  <div class="day-half bottom-half"></div></div>'),OE=de("<!> <br/> <i> </i>",1),ME=de("<!> <br/> <i> </i>",1),LE=de('<div class="entry-info"><strong> </strong> <!></div>'),FE=de('<!> <div class="calendar"></div> <!>',1);function UE(n,e){Ui(e,!1);let t=Ct(e,"user",8),r=Ct(e,"onSelectEntry",8,g=>{}),s=Ct(e,"reloadTrigger",8,0),i=Ct(e,"invert",8),a=Ct(e,"selectedCalendar",8),l=t().uid,u=oe([]),d=oe(null),f=oe(new Date),v=oe("");function T(g){return g==null?"var(--V-background-white)":`hsl(${120*(g/10)}, 70%, var(--V-brightness))`}function R(g){return g.toString().padStart(2,"0")}async function S(){if(!window.sessionEncryptionKey){console.error("No encryption key detected. Cannot load entries");return}console.log("Loaded calendar entries");const g=_(f).getFullYear(),m=_(f).getMonth(),w=new Date().getHours()<16?"day":"night",A=new Date,y=new Date(g,m+1,0).getDate();V(v,_(f).toLocaleString("default",{month:"long",year:"numeric"}));const ie=q0(Tt,"users",l,a()),ae=await sE(ie),ee={};for(const x of ae.docs){const q=x.data(),$=await dE(q,["textDay","textNight","valueDay","valueNight"],window.sessionEncryptionKey);ee[x.id]=$}const Re=[],Ee=g===A.getFullYear()&&m===A.getMonth()?A.getDate():y;for(let x=1;x<=Ee;x++){const q=`${g}-${R(m+1)}-${R(x)}`,$=ee[q],J=g===A.getFullYear()&&m===A.getMonth()&&x===A.getDate(),he={key:q,day:x,filledDay:$?.valueDay!=null,filledNight:$?.valueNight!=null,valueDay:$?.valueDay??null,valueNight:$?.valueNight??null,textDay:$?.textDay??null,textNight:$?.textNight??null,current:J};x===Ee&&(_(d)?.period?he.period=_(d).period:he.period=w,k(he)),Re.push(he)}V(u,Re)}function k(g){V(d,g),r()(g),console.log("Selected "+_(d).key+" at "+_(d).period)}function P(){const g=new Date(_(f));g.setMonth(g.getMonth()-1),V(f,g),S(),V(d,null)}function L(){const g=new Date,m=new Date(_(f));m.setMonth(m.getMonth()+1),!(m.getFullYear()>g.getFullYear()||m.getFullYear()===g.getFullYear()&&m.getMonth()>g.getMonth())&&(V(f,m),S(),V(d,null))}_r(()=>vt(s()),()=>{s()&&S()}),_r(()=>vt(a()),()=>{a()&&(S(),V(d,null))}),wa(),Mi();var M=FE(),z=St(M);{var ne=g=>{var m=NE(),I=H(m),w=B(I,2),A=H(w,!0);K(w);var y=B(w,2);K(m),Ve(ie=>{Me(A,_(v)),y.disabled=ie},[()=>(_(f),we(()=>_(f).getFullYear()===new Date().getFullYear()&&_(f).getMonth()===new Date().getMonth()))]),me("click",I,P),me("click",y,L),te(g,m)};Ie(z,g=>{_(u)!=[]&&a()&&g(ne)})}var Y=B(z,2);Ia(Y,5,()=>_(u),Ta,(g,m)=>{var I=xE(),w=H(I),A=H(w,!0);K(w);var y=B(w,2),ie=B(y,2);K(I),Ve((ae,ee)=>{yr(I,(_(m),_(d),we(()=>(_(m).current?"border: 1.5px solid var(--V-lighter-text);":"")+(_(d)!=null&&_(d).key===_(m).key&&_(d).period==="day"?"border-top: 2.5px solid #6BCBFF;":_(d)!=null&&_(d).key===_(m).key?"border-bottom: 2.5px solid #0077BA;":"")))),Me(A,(_(m),we(()=>_(m).day))),yr(y,ae),yr(ie,ee)},[()=>(_(m),vt(i()),vt(lr),we(()=>(_(m).valueDay!=null?!i()&&_(m).valueDay==10?`background: url('${lr}'); background-size: cover;`:i()&&_(m).valueDay==0?`background: url('${lr}'); background-size: cover;`:`background-color: ${T(_(m).valueDay!=null&&!i()?_(m).valueDay:_(m).valueDay!=null?10-_(m).valueDay:null)};`:"")+"transition: background-color .3s ease-in-out")),()=>(_(m),vt(i()),vt(lr),we(()=>(_(m).valueNight!=null?!i()&&_(m).valueNight==10?`background: url('${lr}'); background-size: cover;`:i()&&_(m).valueNight==0?`background: url('${lr}'); background-size: cover;`:`background-color: ${T(_(m).valueNight!=null&&!i()?_(m).valueNight:_(m).valueNight!=null?10-_(m).valueNight:null)};`:"")+"transition: background-color .3s ease-in-out"))]),me("click",y,()=>k({..._(m),period:"day"})),me("click",ie,()=>k({..._(m),period:"night"})),te(g,I)}),K(Y);var F=B(Y,2);{var E=g=>{var m=LE(),I=H(m),w=H(I);K(I);var A=B(I,2);{var y=ae=>{var ee=OE(),Re=St(ee);{var Ee=$=>{var J=Ko();Ve(()=>Me(J,` ${_(d),we(()=>_(d).valueDay)??""}/10`)),te($,J)};Ie(Re,$=>{_(d),we(()=>_(d).filledDay)&&$(Ee)})}var x=B(Re,4),q=H(x,!0);K(x),Ve(()=>Me(q,(_(d),we(()=>_(d).textDay||"No Entry")))),te(ae,ee)},ie=ae=>{var ee=ME(),Re=St(ee);{var Ee=$=>{var J=Ko();Ve(()=>Me(J,` ${_(d),we(()=>_(d).valueNight)??""}/10`)),te($,J)};Ie(Re,$=>{_(d),we(()=>_(d).filledNight)&&$(Ee)})}var x=B(Re,4),q=H(x,!0);K(x),Ve(()=>Me(q,(_(d),we(()=>_(d).textNight||"No Entry")))),te(ae,ee)};Ie(A,ae=>{_(d),we(()=>_(d).period==="day")?ae(y):ae(ie,!1)})}K(m),Ve(ae=>Me(w,`${ae??""} ${_(d),we(()=>_(d).period==="day"?"Day":"Night")??""}`),[()=>(_(d),we(()=>new Date(new Date(_(d).key).setHours(24,0,0,0)).toLocaleDateString("default",{month:"short",day:"numeric"})))]),dt(1,m,()=>ft,()=>({delay:0,duration:100,easing:Qn})),dt(2,m,()=>ft,()=>({delay:0,duration:100,easing:Yn})),te(g,m)};Ie(F,g=>{_(d),we(()=>_(d)&&!(_(d).period==="day"&&!_(d).filledDay&&_(d).current||_(d).period==="night"&&!_(d).filledNight&&_(d).current))&&g(E)})}te(n,M),Bi()}var BE=de("<button> </button>"),jE=de('<div class="overlay"><h2 style="margin-bottom: .5rem;">Your Calendars</h2> <span></span><br/><br/> <span style="margin-bottom: .5rem; flex-wrap: wrap; gap:.5rem;display: flex;"><button>Rename</button> <button>Delete</button> <button>New</button></span> <button>Back</button></div>'),zE=de("<p> </p>"),qE=de('<div class="overlay"><input type="text" class="login_input"/><br/> <span><button>Back</button> <button>Confirm</button></span> <!></div>'),$E=de("<p> </p>"),KE=de('<div class="overlay"><h3 style="margin-bottom: 0;"> </h3> <p><i>This action cannot be undone.</i></p><br/><br/> <input type="password" class="login_input" placeholder="Re-enter Password"/><br/> <span><button>Back</button> <button>Confirm</button></span> <!></div>'),HE=de("<p> </p>"),WE=de('<div class="overlay"><input type="text" class="login_input" placeholder="New Calendar"/><br/> <span><button>Back</button> <button>Confirm</button></span> <!></div>'),GE=de('<div style="order: 1; flex-wrap: wrap; gap:.5rem;display: flex"><button style="padding: .4rem inherit; border: 2px dashed #339FFF;"><b> </b></button> <!> <!> <!> <!> <button>Invert</button></div>'),QE=de('<div class="overlay"><div style="width: clamp(320px, 33vw, 33vw); text-align:justify"><span>Click on the <b>top half</b> of the current date to log an entry for today. Click on the <b>bottom half</b> to log an entry for tonight. You can save a rating (0-10) and, optionally, some text. Entries may be edited only on the current date. <br/><br/>To manage your calendars, click on <b>Main</b> in the bottom-left corner. You may add, delete, rename, and toggle between calendars to your liking. To reverse the red-green color scheme, click <b>Invert.</b> Your preferences will be saved for the next time you login!</span></div> <br/><br/> <button>Return</button></div>'),YE=de(`<div style="display: flex;
  justify-content: space-between;
  gap: .5rem;
  flex-wrap: wrap;
  padding-left: 5%;
  padding-right: 5%;"><div style="order: 2; flex-wrap: wrap; gap:.5rem; display: flex;"><span><button style="background-color: rgb(0, 0, 0, 0); margin: 0; padding: 0px 10px"><svg height="25px" viewBox="0 0 352 512"><path fill="var(--V-medium-text)" d="M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"></path></svg></button> <button style="background-color: rgb(0, 0, 0, 0); margin: 0; padding: 0px 10px"><svg height="25px" viewBox="0 0 512 512"><path fill="var(--V-medium-text)" d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"></path></svg></button> <button style="background-color: rgb(0, 0, 0, 0); margin: 0; padding: 0px 8px"><svg height="25px" viewBox="0 0 512 512"><path fill="var(--V-medium-text)" d="M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"></path></svg></button></span></div> <!> <!></div>`),JE=de('<div style="flex-grow: 1;"><!> <!> <!></div>');function c2(n,e){Ui(e,!1);const t=()=>Vp(Hn,"$loggedIn",r),[r,s]=kp();let i=oe(null),a=oe(null),l=oe(0),u=oe(null),d=oe(!1),f=oe(null),v=oe(null),T=oe(""),R=oe(""),S=oe(""),k=oe(""),P=oe(""),L=oe(),M=oe(!1),z=!1;async function ne(){_(i)&&(V(u,!_(u)),rs(f,_(f)[_(v)].colorPreference=_(u)),m(),console.log("Saved user profile invert="+_(u)))}function Y(){z=!z,z?(document.documentElement.style.setProperty("--V-background-white","var(--background-black)"),document.documentElement.style.setProperty("--V-background-off-white","var(--background-off-black)"),document.documentElement.style.setProperty("--V-medium-text","var(--lighter-text)"),document.documentElement.style.setProperty("--V-dark-text","var(--lighter-text)"),document.documentElement.style.setProperty("--V-ligher-text","var(--dark-text)"),document.documentElement.style.setProperty("--V-brightness","50%"),document.documentElement.style.setProperty("--V-brightness-factor","2.2"),document.documentElement.style.setProperty("--V-true-white","var(--true-black)")):(document.documentElement.style.setProperty("--V-background-white","var(--background-white)"),document.documentElement.style.setProperty("--V-background-off-white","var(--background-off-white)"),document.documentElement.style.setProperty("--V-medium-text","var(--medium-text)"),document.documentElement.style.setProperty("--V-dark-text","var(--dark-text)"),document.documentElement.style.setProperty("--V-ligher-text","var(--lighter-text)"),document.documentElement.style.setProperty("--V-brightness","var(--brightness)"),document.documentElement.style.setProperty("--V-brightness-factor","var(--brightness-factor)"),document.documentElement.style.setProperty("--V-true-white","var(--true-white)"))}function F(){_(R)===""?V(P,"New name cannot be empty!"):Object.values(_(f)).map(ee=>ee.name).includes(_(R))?V(P,"New name cannot be a duplicate!"):(rs(f,_(f)[_(v)].name=_(R)),m(),V(R,""),V(P,""),V(S,""))}function E(){P_(_(i),rr.credential(_(i).email,_(k))).then(()=>{Object.keys(_(f)).length===1?(V(P,"You cannot delete your last calendar!"),V(k,"")):(delete _(f)[_(v)],V(f,{..._(f)}),V(v,Object.keys(_(f)).sort()[0]),m(),V(k,""),V(P,""),V(S,""))}).catch(ee=>{V(P,"Incorrect password!")})}function g(){if(_(T)==="")V(P,"New name cannot be empty!");else if(Object.values(_(f)).includes(_(T)))V(P,"New name cannot be a duplicate!");else{const ee=Date.now().toString();rs(f,_(f)[ee]={name:_(T),colorPreference:!1}),V(f,{..._(f)}),V(v,ee),m(),V(P,""),V(T,""),V(S,"")}}async function m(){if(!_(i))return;const ee=Date.now(),Re=Rt(Tt,"users",_(i).uid),Ee=await ys(Re),x=_(i).email?_(i).email.split("@")[0].charAt(0).toUpperCase()+_(i).email.split("@")[0].slice(1):"anonymous"+ee.toString();V(u,_(f)[_(v)].colorPreference),Ee.data().calendars!=null?(await iE(Re,{calendars:_(f),selectedCalendar:_(v),timestamp:ee}),console.log(`Updated calendars as follows:
`+JSON.stringify(_(f))+`
Selected: `+_(v))):(await gr(Re,{calendars:_(f),selectedCalendar:_(v),name:x,timestamp:ee},{merge:!0}),console.log(`Initialized calendars as follows:
`+JSON.stringify(_(f))+`
Selected: `+_(v)))}function I(){V(l,_(l)+1)}function w(){V(L,!1),Hn.set(!1),Lh(Ft),V(i,null),V(a,null)}function A(ee){V(a,ee)}async function y(ee){if(!ee)return;const Re=Rt(Tt,"users",ee.uid),Ee=await ys(Re);if(Ee.exists()){const x=Ee.data();if(x.calendars)V(f,x.calendars),V(v,x.selectedCalendar),console.log("Loaded user calendars");else{V(f,{}),V(u,!1);const q=Date.now().toString();rs(f,_(f)[q]={name:"Main",colorPreference:_(u)}),V(v,q),await m(),console.log("Initialized user calendars")}x.selectedCalendar&&(V(u,x.calendars[x.selectedCalendar].colorPreference),console.log("Loaded user invert to "+_(u)))}else{V(f,{}),V(u,!1);const x=Date.now().toString();rs(f,_(f)[x]={name:"Main",colorPreference:_(u)}),V(v,x),await m(),console.log("New user.")}}Xf(w),_r(()=>(t(),Ft),()=>{t()&&(N_(Ft,ee=>{y(ee),V(i,ee)}),V(L,!0))}),wa(),Mi();var ie=pi(),ae=St(ie);Wu(ae,()=>`${_(i)}`,ee=>{var Re=pi(),Ee=St(Re);{var x=$=>{TE($,{darkMode:Y})},q=$=>{var J=JE(),he=H(J);DE(he,{get user(){return _(i)},get externalEntry(){return _(a)},onSaved:I,get invert(){return _(u)},get selectedCalendar(){return _(v)}});var re=B(he,2);UE(re,{get user(){return _(i)},onSelectEntry:A,get reloadTrigger(){return _(l)},get invert(){return _(u)},get selectedCalendar(){return _(v)}});var ge=B(re,2);{var De=Ze=>{var Ke=YE(),Ne=H(Ke),_e=H(Ne),Te=H(_e),ke=B(Te,2),et=B(ke,2);K(_e),K(Ne);var ut=B(Ne,2);{var bt=mt=>{var be=GE(),pe=H(be),Dt=H(pe),Fr=H(Dt,!0);K(Dt),K(pe);var Ur=B(pe,2);{var co=Qe=>{var Le=jE(),Be=B(H(Le),2);Ia(Be,5,()=>(_(f),we(()=>Object.keys(_(f)).sort())),Ta,(Fe,nt)=>{var ye=BE(),dn=H(ye,!0);K(ye),Ve(()=>{yr(ye,(_(v)===_(nt)?"border: 2px dashed #339FFF;":"border: 2px dashed #ccc;")+"margin: .5rem; margin-bottom: 0; font-size: 1.1rem"),Me(dn,(_(f),_(nt),we(()=>_(f)[_(nt)].name)))}),me("click",ye,()=>{V(v,_(nt)),m()}),te(Fe,ye)}),K(Be);var tt=B(Be,4),je=H(tt),gt=B(je,2),_t=B(gt,2);K(tt);var Nt=B(tt,2);K(Le),me("click",je,()=>{V(S,"rename")}),me("click",gt,()=>{V(S,"delete")}),me("click",_t,()=>{V(S,"new")}),me("click",Nt,()=>{V(M,!_(M))}),te(Qe,Le)};Ie(Ur,Qe=>{_(M)&&Qe(co)})}var hn=B(Ur,2);{var Us=Qe=>{var Le=qE(),Be=H(Le);An(Be);var tt=B(Be,3),je=H(tt),gt=B(je,2);K(tt);var _t=B(tt,2);{var Nt=Fe=>{var nt=zE(),ye=H(nt,!0);K(nt),Ve(()=>Me(ye,_(P))),te(Fe,nt)};Ie(_t,Fe=>{_(P)!=""&&Fe(Nt)})}K(Le),Ve(()=>Hu(Be,"placeholder",`Renaming ${_(f),_(v),we(()=>_(f)[_(v)].name)??""}`)),Jt(Be,()=>_(R),Fe=>V(R,Fe)),me("click",je,()=>{V(S,""),V(R,"")}),me("click",gt,F),te(Qe,Le)};Ie(hn,Qe=>{_(S)==="rename"&&Qe(Us)})}var Br=B(hn,2);{var jr=Qe=>{var Le=KE(),Be=H(Le),tt=H(Be);K(Be);var je=B(Be,6);An(je);var gt=B(je,3),_t=H(gt),Nt=B(_t,2);K(gt);var Fe=B(gt,2);{var nt=ye=>{var dn=$E(),Bn=H(dn,!0);K(dn),Ve(()=>Me(Bn,_(P))),te(ye,dn)};Ie(Fe,ye=>{_(P)!=""&&ye(nt)})}K(Le),Ve(()=>Me(tt,`Delete ${_(f),_(v),we(()=>_(f)[_(v)].name)??""}?`)),Jt(je,()=>_(k),ye=>V(k,ye)),me("click",_t,()=>{V(S,""),V(k,""),V(P,"")}),me("click",Nt,E),te(Qe,Le)};Ie(Br,Qe=>{_(S)==="delete"&&Qe(jr)})}var Bs=B(Br,2);{var lo=Qe=>{var Le=WE(),Be=H(Le);An(Be);var tt=B(Be,3),je=H(tt),gt=B(je,2);K(tt);var _t=B(tt,2);{var Nt=Fe=>{var nt=HE(),ye=H(nt,!0);K(nt),Ve(()=>Me(ye,_(P))),te(Fe,nt)};Ie(_t,Fe=>{_(P)!=""&&Fe(Nt)})}K(Le),Jt(Be,()=>_(T),Fe=>V(T,Fe)),me("click",je,()=>{V(S,""),V(T,""),V(P,"")}),me("click",gt,g),te(Qe,Le)};Ie(Bs,Qe=>{_(S)==="new"&&Qe(lo)})}var zr=B(Bs,2);K(be),Ve(()=>{Me(Fr,(_(f),_(v),we(()=>_(f)[_(v)].name))),yr(zr,`background-color: ${_(u)?"hsl(0, 70%, var(--V-brightness))":"hsl(120, 70%, var(--V-brightness))"}; color: #202020; transition: background-color .2s ease-in-out`)}),me("click",pe,()=>{V(M,!_(M))}),me("click",zr,ne),te(mt,be)};Ie(ut,mt=>{_(u)!=null&&mt(bt)})}var Gt=B(ut,2);{var un=mt=>{var be=QE(),pe=B(H(be),5);K(be),me("click",pe,()=>{V(d,!_(d))}),te(mt,be)};Ie(Gt,mt=>{_(d)&&mt(un)})}K(Ke),me("click",Te,()=>{V(d,!_(d))}),me("click",ke,Y),me("click",et,w),te(Ze,Ke)};Ie(ge,Ze=>{_(a)&&Ze(De)})}K(J),dt(1,J,()=>ft,()=>({delay:0,duration:400,easing:Qn})),dt(2,J,()=>ft,()=>({delay:0,duration:400,easing:Yn})),te($,J)};Ie(Ee,$=>{!_(i)||!_(L)||!_(v)?$(x):$(q,!1)})}te(ee,Re)}),te(n,ie),Bi(),s()}export{c2 as component};
